import{r as T,R as l}from"./react.D016eMnP.js";import{c as ce,C as zr,t as La,S as Zs,a as _e,T as ae,D as Pn,B as Oe,I as Lt,b as Qs,F as J,R as re,d as Q,e as Ir,f as Ar,g as et,P as Js,s as di,E as Ot,h as Ma,i as Nr,j as Ln,k as Ks,l as Dr,m as Tr,M as Pr}from"./antd.DViraF2p.js";let Ci="idraw-studio";function ka(e){Ci=e}function ja(){return Ci}function qs(e){return(...t)=>[Ci,e,...t].join("-")}function B(...e){return[Ci,...e].join("-")}const Or={locale:"en-US",Header:{},LayoutDetail:{layout:"Layout",groupLayout:"Group Layout",x:"X",y:"Y",w:"W",h:"H",background:"Background",solid:"Solid",dash:"Dash",inside:"Inside",outside:"Outside",centerLine:"Center",gradient:"Gradient",opacity:"Opacity",mixedBorderWidth:"Mixed",mixedBorderRadius:"Mixed",overflow:"Overflow",hidden:"Hidden",visible:"Visible"},ElementDetail:{basicAttributes:"Basic",borderAttribute:"Border",contentAttribute:"Content",shadowAttribute:"Shadow",x:"X",y:"Y",w:"W",h:"H",background:"Background",solid:"Solid",dash:"Dash",inside:"Inside",outside:"Outside",centerLine:"Center",gradient:"Gradient",opacity:"Opacity",mixedBorderWidth:"Mixed",mixedBorderRadius:"Mixed",overflow:"Overflow",hidden:"Hidden",visible:"Visible",deepResizeInGroup:"Deep resize in group",fill:"Fill",stroke:"Stroke"},Menu:{about:"About @idraw/studio",file:"File",importJSONFile:"Import JSON file",exportJSONFile:"Export JSON file",exportImage:"Export image",preferences:"Preferences",rect:"Rect",circle:"Circle",text:"Text",image:"Image",html:"HTML",svg:"SVG",group:"Group",devicePixelRatio:"Device pixel ratio"}},Rr={locale:"zh-CN",Header:{},LayoutDetail:{layout:"布局",groupLayout:"组布局",x:"X",y:"Y",w:"宽",h:"高",background:"背景色",solid:"实线",dash:"虚线",inside:"内线",outside:"外线",centerLine:"中线",gradient:"渐变",opacity:"透明度",mixedBorderWidth:"混合边框",mixedBorderRadius:"混合圆角",overflow:"溢出",hidden:"隐藏",visible:"可视"},ElementDetail:{basicAttributes:"基础",borderAttribute:"边框",contentAttribute:"内容",shadowAttribute:"阴影",x:"X",y:"Y",w:"宽",h:"高",background:"背景色",solid:"实线",dash:"虚线",inside:"内线",outside:"外线",centerLine:"中线",gradient:"渐变",opacity:"透明度",mixedBorderWidth:"混合边框",mixedBorderRadius:"混合圆角",overflow:"溢出",hidden:"隐藏",visible:"可视",deepResizeInGroup:"组内尺寸关联调整",fill:"填充",stroke:"描边"},Menu:{about:"关于 @idraw/studio",file:"文件",importJSONFile:"导入JSON文件",exportJSONFile:"导出JSON文件",exportImage:"导出图片",preferences:"预设",rect:"矩形",circle:"圆形",text:"文本",image:"图片",html:"HTML片段",svg:"SVG片段",group:"群组",devicePixelRatio:"设备像素比例"}},_a={"en-US":Or,"zh-CN":Rr},ia="en-US",el=e=>{const{localeCode:t}=T.useContext(uo);return[T.useMemo(()=>{const i=(_a[t||ia]||_a[ia])[e];return Object.assign({},i)},[t,e])]},Lr=e=>{const{themeMode:t}=e,n="theme",o=B(n),i=B(n,"dark"),a=ce({[o]:!0,[i]:t==="dark"});return{themeMode:t,className:a}},tl=e=>(e!=null&&e.topPrefix&&typeof(e==null?void 0:e.topPrefix)=="string"&&ka(e.topPrefix),Object.assign({topPrefix:ja(),createPrefixName:qs,generateClassName:B,getClassNameTopPrefix:ja,setClassNameTopPrefix:ka,localeCode:ia},e||{})),uo=T.createContext(tl()),kr=e=>{const{children:t,topPrefix:n,localeCode:o,container:i,themeMode:a}=e,s=tl({topPrefix:n,localeCode:o}),[r,c]=T.useState(s),{className:d}=Lr({themeMode:a});return T.useEffect(()=>{c(Object.assign(Object.assign({},r),{localeCode:o,container:i}))},[o,i]),l.createElement(uo.Provider,{value:Object.assign({},r)},l.createElement(zr,{theme:{algorithm:a==="dark"?La.darkAlgorithm:La.defaultAlgorithm}},l.createElement("div",{className:d},t)))};class Va extends l.PureComponent{render(){const{children:t,className:n,split:o,style:i,size:a,eleRef:s}=this.props,r=["Pane",o,n];let c={flex:1,position:"relative",outline:"none"};return a!==void 0&&(o==="vertical"?c.width=a:(c.height=a,c.display="flex"),c.flex="none"),c=Object.assign({},c,i||{}),l.createElement("div",{ref:s,className:r.join(" "),style:c},t)}}const jr="base-split-pane",_r=()=>{const{generateClassName:e}=T.useContext(uo);return{modClassName:e(jr)}};function Vr(e){const{modClassName:t}=_r(),{className:n,onClick:o,onDoubleClick:i,onMouseDown:a,onTouchEnd:s,onTouchStart:r,resizerClassName:c=t,split:d,style:u}=e,h=[c,d,n];return T.useMemo(()=>l.createElement("span",{role:"presentation",className:h.join(" "),style:u,onMouseDown:f=>a(f),onTouchStart:f=>{f.preventDefault(),r(f)},onTouchEnd:f=>{f.preventDefault(),s(f)},onClick:f=>{o&&(f.preventDefault(),o(f))},onDoubleClick:f=>{i&&(f.preventDefault(),i(f))}}),[])}const Wr="xxxxx";function Wa(e,t){if(e.selection)e.selection.empty();else try{t.getSelection().removeAllRanges()}catch{}}function Ba(e,t,n,o){if(typeof o=="number"){const i=typeof t=="number"?t:0,a=typeof n=="number"&&n>=0?n:1/0;return Math.max(i,Math.min(a,o))}return e!==void 0?e:t}function Br(e){return l.Children.toArray(e).filter(t=>t)}class ui extends l.Component{constructor(t){super(t),this.onMouseDown=this.onMouseDown.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this);const{size:n,defaultSize:o,minSize:i,maxSize:a,primary:s}=t,r=n!==void 0?n:Ba(o,i,a,null);this.state={active:!1,resized:!1,pane1Size:s==="first"?r:void 0,pane2Size:s==="second"?r:void 0,instanceProps:{size:n}}}componentDidMount(){document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("touchmove",this.onTouchMove),this.setState(ui.getSizeUpdate(this.props,this.state))}static getDerivedStateFromProps(t,n){return ui.getSizeUpdate(t,n)}componentWillUnmount(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchmove",this.onTouchMove)}onMouseDown(t){const n=Object.assign({},t,{touches:[{clientX:t.clientX,clientY:t.clientY}]});this.onTouchStart(n)}onTouchStart(t){const{allowResize:n,onDragStarted:o,split:i}=this.props;if(n){Wa(document,window);const a=i==="vertical"?t.touches[0].clientX:t.touches[0].clientY;typeof o=="function"&&o(),this.setState({active:!0,position:a})}}onMouseMove(t){const n=Object.assign({},t,{touches:[{clientX:t.clientX,clientY:t.clientY}]});this.onTouchMove(n)}onTouchMove(t){const{allowResize:n,maxSize:o,minSize:i,onChange:a,split:s,step:r}=this.props,{active:c,position:d}=this.state;if(n&&c){Wa(document,window);const u=this.props.primary==="first",h=u?this.pane1:this.pane2,f=u?this.pane2:this.pane1;if(h){const m=h,v=f;if(m.getBoundingClientRect){const g=m.getBoundingClientRect().width,p=m.getBoundingClientRect().height,S=s==="vertical"?t.touches[0].clientX:t.touches[0].clientY,E=s==="vertical"?g:p;let w=d-S;if(r){if(Math.abs(w)<r)return;w=~~(w/r)*r}let y=u?w:-w;const x=parseInt(window.getComputedStyle(m).order),b=parseInt(window.getComputedStyle(v).order);x>b&&(y=-y);let C=o;if(o!==void 0&&o<=0){const N=this.splitPane;s==="vertical"?C=N.getBoundingClientRect().width+o:C=N.getBoundingClientRect().height+o}let z=E-y;const L=d-w;z<i?z=i:o!==void 0&&z>C?z=C:this.setState({position:L,resized:!0}),a&&a(z),this.setState({draggedSize:z,[u?"pane1Size":"pane2Size"]:z})}}}}onMouseUp(){const{allowResize:t,onDragFinished:n}=this.props,{active:o,draggedSize:i}=this.state;t&&o&&(typeof n=="function"&&n(i),this.setState({active:!1}))}static getSizeUpdate(t,n){const o={},{instanceProps:i}=n;if(i.size===t.size&&t.size!==void 0)return{};const a=t.size!==void 0?t.size:Ba(t.defaultSize,t.minSize,t.maxSize,n.draggedSize);t.size!==void 0&&(o.draggedSize=a);const s=t.primary==="first";return o[s?"pane1Size":"pane2Size"]=a,o[s?"pane2Size":"pane1Size"]=void 0,o.instanceProps={size:t.size},o}render(){const{allowResize:t,children:n,className:o,onResizerClick:i,onResizerDoubleClick:a,paneClassName:s,pane1ClassName:r,pane2ClassName:c,paneStyle:d,pane1Style:u,pane2Style:h,resizerClassName:f,resizerStyle:m,split:v,style:g}=this.props,{pane1Size:p,pane2Size:S}=this.state,E=t?"":"disabled",w=f&&`${f} ${Wr}`,y=Br(n),x=Object.assign({display:"flex",flex:1,height:"100%",position:"absolute",outline:"none",overflow:"hidden",MozUserSelect:"text",WebkitUserSelect:"text",msUserSelect:"text",userSelect:"text"},g);v==="vertical"?Object.assign(x,{flexDirection:"row",left:0,right:0}):Object.assign(x,{bottom:0,flexDirection:"column",minHeight:"100%",top:0,width:"100%"});const b=["SplitPane",o,v,E],C=Object.assign(Object.assign({},d),u),z=Object.assign(Object.assign({},d),h),L=["Pane1",s,r].join(" "),N=["Pane2",s,c].join(" ");return l.createElement("div",{className:b.join(" "),ref:R=>{this.splitPane=R},style:x},l.createElement(Va,{className:L,key:"pane1",eleRef:R=>{this.pane1=R},size:p,split:v,style:C},y[0]),l.createElement(Vr,{className:E,onClick:i,onDoubleClick:a,onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onTouchEnd:this.onMouseUp,key:"resizer",resizerClassName:w,split:v,style:m||{}}),l.createElement(Va,{className:N,key:"pane2",eleRef:R=>{this.pane2=R},size:S,split:v,style:z},y[1]))}}var Fr=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};const Hr="icon",Gr=()=>({iconClassName:B(Hr)}),ne=e=>{const{className:t,style:n,children:o}=e,i=Fr(e,["className","style","children"]),{iconClassName:a}=Gr();return T.useMemo(()=>l.createElement("span",Object.assign({className:ce([a,t]),style:n},i),o),[a,n,t])},Yr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M516.266667 938.666667h-38.4c-234.666667-21.333333-405.333333-230.4-384-465.066667 17.066667-204.8 179.2-366.933333 384-384 17.066667 0 34.133333 8.533333 42.666666 21.333333 8.533333 12.8 8.533333 34.133333-4.266666 46.933334-85.333333 115.2-59.733333 273.066667 55.466666 358.4 89.6 68.266667 213.333333 68.266667 302.933334 0 12.8-8.533333 29.866667-12.8 46.933333-4.266667 12.8 8.533333 21.333333 25.6 21.333333 42.666667-8.533333 115.2-64 217.6-153.6 290.133333-81.066667 59.733333-174.933333 93.866667-273.066666 93.866667zM396.8 187.733333c-123.733333 42.666667-213.333333 153.6-221.866667 290.133334-17.066667 187.733333 119.466667 354.133333 307.2 371.2 89.6 8.533333 179.2-17.066667 247.466667-76.8 46.933333-38.4 81.066667-89.6 102.4-145.066667-106.666667 38.4-226.133333 21.333333-320-46.933333-119.466667-93.866667-166.4-251.733333-115.2-392.533334z"}))),$r=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M512 768c-141.376 0-256-114.624-256-256s114.624-256 256-256 256 114.624 256 256-114.624 256-256 256z m0-85.333333a170.666667 170.666667 0 1 0 0-341.333334 170.666667 170.666667 0 0 0 0 341.333334zM469.333333 85.333333a42.666667 42.666667 0 1 1 85.333334 0v85.333334a42.666667 42.666667 0 1 1-85.333334 0V85.333333z m0 768a42.666667 42.666667 0 1 1 85.333334 0v85.333334a42.666667 42.666667 0 1 1-85.333334 0v-85.333334zM85.333333 554.666667a42.666667 42.666667 0 1 1 0-85.333334h85.333334a42.666667 42.666667 0 1 1 0 85.333334H85.333333z m768 0a42.666667 42.666667 0 1 1 0-85.333334h85.333334a42.666667 42.666667 0 1 1 0 85.333334h-85.333334zM161.834667 222.165333a42.666667 42.666667 0 0 1 60.330666-60.330666l64 64a42.666667 42.666667 0 0 1-60.330666 60.330666l-64-64z m576 576a42.666667 42.666667 0 0 1 60.330666-60.330666l64 64a42.666667 42.666667 0 0 1-60.330666 60.330666l-64-64z m-515.669334 64a42.666667 42.666667 0 0 1-60.330666-60.330666l64-64a42.666667 42.666667 0 0 1 60.330666 60.330666l-64 64z m576-576a42.666667 42.666667 0 0 1-60.330666-60.330666l64-64a42.666667 42.666667 0 0 1 60.330666 60.330666l-64 64z"}))),Xr="base-theme-switch",Ur=qs(Xr),Fa=e=>{if(!(typeof e>"u"))return e==="light"};function Zr(e){return e===!0?"light":"dark"}const Qr=e=>{const{className:t,style:n,onChange:o,theme:i,defaultTheme:a}=e;return l.createElement(Zs,{className:ce([Ur(),t]),style:n,checkedChildren:l.createElement($r,{style:{height:"100%"}}),unCheckedChildren:l.createElement(Yr,{style:{height:"100%"}}),checked:Fa(a),defaultChecked:Fa(i),onChange:s=>{const r=Zr(s);o==null||o({theme:r})}})},Ha=_e.Option,Jr="base-locale-selector",Kr=e=>{const{className:t,style:n,defaultValue:o,value:i,onChange:a}=e;return T.useMemo(()=>l.createElement(_e,{style:n,className:ce(B(Jr),t),size:"small",defaultValue:o,value:i,onChange:a},l.createElement(Ha,{value:"en-US"},"English"),l.createElement(Ha,{value:"zh-CN"},"中文")),[t,n,o,i,a])};function xa(e){const{accept:t,success:n,error:o}=e;let i=document.createElement("input");i.type="file",t&&(i.accept=t),i.addEventListener("change",function(){var a;const s=(a=i.files)===null||a===void 0?void 0:a[0];n({file:s}),i=null}),i.addEventListener("error",function(a){typeof o=="function"&&o(a),i=null}),i.click()}function qr(e){return new Promise(function(t,n){let o=new FileReader;o.addEventListener("load",function(){t(o.result),o=null}),o.addEventListener("error",function(i){n(i),o=null}),o.addEventListener("abort",function(){n(new Error("abort")),o=null}),o.readAsDataURL(e)})}function ec(e){return new Promise(function(t,n){let o=new FileReader;o.addEventListener("load",function(){t(o.result),o=null}),o.addEventListener("error",function(i){n(i),o=null}),o.addEventListener("abort",function(){n(new Error("abort")),o=null}),o.readAsText(e)})}function tc(e){const t=new TextEncoder().encode(e),n=new Blob([t],{type:"text/plain;charset=utf-8"});return window.URL.createObjectURL(n)}function nc(e,t){const{fileName:n}=t,o=tc(e);let i=document.createElement("a");i.href=o,i.download=n,i.click(),i=null}function hi(e){return typeof e=="string"&&(/^\#([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i.test(e)||/^[a-z]{1,}$/i.test(e))}function oc(e){let t="transparent";if(typeof e=="string")t=e;else if((e==null?void 0:e.type)==="linear-gradient"){const n=[];typeof e.angle=="number"?n.push(`${e.angle}deg`):n.push("180deg"),Array.isArray(e.stops)&&e.stops.forEach(o=>{n.push(`${o.color} ${o.offset*100}%`)}),t=`linear-gradient(${n.join(", ")})`}else if((e==null?void 0:e.type)==="radial-gradient"){const n=[];Array.isArray(e.stops)&&e.stops.forEach(o=>{n.push(`${o.color} ${o.offset*100}%`)}),t=`radial-gradient(circle, ${n.join(", ")})`}return t}function fi(e){let t="transparent";if(typeof e=="string")t=e;else if((e==null?void 0:e.type)==="radial-gradient"||(e==null?void 0:e.type)==="linear-gradient"){const n=[];Array.isArray(e.stops)&&e.stops.length>0&&(e.stops.forEach((o,i)=>{n.push(`${o.color} ${o.offset*100}%`),i===e.stops.length-1&&o.offset<1&&n.push(`${o.color} ${o.offset*100}%`)}),t=`linear-gradient(90deg, ${n.join(", ")})`)}return t}function Ga(e,t){if(t===1)return e;let n=1;const o=/^\#[0-9a-f]{6,6}$/i,i=/^\#[0-9a-f]{8,8}$/i;let a=e;if(o.test(e)?n=parseInt(e.substring(5,7).replace(/^\#/,"0x")):i.test(e)&&(n=parseInt(e.substring(7,9).replace(/^\#/,"0x")),a=e.substring(0,7)),n=n*t,o.test(a)&&n>0&&n<1){const s=Math.max(0,Math.min(255,Math.ceil(n*256)));a=`${a.toUpperCase()}${s.toString(16).toUpperCase()}`}return a}function $e(){function e(){return((1+Math.random())*65536|0).toString(16).substring(1)}return`${e()}${e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}function xt(e){let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n)*e.charCodeAt(n)*n*n;return t.toString(16).substring(0,4)}function Tn(e){const t=e.length,n=Math.floor(t/2),o=e.substring(0,4).padEnd(4,"0"),i=e.substring(0,4).padEnd(4,"0"),a=xt(t.toString(16).padEnd(4,o)),s=xt(e.substring(n-4,n).padEnd(4,o)).padEnd(4,"f"),r=xt(e.substring(n-8,n-4).padEnd(4,o)).padEnd(4,"f"),c=xt(e.substring(n-12,n-8).padEnd(4,o)).padEnd(4,"f"),d=xt(e.substring(n-16,n-12).padEnd(4,i)).padEnd(4,"f"),u=xt(e.substring(n,n+4).padEnd(4,i)).padEnd(4,"f"),h=xt(e.substring(n+4,n+8).padEnd(4,i)).padEnd(4,"f"),f=xt(i.padEnd(4,o).padEnd(4,i));return`@assets/${a}${s}-${r}-${c}-${d}-${u}${h}${f}`}function Ut(e){return/^@assets\/[0-9a-z]{8,8}\-[0-9a-z]{4,4}\-[0-9a-z]{4,4}\-[0-9a-z]{4,4}\-[0-9a-z]{12,12}$/.test(`${e}`)}function Zt(e){function t(n){const o=ic(n);if(["Null","Number","String","Boolean","Undefined"].indexOf(o)>=0)return n;if(o==="Array"){const i=[];return n.forEach(a=>{i.push(t(a))}),i}else if(o==="Object"){const i={};return Object.keys(n).forEach(r=>{i[r]=t(n[r])}),Object.getOwnPropertySymbols(n).forEach(r=>{i[r]=t(n[r])}),i}}return t(e)}function ki(e){const t=Zt(e),n=o=>{o.uuid=$e(),o.type==="group"&&o.detail.children&&o.detail.children.forEach(i=>{n(i)})};return n(t),t}function ic(e){return Object.prototype.toString.call(e).replace(/[\]|\[]{1,1}/gi,"").split(" ")[1]}function ac(e,t){const n=e.assets||{},o=Zt(e),i=(t==null?void 0:t.loadItemMap)||{},a=s=>{s.forEach(r=>{var c,d,u;if(r.type==="image"&&r.detail.src){const h=r.detail.src;if(Ut(h)&&!n[h]&&i[h]&&typeof((c=i[h])===null||c===void 0?void 0:c.source)=="string")n[h]={type:"image",value:i[h].source};else if(!n[h]){const f=Tn(h);n[f]||(n[f]={type:"image",value:h}),r.detail.src=f}}else if(r.type==="svg"){const h=r.detail.svg;if(Ut(h)&&!n[h]&&i[h]&&typeof((d=i[h])===null||d===void 0?void 0:d.source)=="string")n[h]={type:"svg",value:i[h].source};else if(!n[h]){const f=Tn(h);n[f]||(n[f]={type:"svg",value:h}),r.detail.svg=f}}else if(r.type==="html"){const h=r.detail.html;if(Ut(h)&&!n[h]&&i[h]&&typeof((u=i[h])===null||u===void 0?void 0:u.source)=="string")n[h]={type:"html",value:i[h].source};else if(!n[h]){const f=Tn(h);n[f]||(n[f]={type:"html",value:h}),r.detail.html=f}}else if(r.type==="group"&&Array.isArray(r.detail.children)){const h=r.detail.assets||{};Object.keys(h).forEach(f=>{n[f]||(n[f]=h[f])}),delete r.detail.assets,a(r.detail.children)}})};return a(o.elements),o.assets=n,o}function it(e){return(Object.prototype.toString.call(e)||"").replace(/(\[object|\])/gi,"").trim()}const Zn={type(e,t){const n=it(e);return t===!0?n.toLocaleLowerCase():n},array(e){return it(e)==="Array"},json(e){return it(e)==="Object"},function(e){return it(e)==="Function"},asyncFunction(e){return it(e)==="AsyncFunction"},boolean(e){return it(e)==="Boolean"},string(e){return it(e)==="String"},number(e){return it(e)==="Number"},undefined(e){return it(e)==="Undefined"},null(e){return it(e)==="Null"},promise(e){return it(e)==="Promise"}};function sc(e,t){const{width:n,height:o}=t;return new Promise((i,a)=>{const s=`
    <svg 
      xmlns="http://www.w3.org/2000/svg" 
      width="${n||""}" 
      height = "${o||""}">
      <foreignObject width="100%" height="100%">
        <div xmlns = "http://www.w3.org/1999/xhtml">
          ${e}
        </div>
      </foreignObject>
    </svg>
    `,r=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),c=new FileReader;c.readAsDataURL(r),c.onload=function(d){var u;const h=(u=d==null?void 0:d.target)===null||u===void 0?void 0:u.result;i(h)},c.onerror=function(d){a(d)}})}function lc(e){return new Promise((t,n)=>{const o=e,i=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),a=new FileReader;a.readAsDataURL(i),a.onload=function(s){var r;const c=(r=s==null?void 0:s.target)===null||r===void 0?void 0:r.result;t(c)},a.onerror=function(s){n(s)}})}var nl=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})};const{Image:rc}=window;function zi(e){return new Promise((t,n)=>{const o=new rc;o.crossOrigin="anonymous",o.onload=function(){t(o)},o.onabort=n,o.onerror=n,o.src=e})}function cc(e){return nl(this,void 0,void 0,function*(){const t=yield lc(e);return yield zi(t)})}function dc(e){return e.replace(/\&/gi,"&amp;")}function uc(e,t){return nl(this,void 0,void 0,function*(){e=dc(e);const n=yield sc(e,t);return yield zi(n)})}function en(e){return typeof e=="number"&&(e>0||e<=0)}function hc(e){return en(e)}function fc(e){return en(e)}function ol(e){return typeof e=="number"&&e>=0}function mc(e){return typeof e=="number"&&e>=0}function gc(e){return typeof e=="number"&&e>=-360&&e<=360}function vc(e){return ol(e)}function pc(e){return en(e)&&e>=0}function yc(e){return hi(e)}function il(e){return typeof e=="string"&&/^(http:\/\/|https:\/\/|\.\/|\/)/.test(`${e}`)}function al(e){return typeof e=="string"&&/^(data:image\/)/.test(`${e}`)}function wc(e){return al(e)||il(e)}function bc(e){return typeof e=="string"&&/^(<svg[\s]{1,}|<svg>)/i.test(`${e}`.trim())&&/<\/[\s]{0,}svg>$/i.test(`${e}`.trim())}function Sc(e){let t=!1;if(typeof e=="string"){let n=document.createElement("div");n.innerHTML=e,n.children.length>0&&(t=!0),n=null}return t}function Ec(e){return typeof e=="string"}function Mc(e){return en(e)&&e>0}function xc(e){return en(e)&&e>0}function Cc(e){return en(e)&&e>0}function zc(e){return["center","left","right"].includes(e)}function Ic(e){return typeof e=="string"&&e.length>0}function Ac(e){return["bold"].includes(e)}function Nc(e){return/^(-?\d+(?:\.\d+)?)$/.test(`${e}`)}const Se={x:hc,y:fc,w:ol,h:mc,angle:gc,number:en,numberStr:Nc,borderWidth:vc,borderRadius:pc,color:yc,imageSrc:wc,imageURL:il,imageBase64:al,svg:bc,html:Sc,text:Ec,fontSize:Mc,lineHeight:xc,textAlign:zc,fontFamily:Ic,fontWeight:Ac,strokeWidth:Cc};var yo=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},q=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},ee,ut;const Dc=12,Tc="400",Pc="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'";class sl{constructor(t,n){ee.set(this,void 0),ut.set(this,void 0),yo(this,ee,t,"f"),yo(this,ut,Object.assign({devicePixelRatio:1,offscreenCanvas:null},n),"f"),this.$resetFont()}$undoPixelRatio(t){return t/q(this,ut,"f").devicePixelRatio}$doPixelRatio(t){return q(this,ut,"f").devicePixelRatio*t}$getContext(){return q(this,ee,"f")}$setContext(t){yo(this,ee,t,"f")}$setFont(t){const n=[];t.fontWeight&&n.push(`${t.fontWeight}`),n.push(`${this.$doPixelRatio(t.fontSize||12)}px`),n.push(`${t.fontFamily||"sans-serif"}`),q(this,ee,"f").font=`${n.join(" ")}`}$resetFont(){this.$setFont({fontSize:Dc,fontFamily:Pc,fontWeight:Tc})}$getOffscreenCanvas(){return q(this,ut,"f").offscreenCanvas}$resize(t){const{width:n,height:o,devicePixelRatio:i,resetStyle:a}=t,{canvas:s}=q(this,ee,"f");s.width=n*i,s.height=o*i,yo(this,ut,Object.assign(Object.assign({},q(this,ut,"f")),{devicePixelRatio:i}),"f"),a===!0&&(s.style.width=`${n}px`,s.style.height=`${o}px`)}$getSize(){const{devicePixelRatio:t}=q(this,ut,"f"),{width:n,height:o}=q(this,ee,"f").canvas;return{width:n/t,height:o/t,devicePixelRatio:t}}get canvas(){return q(this,ee,"f").canvas}get fillStyle(){return q(this,ee,"f").fillStyle}set fillStyle(t){q(this,ee,"f").fillStyle=t}get strokeStyle(){return q(this,ee,"f").strokeStyle}set strokeStyle(t){q(this,ee,"f").strokeStyle=t}get lineWidth(){return this.$undoPixelRatio(q(this,ee,"f").lineWidth)}set lineWidth(t){q(this,ee,"f").lineWidth=this.$doPixelRatio(t)}get textAlign(){return q(this,ee,"f").textAlign}set textAlign(t){q(this,ee,"f").textAlign=t}get textBaseline(){return q(this,ee,"f").textBaseline}set textBaseline(t){q(this,ee,"f").textBaseline=t}get globalAlpha(){return q(this,ee,"f").globalAlpha}set globalAlpha(t){q(this,ee,"f").globalAlpha=t}get shadowColor(){return q(this,ee,"f").shadowColor}set shadowColor(t){q(this,ee,"f").shadowColor=t}get shadowOffsetX(){return this.$undoPixelRatio(q(this,ee,"f").shadowOffsetX)}set shadowOffsetX(t){q(this,ee,"f").shadowOffsetX=this.$doPixelRatio(t)}get shadowOffsetY(){return this.$undoPixelRatio(q(this,ee,"f").shadowOffsetY)}set shadowOffsetY(t){q(this,ee,"f").shadowOffsetY=this.$doPixelRatio(t)}get shadowBlur(){return this.$undoPixelRatio(q(this,ee,"f").shadowBlur)}set shadowBlur(t){q(this,ee,"f").shadowBlur=this.$doPixelRatio(t)}get lineCap(){return q(this,ee,"f").lineCap}set lineCap(t){q(this,ee,"f").lineCap=t}get globalCompositeOperation(){return q(this,ee,"f").globalCompositeOperation}set globalCompositeOperation(t){q(this,ee,"f").globalCompositeOperation=t}fill(...t){return q(this,ee,"f").fill(...t)}arc(t,n,o,i,a,s){return q(this,ee,"f").arc(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),i,a,s)}rect(t,n,o,i){return q(this,ee,"f").rect(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i))}fillRect(t,n,o,i){return q(this,ee,"f").fillRect(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i))}clearRect(t,n,o,i){return q(this,ee,"f").clearRect(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i))}beginPath(){return q(this,ee,"f").beginPath()}closePath(){return q(this,ee,"f").closePath()}lineTo(t,n){return q(this,ee,"f").lineTo(this.$doPixelRatio(t),this.$doPixelRatio(n))}moveTo(t,n){return q(this,ee,"f").moveTo(this.$doPixelRatio(t),this.$doPixelRatio(n))}arcTo(t,n,o,i,a){return q(this,ee,"f").arcTo(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i),this.$doPixelRatio(a))}getLineDash(){return q(this,ee,"f").getLineDash()}setLineDash(t){const n=t.map(o=>this.$doPixelRatio(o));return q(this,ee,"f").setLineDash(n)}stroke(t){return t?q(this,ee,"f").stroke(t):q(this,ee,"f").stroke()}translate(t,n){return q(this,ee,"f").translate(this.$doPixelRatio(t),this.$doPixelRatio(n))}rotate(t){return q(this,ee,"f").rotate(t)}drawImage(...t){const n=t[0],o=t[1],i=t[2],a=t[3],s=t[4],r=t[t.length-4],c=t[t.length-3],d=t[t.length-2],u=t[t.length-1];return t.length===9?q(this,ee,"f").drawImage(n,this.$doPixelRatio(o),this.$doPixelRatio(i),this.$doPixelRatio(a),this.$doPixelRatio(s),this.$doPixelRatio(r),this.$doPixelRatio(c),this.$doPixelRatio(d),this.$doPixelRatio(u)):q(this,ee,"f").drawImage(n,this.$doPixelRatio(r),this.$doPixelRatio(c),this.$doPixelRatio(d),this.$doPixelRatio(u))}createPattern(t,n){return q(this,ee,"f").createPattern(t,n)}measureText(t){return q(this,ee,"f").measureText(t)}fillText(t,n,o,i){return i!==void 0?q(this,ee,"f").fillText(t,this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i)):q(this,ee,"f").fillText(t,this.$doPixelRatio(n),this.$doPixelRatio(o))}strokeText(t,n,o,i){return i!==void 0?q(this,ee,"f").strokeText(t,this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i)):q(this,ee,"f").strokeText(t,this.$doPixelRatio(n),this.$doPixelRatio(o))}save(){q(this,ee,"f").save()}restore(){q(this,ee,"f").restore()}scale(t,n){q(this,ee,"f").scale(t,n)}circle(t,n,o,i,a,s,r,c){q(this,ee,"f").ellipse(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i),a,s,r,c)}isPointInPath(t,n){return q(this,ee,"f").isPointInPath(this.$doPixelRatio(t),this.$doPixelRatio(n))}clip(...t){return q(this,ee,"f").clip(...t)}setTransform(t,n,o,i,a,s){return q(this,ee,"f").setTransform(t,n,o,i,a,s)}getTransform(){return q(this,ee,"f").getTransform()}createLinearGradient(t,n,o,i){return q(this,ee,"f").createLinearGradient(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i))}createRadialGradient(t,n,o,i,a,s){return q(this,ee,"f").createRadialGradient(this.$doPixelRatio(t),this.$doPixelRatio(n),this.$doPixelRatio(o),this.$doPixelRatio(i),this.$doPixelRatio(a),this.$doPixelRatio(s))}createConicGradient(t,n,o){return q(this,ee,"f").createConicGradient(t,this.$doPixelRatio(n),this.$doPixelRatio(o))}}ee=new WeakMap,ut=new WeakMap;function an(e){const{width:t,height:n,ctx:o,devicePixelRatio:i}=e;let a=o;if(!a){const r=document.createElement("canvas");r.width=t*i,r.height=n*i,a=r.getContext("2d")}return new sl(a,e)}function Fo(e){const{width:t,height:n,devicePixelRatio:o}=e,i=new OffscreenCanvas(t*o,n*o),s=i.getContext("2d").canvas.getContext("2d");return new sl(s,{devicePixelRatio:o,offscreenCanvas:i})}function Oc(e,t){const{width:n,height:o,devicePixelRatio:i,offscreen:a,createCustomContext2D:s}=t,r={width:n,height:o,devicePixelRatio:i},c=e.getContext("2d");if(s){const d=s(r),u=s(r),h=s(r),f=an(Object.assign({ctx:c},r));return{underlayContext:h,viewContext:d,overlayContext:u,boardContext:f,drawView:()=>{const{width:g,height:p}=d.$getSize();f.clearRect(0,0,g,p),f.drawImage(h.canvas,0,0,g,p),f.drawImage(d.canvas,0,0,g,p),f.drawImage(u.canvas,0,0,g,p),h.clearRect(0,0,g,p),d.clearRect(0,0,g,p),u.clearRect(0,0,g,p)}}}if(a===!0){const d=Fo(r),u=Fo(r),h=Fo(r),f=an(Object.assign({ctx:c},r));return{underlayContext:h,viewContext:d,overlayContext:u,boardContext:f,drawView:()=>{const{width:g,height:p}=d.$getSize();f.clearRect(0,0,g,p),f.drawImage(h.canvas,0,0,g,p),f.drawImage(d.canvas,0,0,g,p),f.drawImage(u.canvas,0,0,g,p),h.clearRect(0,0,g,p),d.clearRect(0,0,g,p),u.clearRect(0,0,g,p)}}}else{const d=an(r),u=an(r),h=an(r),f=an(Object.assign({ctx:c},r));return{underlayContext:h,viewContext:d,overlayContext:u,boardContext:f,drawView:()=>{f.clearRect(0,0,n,o),f.drawImage(h.canvas,0,0,n,o),f.drawImage(d.canvas,0,0,n,o),f.drawImage(u.canvas,0,0,n,o),h.clearRect(0,0,n,o),d.clearRect(0,0,n,o),u.clearRect(0,0,n,o)}}}}var Rc=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},at=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},He;class Qt{constructor(){He.set(this,void 0),Rc(this,He,new Map,"f")}on(t,n){if(at(this,He,"f").has(t)){const o=at(this,He,"f").get(t)||[];o==null||o.push(n),at(this,He,"f").set(t,o)}else at(this,He,"f").set(t,[n])}off(t,n){if(at(this,He,"f").has(t)){const o=at(this,He,"f").get(t);if(Array.isArray(o)){for(let i=0;i<(o==null?void 0:o.length);i++)if(o[i]===n){o.splice(i,1);break}}at(this,He,"f").set(t,o||[])}}trigger(t,n){const o=at(this,He,"f").get(t);return Array.isArray(o)?(o.forEach(i=>{i(n)}),!0):!1}has(t){if(at(this,He,"f").has(t)){const n=at(this,He,"f").get(t);if(Array.isArray(n)&&n.length>0)return!0}return!1}destroy(){this.clear()}clear(){at(this,He,"f").clear()}}He=new WeakMap;function Lc(e,t){const n=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y);return n===0?n:Math.sqrt(n)}function Ze(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}var wo=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},Gt=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},Ho,ht,mi,aa;class Jt{constructor(t){Ho.add(this),ht.set(this,void 0),mi.set(this,void 0),wo(this,mi,Zt(t.defaultStorage),"f"),wo(this,ht,Gt(this,Ho,"m",aa).call(this),"f")}set(t,n){Gt(this,ht,"f")[t]=n}get(t){return Gt(this,ht,"f")[t]}getSnapshot(t){return(t==null?void 0:t.deepClone)===!0?Zt(Gt(this,ht,"f")):Object.assign({},Gt(this,ht,"f"))}clear(){wo(this,ht,Gt(this,Ho,"m",aa).call(this),"f")}destroy(){wo(this,ht,null,"f")}}ht=new WeakMap,mi=new WeakMap,Ho=new WeakSet,aa=function(){return Zt(Gt(this,mi,"f"))};function ho(e){const{activeStore:t}=e;return{scale:t==null?void 0:t.scale,offsetTop:t==null?void 0:t.offsetTop,offsetBottom:t==null?void 0:t.offsetBottom,offsetLeft:t==null?void 0:t.offsetLeft,offsetRight:t==null?void 0:t.offsetRight}}function Ii(e){const{activeStore:t}=e;return{devicePixelRatio:t.devicePixelRatio,width:t==null?void 0:t.width,height:t==null?void 0:t.height,contextWidth:t==null?void 0:t.contextWidth,contextHeight:t==null?void 0:t.contextHeight}}function kc(e){return e/Math.PI*180}function St(e){return e/180*Math.PI}function fo(e,t,n,o){const i=St(t||0);n&&(i>0||i<0)&&(e.translate(n.x,n.y),e.rotate(i),e.translate(-n.x,-n.y)),o(e),n&&(i>0||i<0)&&(e.translate(n.x,n.y),e.rotate(-i),e.translate(-n.x,-n.y))}function dt(e,t,n){const o=ot(t);fo(e,t.angle||0,o,()=>{n(e)})}function ot(e){return{x:e.x+e.w/2,y:e.y+e.h/2}}function ll(e){const t=Math.min(e[0].x,e[1].x,e[2].x,e[3].x),n=Math.min(e[0].y,e[1].y,e[2].y,e[3].y),o=Math.max(e[0].x,e[1].x,e[2].x,e[3].x),i=Math.max(e[0].y,e[1].y,e[2].y,e[3].y),a={x:t,y:n,w:o-t,h:i-n};return ot(a)}function jc(e,t,n){const o=sa(e,t),i=sa(e,n);return i!==null&&o!==null?o>Math.PI*3/2&&i<Math.PI/2?i+(Math.PI*2-o):i>Math.PI*3/2&&o<Math.PI/2?o+(Math.PI*2-i):i-o:0}function sa(e,t){const n=t.x-e.x,o=t.y-e.y;if(n===0){if(o<0)return 0;if(o>0)return Math.PI}else if(o===0){if(n<0)return Math.PI*3/2;if(n>0)return Math.PI/2}return n>0&&o<0?Math.atan(Math.abs(n)/Math.abs(o)):n>0&&o>0?Math.PI-Math.atan(Math.abs(n)/Math.abs(o)):n<0&&o>0?Math.PI+Math.atan(Math.abs(n)/Math.abs(o)):n<0&&o<0?2*Math.PI-Math.atan(Math.abs(n)/Math.abs(o)):0}function Me(e,t,n){let a=sa(e,t)+n;a>Math.PI*2?a=a-Math.PI*2:a<0-Math.PI*2&&(a=a+Math.PI*2),a<0&&(a=a+Math.PI*2);const s=Lc(e,t);let r=0,c=0;return a===0?(r=0,c=0-s):a>0&&a<Math.PI/2?(r=Math.sin(a)*s,c=0-Math.cos(a)*s):a===Math.PI/2?(r=s,c=0):a>Math.PI/2&&a<Math.PI?(r=Math.sin(Math.PI-a)*s,c=Math.cos(Math.PI-a)*s):a===Math.PI?(r=0,c=s):a>Math.PI&&a<3/2*Math.PI?(r=0-Math.sin(a-Math.PI)*s,c=Math.cos(a-Math.PI)*s):a===3/2*Math.PI?(r=0-s,c=0):a>3/2*Math.PI&&a<2*Math.PI?(r=0-Math.sin(2*Math.PI-a)*s,c=0-Math.cos(2*Math.PI-a)*s):a===2*Math.PI&&(r=0,c=0-s),r+=e.x,c+=e.y,{x:r,y:c}}function gi(e,t){if((t==null?void 0:t.length)>0){let n=e.x,o=e.y;return t.forEach(i=>{const{x:a,y:s,w:r,h:c,angle:d=0}=i,u=ot({x:a,y:s,w:r,h:c,angle:d}),h=Me(u,{x:n,y:o},St(d));n=h.x,o=h.y}),{x:n,y:o}}return e}function rl(e,t,n){const{x:o,y:i,w:a,h:s}=e;let r={x:o,y:i},c={x:o+a,y:i},d={x:o+a,y:i+s},u={x:o,y:i+s};if(n&&(n>0||n<0)){const h=St(lt(n));r=Me(t,r,h),c=Me(t,c,h),d=Me(t,d,h),u=Me(t,u,h)}return[r,c,d,u]}function On(e){const{angle:t=0}=e,n=ot(e);return rl(e,n,t)}function Ya(e,t,n){return[Me(e,{x:t[0].x,y:t[0].y},n),Me(e,{x:t[1].x,y:t[1].y},n),Me(e,{x:t[2].x,y:t[2].y},n),Me(e,{x:t[3].x,y:t[3].y},n)]}function lt(e){if(!(e>0||e<0)||e===0)return 0;let t=e%360;return t<0&&(t+=360),t}function cl(e){let t=!0;if(Array.isArray(e)){const n=[];e.forEach(o=>{var i;typeof o.uuid=="string"&&o.uuid?n.includes(o.uuid)?(t=!1,console.warn(`Duplicate uuids: ${o.uuid}`)):n.push(o.uuid):(t=!1,console.warn("Element missing uuid",o)),o.type==="group"&&(t=cl((i=o==null?void 0:o.detail)===null||i===void 0?void 0:i.children))})}return t}function vi(e){var t;const n={x:0,y:0,w:0,h:0};let o=null;for(let a=0;a<e.length;a++){const s=e[a];if(!((t=s==null?void 0:s.operations)===null||t===void 0)&&t.invisible)continue;const r={x:s.x,y:s.y,w:s.w,h:s.h,angle:s.angle||0};if(r.angle&&(r.angle>0||r.angle<0)){const c=On(r);if(c.length===4){const d=[c[0].x,c[1].x,c[2].x,c[3].x],u=[c[0].y,c[1].y,c[2].y,c[3].y];r.x=Math.min(...d),r.y=Math.min(...u),r.w=Math.abs(Math.max(...d)-Math.min(...d)),r.h=Math.abs(Math.max(...u)-Math.min(...u))}}if(o){const c=Math.min(r.x,n.x),d=Math.min(r.y,n.y),u=Math.max(r.x+r.w,n.x+n.w),h=Math.max(r.y+r.h,n.y+n.h);n.x=c,n.y=d,n.w=Math.abs(u-c),n.h=Math.abs(h-d)}else n.x=r.x,n.y=r.y,n.w=r.w,n.h=r.h;o=r}return{x:Math.floor(n.x),y:Math.floor(n.y),w:Math.ceil(n.w),h:Math.ceil(n.h)}}function dl(e,t){const n={x:0,y:0,w:0,h:0};e.forEach(i=>{const a={x:i.x,y:i.y,w:i.w,h:i.h,angle:i.angle};if(a.angle&&(a.angle>0||a.angle<0)){const u=On(a);if(u.length===4){const h=[u[0].x,u[1].x,u[2].x,u[3].x],f=[u[0].y,u[1].y,u[2].y,u[3].y];a.x=Math.min(...h),a.y=Math.min(...f),a.w=Math.abs(Math.max(...h)-Math.min(...h)),a.h=Math.abs(Math.max(...f)-Math.min(...f))}}const s=Math.min(a.x,n.x),r=Math.min(a.y,n.y),c=Math.max(a.x+a.w,n.x+n.w),d=Math.max(a.y+a.h,n.y+n.h);n.x=s,n.y=r,n.w=Math.abs(c-s),n.h=Math.abs(d-r)}),t!=null&&t.extend&&(n.x=Math.min(n.x,0),n.y=Math.min(n.y,0));const o={contextWidth:n.w,contextHeight:n.h};return t!=null&&t.viewWidth&&(t!=null&&t.viewHeight)&&(t==null?void 0:t.viewWidth)>0&&(t==null?void 0:t.viewHeight)>0&&(t.viewWidth>n.x+n.w&&(o.contextWidth=t.viewWidth-n.x),t.viewHeight>n.y+n.h&&(o.contextHeight=t.viewHeight-n.y)),o}function _c(e,t,n){const o=dl(e,{viewWidth:t.width,viewHeight:t.height,extend:n==null?void 0:n.extend});return(n==null?void 0:n.extend)===!0&&(o.contextWidth=Math.max(o.contextWidth,t.contextWidth),o.contextHeight=Math.max(o.contextHeight,t.contextHeight)),{contextSize:o}}function ul(e,t){var n;let o=null;for(let i=0;i<t.length;i++){const a=t[i];if(a.uuid===e){o=a;break}else if(!o&&a.type==="group"){const s=ul(e,((n=a==null?void 0:a.detail)===null||n===void 0?void 0:n.children)||[]);if((s==null?void 0:s.uuid)===e){o=s;break}}}return o}function Go(e,t){const n=[];function o(i){var a;for(let s=0;s<i.length;s++){const r=i[s];e.includes(r.uuid)?n.push(r):r.type==="group"&&o(((a=r==null?void 0:r.detail)===null||a===void 0?void 0:a.children)||[])}}return o(t),n}function Ca(e,t){const n=[];function o(i,a){var s;let r=null;for(let c=0;c<a.length;c++){const d=a[c];if(d.uuid===i){r=d;break}else if(!r&&d.type==="group"){n.push(d);const u=o(i,((s=d==null?void 0:d.detail)===null||s===void 0?void 0:s.children)||[]);if((u==null?void 0:u.uuid)===i){r=u;break}n.pop()}}return r}return o(e,t),n}function hl(e,t){var n;const o=[];let i=e;if(t.length>1)for(let a=0;a<t.length-1;a++){const s=t[a],r=i[s];if((r==null?void 0:r.type)==="group"&&Array.isArray((n=r==null?void 0:r.detail)===null||n===void 0?void 0:n.children))o.push(r),i=r.detail.children;else return null}return o}function mo(e){const{x:t,y:n,w:o,h:i,angle:a}=e;return{x:t,y:n,w:o,h:i,angle:a}}function fl(e,t){const n=[];return e.forEach(o=>{const i=Ve(o,t);i&&n.push(i)}),n}function Ve(e,t){let n=null,o=t;for(let i=0;i<e.length;i++){const a=e[i],s=o[a];if(i<e.length-1&&s.type==="group")o=s.detail.children;else if(i===e.length-1)n=s;else break}return n}function ct(e,t){const n=[];let o=!1;const i=a=>{var s;for(let r=0;r<a.length&&o!==!0;r++){n.push(r);const c=a[r];if(c.uuid===e){o=!0;break}else c.type==="group"&&i(((s=c==null?void 0:c.detail)===null||s===void 0?void 0:s.children)||[]);if(o)break;n.pop()}};return i(t),n}function ml(e){const{x:t,y:n,h:o,w:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t+i,y:n+o},{x:t,y:n+o}]}function Ne(e){const{x:t,y:n,w:o,h:i,angle:a=0}=e;return a===0?ml(e):rl(e,ot({x:t,y:n,w:o,h:i,angle:a}),a)}function za(e){const t=[];let n=0,o=0;const i=[],a=[...e];for(let s=0;s<a.length;s++){const{x:r,y:c,w:d,h:u,angle:h=0}=a[s];n+=r,o+=c;let f;if(s===0){const m={x:n,y:o,w:d,h:u,angle:h};f=Ne({x:r,y:c,w:d,h:u,angle:h}),i.push({center:ot(m),angle:h,radian:St(h)})}else{f=ml({x:n,y:o,w:d,h:u,angle:h});for(let g=0;g<i.length;g++){const{center:p,radian:S}=i[g];f=Ya(p,f,S)}const v=ll(f);if(h>0||h<0){const g=St(h);f=Ya(v,f,g)}i.push({center:v,angle:h,radian:St(h)})}t.push(f)}return t}function Vc(e,t){const{groupQueue:n}=t;if(!(n.length>0))return[Ne(e)];const o=[...n,e];return za(o)}function ro(e,t){return Vc(e,t).pop()||null}function Wc(e,t){const{scale:n,offsetX:o,offsetY:i}=e,{viewSizeInfo:a}=t,{width:s,height:r,contextWidth:c,contextHeight:d}=a,u=c*n,h=d*n,f=0-o*n,m=0-i*n,v=s-(u+f/n),g=r-(h+m/n);return{scale:n,offsetLeft:f,offsetTop:m,offsetRight:v,offsetBottom:g}}function Bc(e){const{scale:t,point:n,viewScaleInfo:o}=e,{offsetLeft:i,offsetTop:a}=o,s=t/o.scale,r=n.x,c=n.y,d=r-r*s+(i*s-i),u=c-c*s+(a*s-a);return{moveX:d,moveY:u}}function Fc(e){const{moveX:t=0,moveY:n=0,viewScaleInfo:o,viewSizeInfo:i}=e,{scale:a}=o,{width:s,height:r,contextWidth:c,contextHeight:d}=i;let u=o.offsetLeft,h=o.offsetRight,f=o.offsetTop,m=o.offsetBottom;u+=t,f+=n;const v=c*a,g=d*a;return h=s-(v+u),m=r-(g+f),{scale:a,offsetTop:f,offsetLeft:u,offsetRight:h,offsetBottom:m}}function We(e,t){const{viewScaleInfo:n}=t,{x:o,y:i,w:a,h:s,angle:r}=e,{scale:c,offsetTop:d,offsetLeft:u}=n;return{x:o*c+u,y:i*c+d,w:a*c,h:s*c,angle:r}}function me(e,t){const{viewScaleInfo:n}=t,{x:o,y:i}=e,{scale:a,offsetTop:s,offsetLeft:r}=n;return{x:o*a+r,y:i*a+s}}function je(e,t){return[me(e[0],t),me(e[1],t),me(e[2],t),me(e[3],t)]}function la(e,t){const{context2d:n,element:o,viewScaleInfo:i}=t,{angle:a=0}=o,{x:s,y:r,w:c,h:d}=We(o,{viewScaleInfo:i}),u=On({x:s,y:r,w:c,h:d,angle:a});if(u.length>=2){n.beginPath(),n.moveTo(u[0].x,u[0].y);for(let h=1;h<u.length;h++)n.lineTo(u[h].x,u[h].y);n.closePath()}return!!n.isPointInPath(e.x,e.y)}function Hc(e,t,n){const o=Ne(t);return gl(e,o)}function gl(e,t,n){const o=[t[0].x,t[1].x,t[2].x,t[3].x],i=[t[0].y,t[1].y,t[2].y,t[3].y],a=Math.min(...o),s=Math.max(...o),r=Math.min(...i),c=Math.max(...i);return e.x>a&&e.x<s&&e.y>r&&e.y<c}function Gc(e,t){var n,o,i;const{context2d:a,data:s,viewScaleInfo:r,viewSizeInfo:c,groupQueue:d}=t,u={index:-1,element:null,groupQueueIndex:-1};if(d&&Array.isArray(d)&&(d==null?void 0:d.length)>0)for(let h=d.length-1;h>=0;h--){let f=0,m=0,v=0;for(let p=0;p<=h;p++)f+=d[p].x,m+=d[p].y,v+=d[p].angle||0;const g=d[h];if(g&&g.type==="group"&&Array.isArray((n=g.detail)===null||n===void 0?void 0:n.children))for(let p=0;p<g.detail.children.length;p++){const S=g.detail.children[p];if(((o=S==null?void 0:S.operations)===null||o===void 0?void 0:o.invisible)!==!0)if(S){const E={x:f+S.x,y:m+S.y,w:S.w,h:S.h,angle:v+(S.angle||0)};if(la(e,{context2d:a,element:E,viewScaleInfo:r,viewSizeInfo:c})){u.element=S,(h<d.length-1||S.type!=="group")&&(u.groupQueueIndex=h);break}}else break}if(u.element)break}if(u.element)return u;for(let h=s.elements.length-1;h>=0;h--){const f=s.elements[h];if(((i=f==null?void 0:f.operations)===null||i===void 0?void 0:i.invisible)!==!0&&la(e,{context2d:a,element:f,viewScaleInfo:r,viewSizeInfo:c})){u.index=h,u.element=f;break}}return u}function vl(e,t){const{groupQueue:n}=t,o=ro(e,{groupQueue:n}),i=Ze(o[0],o[1]),a=Ze(o[1],o[2]),s=Ze(o[2],o[3]),r=Ze(o[3],o[0]),c=o[0],d=o[1],u=o[2],h=o[3],f=Math.max(c.x,d.x,u.x,h.x),m=Math.max(c.y,d.y,u.y,h.y),v=Math.min(c.x,d.x,u.x,h.x),g=Math.min(c.y,d.y,u.y,h.y);return{center:{x:(f+v)/2,y:(m+g)/2},topLeft:c,topRight:d,bottomLeft:h,bottomRight:u,top:i,right:a,left:r,bottom:s}}function pl(e){const t=Math.max(e.topLeft.x,e.topRight.x,e.bottomRight.x,e.bottomLeft.x),n=Math.max(e.topLeft.y,e.topRight.y,e.bottomRight.y,e.bottomLeft.y),o=Math.min(e.topLeft.x,e.topRight.x,e.bottomRight.x,e.bottomLeft.x),i=Math.min(e.topLeft.y,e.topRight.y,e.bottomRight.y,e.bottomLeft.y),a={x:e.center.x,y:e.center.y},s={x:o,y:i},r={x:t,y:i},c={x:t,y:n},d={x:o,y:n},u=Ze(s,r),h=Ze(d,c),f=Ze(s,d),m=Ze(r,c);return{center:a,topLeft:s,topRight:r,bottomLeft:d,bottomRight:c,top:u,right:m,left:f,bottom:h}}function Yc(e,t){const n={},o=[],i=a=>{const s={isVisibleInView:!0,isGroup:a.type==="group",position:[...o]};let r=null;const c=hl(e,o);r=vl(a,{groupQueue:c||[]}),n[a.uuid]=Object.assign(Object.assign({},s),{originRectInfo:r,rangeRectInfo:Se.angle(a.angle)?pl(r):r}),a.type==="group"&&a.detail.children.forEach((d,u)=>{o.push(u),i(d),o.pop()})};return e.forEach((a,s)=>{o.push(s),i(a),o.pop()}),yl(n,t)}function $c(e,t){const n=Math.min(e.topLeft.x,e.topRight.x,e.bottomLeft.x,e.bottomRight.x),o=Math.max(e.topLeft.x,e.topRight.x,e.bottomLeft.x,e.bottomRight.x),i=Math.min(e.topLeft.y,e.topRight.y,e.bottomLeft.y,e.bottomRight.y),a=Math.max(e.topLeft.y,e.topRight.y,e.bottomLeft.y,e.bottomRight.y),s=Math.min(t.topLeft.x,t.topRight.x,t.bottomLeft.x,t.bottomRight.x),r=Math.max(t.topLeft.x,t.topRight.x,t.bottomLeft.x,t.bottomRight.x),c=Math.min(t.topLeft.y,t.topRight.y,t.bottomLeft.y,t.bottomRight.y),d=Math.max(t.topLeft.y,t.topRight.y,t.bottomLeft.y,t.bottomRight.y);return n<=r&&o>=s&&i<=d&&a>=c||r<=a&&r>=a&&r<=a&&r>=a}function yl(e,t){const n=Xc(t);let o=0,i=0;return Object.keys(e).forEach(a=>{const s=e[a];s.isVisibleInView=$c(s.rangeRectInfo,n),s.isVisibleInView?o++:i++}),{viewVisibleInfoMap:e,visibleCount:o,invisibleCount:i}}function Xc(e){const{viewScaleInfo:t,viewSizeInfo:n}=e,{scale:o,offsetTop:i,offsetLeft:a}=t,{width:s,height:r}=n,c=0-a/o,d=0-i/o,u=s/o,h=r/o,f=ot({x:c,y:d,w:u,h}),m={x:c,y:d},v={x:c+u,y:d},g={x:c,y:d+h},p={x:c+u,y:d+h},S={x:c,y:f.y},E={x:f.x,y:d},w={x:c+u,y:f.y},y={x:f.x,y:d+h};return{center:f,topLeft:m,topRight:v,bottomLeft:g,bottomRight:p,left:S,top:E,right:w,bottom:y}}function Pe(e,t){const{x:n,y:o}=e,{size:i,angle:a}=t;return{x:n-i/2,y:o-i/2,w:i,h:i,angle:a}}function bo(e,t){const{groupQueue:n,controllerSize:o,viewScaleInfo:i}=t,a=(o&&o>0?o:8)/i.scale,{x:s,y:r,w:c,h:d,angle:u=0}=e,h=[{uuid:$e(),x:s,y:r,w:c,h:d,angle:u,type:"group",detail:{children:[]}},...n];let f=0;h.forEach(({angle:ie=0})=>{f+=ie});const m=ro(e,{groupQueue:n}),v=ro({x:s-a*2,y:r-a*2,h:d+a*4,w:c+a*4,angle:u},{groupQueue:[...n]}),g=Ze(m[0],m[1]),p=Ze(m[1],m[2]),S=Ze(m[2],m[3]),E=Ze(m[3],m[0]),w=m[0],y=m[1],x=m[2],b=m[3],C=Pe(g,{size:a,angle:f}),z=Pe(p,{size:a,angle:f}),L=Pe(S,{size:a,angle:f}),N=Pe(E,{size:a,angle:f}),R=Pe(w,{size:a,angle:f}),k=Pe(y,{size:a,angle:f}),_=Pe(b,{size:a,angle:f}),$=Pe(x,{size:a,angle:f}),U=Ne(R),V=Ne(k),P=Ne(_),W=Ne($),A=[U[1],V[0],V[3],U[2]],Y=[V[3],V[2],W[1],W[0]],G=[P[1],W[0],W[3],P[2]],I=[U[3],U[2],P[1],P[0]],H=Ne(C),Z=Ne(z),M=Ne(L),O=Ne(N),D=Ze(v[0],v[1]),F=Pe(D,{size:a,angle:f}),j=Ne(F);return{elementWrapper:m,left:{type:"left",vertexes:I,center:E},right:{type:"right",vertexes:Y,center:p},top:{type:"top",vertexes:A,center:g},bottom:{type:"bottom",vertexes:G,center:S},topLeft:{type:"top-left",vertexes:U,center:w},topRight:{type:"top-right",vertexes:V,center:y},bottomLeft:{type:"bottom-left",vertexes:P,center:b},bottomRight:{type:"bottom-right",vertexes:W,center:x},leftMiddle:{type:"left-middle",vertexes:O,center:E},rightMiddle:{type:"right-middle",vertexes:Z,center:p},topMiddle:{type:"top-middle",vertexes:H,center:g},bottomMiddle:{type:"bottom-middle",vertexes:M,center:S},rotate:{type:"rotate",vertexes:j,center:D}}}function $a(e,t){const{controllerSize:n,viewScaleInfo:o}=t,i=n&&n>0?n:8,{x:a,y:s,w:r,h:c}=We(e,{viewScaleInfo:o}),d=ot({x:a,y:s,w:r,h:c}),u={x:d.x,y:s},h={x:a+r,y:d.y},f={x:d.x,y:s+c},m={x:a,y:d.y},v={x:a,y:s},g={x:a+r,y:s},p={x:a+r,y:s+c},S={x:a,y:s+c},E=Pe(u,{size:i,angle:0}),w=Pe(h,{size:i,angle:0}),y=Pe(f,{size:i,angle:0}),x=Pe(m,{size:i,angle:0}),b=Pe(v,{size:i,angle:0}),C=Pe(g,{size:i,angle:0}),z=Pe(S,{size:i,angle:0}),L=Pe(p,{size:i,angle:0}),N=Ne(b),R=Ne(C),k=Ne(z),_=Ne(L),$=[N[1],R[0],R[3],N[2]],U=[R[3],R[2],_[1],_[0]],V=[k[1],_[0],_[3],k[2]],P=[N[3],N[2],k[1],k[0]],W=Ne(E),A=Ne(w),Y=Ne(y),G=Ne(x);return{left:{type:"left",vertexes:P,center:m},right:{type:"right",vertexes:U,center:h},top:{type:"top",vertexes:$,center:u},bottom:{type:"bottom",vertexes:V,center:f},topLeft:{type:"top-left",vertexes:N,center:v},topRight:{type:"top-right",vertexes:R,center:g},bottomLeft:{type:"bottom-left",vertexes:k,center:S},bottomRight:{type:"bottom-right",vertexes:_,center:p},leftMiddle:{type:"left-middle",vertexes:G,center:m},rightMiddle:{type:"right-middle",vertexes:A,center:h},topMiddle:{type:"top-middle",vertexes:W,center:u},bottomMiddle:{type:"bottom-middle",vertexes:Y,center:f}}}function Ia(e){let t="";return e.forEach(n=>{t+=n.type+n.params.join(" ")}),t}function ge(e,t){let n=2;return typeof(t==null?void 0:t.decimalPlaces)<"u"&&(t==null?void 0:t.decimalPlaces)>=0&&(n=t.decimalPlaces),parseFloat(e.toFixed(n))}const Yo="Text Element";function tn(){return{boxSizing:"border-box",borderWidth:0,borderColor:"#000000",shadowColor:"#000000",borderRadius:0,borderDash:[],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,opacity:1,color:"#000000",textAlign:"left",verticalAlign:"top",fontSize:16,fontFamily:"sans-serif",fontWeight:400,minInlineSize:"auto",wordBreak:"break-all",overflow:"hidden"}}function Uc(){return{background:"#D9D9D9"}}function Zc(){return{background:"#D9D9D9",radius:0}}function Qc(e){const t=tn();return{text:Yo,color:t.color,fontFamily:t.fontFamily,fontWeight:t.fontWeight,lineHeight:e.w/Yo.length,fontSize:e.w/Yo.length,textAlign:"center",verticalAlign:"middle"}}function Jc(){return{svg:'<svg t="1701004189871" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"   width="200" height="200"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3-12.3 12.7-12.1 32.9 0.6 45.3l183.7 179.1-43.4 252.9c-1.2 6.9-0.1 14.1 3.2 20.3 8.2 15.6 27.6 21.7 43.2 13.4L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"   fill="#2c2c2c"></path></svg>'}}function Kc(){return{src:"data:image/svg+xml;base64,PHN2ZyAgIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjIwMCIgaGVpZ2h0PSIyMDAiPjxwYXRoIGQ9Ik05MjggMTYwSDk2Yy0xNy43IDAtMzIgMTQuMy0zMiAzMnY2NDBjMCAxNy43IDE0LjMgMzIgMzIgMzJoODMyYzE3LjcgMCAzMi0xNC4zIDMyLTMyVjE5MmMwLTE3LjctMTQuMy0zMi0zMi0zMnogbS00MCA2MzJIMTM2di0zOS45bDEzOC41LTE2NC4zIDE1MC4xIDE3OEw2NTguMSA0ODkgODg4IDc2MS42Vjc5MnogbTAtMTI5LjhMNjY0LjIgMzk2LjhjLTMuMi0zLjgtOS0zLjgtMTIuMiAwTDQyNC42IDY2Ni40bC0xNDQtMTcwLjdjLTMuMi0zLjgtOS0zLjgtMTIuMiAwTDEzNiA2NTIuN1YyMzJoNzUydjQzMC4yeiIgIGZpbGw9IiM1MTUxNTEiPjwvcGF0aD48cGF0aCBkPSJNMzA0IDQ1NmM0OC42IDAgODgtMzkuNCA4OC04OHMtMzkuNC04OC04OC04OC04OCAzOS40LTg4IDg4IDM5LjQgODggODggODh6IG0wLTExNmMxNS41IDAgMjggMTIuNSAyOCAyOHMtMTIuNSAyOC0yOCAyOC0yOC0xMi41LTI4LTI4IDEyLjUtMjggMjgtMjh6IiAgZmlsbD0iIzUxNTE1MSI+PC9wYXRoPjwvc3ZnPg=="}}function qc(){return{children:[],background:"#D9D9D9",overflow:"hidden"}}const ed=tn();function Ai(e,t){const{viewScaleInfo:n}=t,{scale:o}=n;let{borderRadius:i,borderDash:a}=e.detail;const s=Array.isArray(a)&&a.length>0,{boxSizing:r=ed.boxSizing,borderWidth:c}=e.detail;Array.isArray(c)&&(i=0);let{x:d,y:u,w:h,h:f}=e,m=[0,0,0,0];if(typeof i=="number"){const g=i*o;m=[g,g,g,g]}else Array.isArray(i)&&(i==null?void 0:i.length)===4&&(m=[i[0]*o,i[1]*o,i[2]*o,i[3]*o]);let v=0;return typeof c=="number"&&(v=(c||0)*o),r==="border-box"&&!s?(d=e.x+v/2,u=e.y+v/2,h=e.w-v,f=e.h-v):r==="content-box"?(d=e.x-v/2,u=e.y-v/2,h=e.w+v,f=e.h+v):(d=e.x,u=e.y,h=e.w,f=e.h),h=Math.max(h,1),f=Math.max(f,1),m=m.map(g=>Math.min(g,h/2,f/2)),{x:d,y:u,w:h,h:f,radiusList:m}}const ke=e=>ge(e,{decimalPlaces:4});function wl(e,t){const{detail:n}=e,{xRatio:o,yRatio:i,maxRatio:a}=t,s=(o+i)/2,{borderWidth:r,borderRadius:c,borderDash:d,shadowOffsetX:u,shadowOffsetY:h,shadowBlur:f}=n;if(typeof r=="number")n.borderWidth=ke(r*s);else if(Array.isArray(n.borderWidth)){const m=r;n.borderWidth=[ke(m[0]*i),ke(m[1]*o),ke(m[2]*i),ke(m[3]*o)]}if(typeof c=="number")n.borderRadius=ke(c*s);else if(Array.isArray(n.borderRadius)){const m=c;n.borderRadius=[m[0]*o,m[1]*o,m[2]*i,m[3]*i]}Array.isArray(d)&&d.forEach((m,v)=>{n.borderDash[v]=ke(m*a)}),typeof u=="number"&&(n.shadowOffsetX=ke(u*a)),typeof h=="number"&&(n.shadowOffsetX=ke(h*a)),typeof f=="number"&&(n.shadowOffsetX=ke(f*a))}function td(e,t){const{xRatio:n,yRatio:o}=t,{x:i,y:a,w:s,h:r}=e;e.x=ke(i*n),e.y=ke(a*o),e.w=ke(s*n),e.h=ke(r*o),wl(e,t)}function nd(e,t){const{minRatio:n,maxRatio:o}=t,{fontSize:i,lineHeight:a}=e.detail,s=(n+o)/2;i&&i>0&&(e.detail.fontSize=ke(i*s)),a&&a>0&&(e.detail.lineHeight=ke(a*s))}function bl(e,t){const{type:n}=e;td(e,t),n==="circle"||(n==="text"?nd(e,t):n==="image"||n==="svg"||n==="html"||n==="path"||n==="group"&&Array.isArray(e.detail.children)&&e.detail.children.forEach(o=>{bl(o,t)}))}function Sl(e,t){const n=t.w&&t.w>0?t.w:e.w,o=t.h&&t.h>0?t.h:e.h,i=n/e.w,a=o/e.h;if(i===a&&i===1)return e;const s=Math.min(i,a),r=Math.max(i,a);e.w=n,e.h=o;const c={xRatio:i,yRatio:a,minRatio:s,maxRatio:r};return e.type==="group"&&Array.isArray(e.detail.children)&&e.detail.children.forEach(d=>{bl(d,c)}),wl(e,c),e}const ji=200,_i=200;function od(e,t){let n=0,o=0,i=ji,a=_i;if(t){const{viewScaleInfo:r,viewSizeInfo:c}=t,{scale:d,offsetLeft:u,offsetTop:h}=r,{width:f,height:m}=c,v=f/4,g=m/4;ji>=v?i=v/d:i=ji/d,_i>=g?a=g/d:a=_i/d,["circle","svg","image"].includes(e)?i=a=Math.max(i,a):e==="text"&&(a=i/Yo.length*2),n=(0-u+f/2-i*d/2)/d,o=(0-h+m/2-a*d/2)/d}return{x:n,y:o,w:i,h:a}}function id(e,t,n){const o=od(e,n);let i={};return e==="rect"?i=Uc():e==="circle"?i=Zc():e==="text"?i=Qc(o):e==="svg"?i=Jc():e==="image"?i=Kc():e==="group"&&(i=qc()),Object.assign(Object.assign(Object.assign({},o),t),{uuid:$e(),type:e,detail:Object.assign(Object.assign({},i),t.detail||{})})}function El(e,t,n){let o=!1;if(t.length===1){const i=t[0];n.splice(i,0,e),o=!0}else if(t.length>1){let i=n;for(let a=0;a<t.length;a++){const s=t[a],r=i[s];if(a===t.length-1){const c=t[a];i.splice(c,0,e),o=!0}else if(a<t.length-1&&r.type==="group")i=r.detail.children;else break}}return o}function Ml(e,t){let n=!1;if(e.length===1){const o=e[0];t.splice(o,1),n=!0}else if(e.length>1){let o=t;for(let i=0;i<e.length;i++){const a=e[i],s=o[a];if(i===e.length-1){const r=e[i];o.splice(r,1),n=!0}else if(i<e.length-1&&s.type==="group")o=s.detail.children;else break}}return n}function ad(e,t){const n=ct(e,t);return Ml(n,t)}function pi(e,t){const n=[...t.from],o=[...t.to];if(n.length===0||o.length===0)return{elements:e,from:n,to:o};if(n.length<=o.length){for(let a=0;a<n.length;a++)if(o[a]===n[a]){if(a===n.length-1)return{elements:e,from:n,to:o};continue}}const i=Ve(n,e);if(i){if(!El(i,o,e))return{elements:e,from:n,to:o};let s=-1,r=!1;if(n.length>=1&&o.length>=1){if(n.length<=o.length){if(n.length===1)n[0]<o[0]&&(r=!0);else for(let c=0;c<n.length&&n[c]===o[c];c++)if(n.length===n.length-1){r=!0;break}}if(n.length>=o.length)if(o.length===1)o[0]<n[0]&&(r=!0);else for(let c=0;c<o.length&&(c===o.length-1&&o[c]<n[c]&&(r=!0),n[c]===o[c]);c++);}if(r===!0)for(let c=0;c<n.length&&o[c]>=0;c++)o[c]!==n[c]&&o[c]<n[c]&&c==o.length-1&&(s=c);s>=0&&(n[s]=n[s]+1),Ml(n,e)}return{elements:e,from:n,to:o}}function sd(e,t){var n;const o=Object.keys(t);for(let i=0;i<o.length;i++){const a=o[i];["x","y","w","h","angle","name"].includes(a)?e[a]=t[a]:["detail","operations"].includes(a)&&(Zn.json(t[a])?(e!=null&&e.hasOwnProperty(a)||(e[a]={}),Zn.json(e[a])&&(e[a]=Object.assign(Object.assign({},e[a]),t[a]))):Zn.array(t[a])&&(e!=null&&e.hasOwnProperty(a)||(e[a]=[]),Zn.array(e[a])&&((n=t==null?void 0:t[a])===null||n===void 0||n.forEach((s,r)=>{e[a][r]=s}),e[a]=[...e[a],...t[a]])))}return e}function Rt(e,t,n){var o,i;let a=null;for(let s=0;s<n.length;s++){const r=n[s];if(r.uuid===e){r.type==="group"&&((o=r.operations)===null||o===void 0?void 0:o.deepResize)===!0&&(t.w&&t.w>0||t.h&&t.h>0)&&Sl(r,{w:t.w,h:t.h}),sd(r,t),a=r;break}else r.type==="group"&&(a=Rt(e,t,((i=r==null?void 0:r.detail)===null||i===void 0?void 0:i.children)||[]))}return a}function ld(e,t){var n,o,i,a,s,r,c,d,u,h;let f=0,m=0,v=1,g=((o=(n=e==null?void 0:e.elements)===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.x)||0,p=((a=(i=e==null?void 0:e.elements)===null||i===void 0?void 0:i[0])===null||a===void 0?void 0:a.y)||0,S=((r=(s=e==null?void 0:e.elements)===null||s===void 0?void 0:s[0])===null||r===void 0?void 0:r.w)||0,E=((d=(c=e==null?void 0:e.elements)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.h)||0;const{width:w,height:y}=t.viewSizeInfo;if(e.layout&&((h=(u=e.layout)===null||u===void 0?void 0:u.detail)===null||h===void 0?void 0:h.overflow)==="hidden"?(g=0,p=0,S=e.layout.w||0,E=e.layout.h||0):e.elements.forEach(b=>{const C={x:b.x,y:b.y,w:b.w,h:b.h,angle:b.angle};if(C.angle&&(C.angle>0||C.angle<0)){const k=On(C);if(k.length===4){const _=[k[0].x,k[1].x,k[2].x,k[3].x],$=[k[0].y,k[1].y,k[2].y,k[3].y];C.x=Math.min(..._),C.y=Math.min(...$),C.w=Math.abs(Math.max(..._)-Math.min(..._)),C.h=Math.abs(Math.max(...$)-Math.min(...$))}}const z=Math.min(C.x,g),L=Math.min(C.y,p),N=Math.max(C.x+C.w,g+S),R=Math.max(C.y+C.h,p+E);g=z,p=L,S=Math.abs(N-z),E=Math.abs(R-L)}),e.layout){const{x:b,y:C,w:z,h:L}=e.layout;Se.x(b)&&Se.y(C)&&Se.w(z)&&Se.h(L)&&(g=Math.min(g,b),p=Math.min(p,C),S=Math.max(S,z),E=Math.max(E,L))}if(S>0&&E>0){const b=ge(w/S,{decimalPlaces:4}),C=ge(y/E,{decimalPlaces:4});v=Math.min(b,C,1),f=(S*v-w)/2/v+g,m=(E*v-y)/2/v+p}return{offsetX:ge(f,{decimalPlaces:0}),offsetY:ge(m,{decimalPlaces:0}),scale:v}}function rd(e){let t=0,n=0;if(e){const{viewScaleInfo:i,viewSizeInfo:a}=e,{offsetLeft:s,offsetTop:r,scale:c}=i,{width:d,height:u}=a;t=0-s+d/c/2,n=0-r+u/c/2}return{x:t,y:n}}const cd=["-apple-system",'"system-ui"',' "Segoe UI"'," Roboto",'"Helvetica Neue"',"Arial",'"Noto Sans"'," sans-serif"];function xl(e){return[e,...cd].join(", ")}function ra(e,t,n){if(typeof t=="string")return t;const{viewElementSize:o,viewScaleInfo:i,opacity:a=1}=n,{x:s,y:r}=o,{scale:c}=i;if((t==null?void 0:t.type)==="linear-gradient"){const{start:d,end:u,stops:h}=t,f={x:s+d.x*c,y:r+d.y*c},m={x:s+u.x*c,y:r+u.y*c},v=e.createLinearGradient(f.x,f.y,m.x,m.y);return h.forEach(g=>{v.addColorStop(g.offset,Ga(g.color,a))}),v}if((t==null?void 0:t.type)==="radial-gradient"){const{inner:d,outer:u,stops:h}=t,f={x:s+d.x*c,y:r+d.y*c,radius:d.radius*c},m={x:s+u.x*c,y:r+u.y*c,radius:u.radius*c},v=e.createRadialGradient(f.x,f.y,f.radius,m.x,m.y,m.radius);return h.forEach(g=>{v.addColorStop(g.offset,Ga(g.color,a))}),v}return"#000000"}const ca=tn();function Kt(e){var t,n,o,i;let a=1;return((t=e==null?void 0:e.detail)===null||t===void 0?void 0:t.opacity)!==void 0&&((n=e==null?void 0:e.detail)===null||n===void 0?void 0:n.opacity)>=0&&((o=e==null?void 0:e.detail)===null||o===void 0?void 0:o.opacity)<=1&&(a=(i=e==null?void 0:e.detail)===null||i===void 0?void 0:i.opacity),a}function go(e,t,n){const{pattern:o,renderContent:i,originElem:a,calcElemSize:s,viewScaleInfo:r,viewSizeInfo:c}=n||{},{parentOpacity:d}=n,u=Kt(a)*d,{clipPath:h,clipPathStrokeColor:f,clipPathStrokeWidth:m}=a.detail,v=()=>{e.globalAlpha=u,Cl(e,t,{pattern:o,viewScaleInfo:r,viewSizeInfo:c}),i==null||i(),zl(e,t,{viewScaleInfo:r,viewSizeInfo:c}),e.globalAlpha=d};h?(dd(e,t,{originElem:a,calcElemSize:s,viewScaleInfo:r,viewSizeInfo:c,renderContent:()=>{v()}}),typeof m=="number"&&m>0&&f&&ud(e,t,{originElem:a,calcElemSize:s,viewScaleInfo:r,viewSizeInfo:c,parentOpacity:d})):v()}function dd(e,t,n){const{renderContent:o,originElem:i,calcElemSize:a,viewSizeInfo:s}=n,r=s.devicePixelRatio,{clipPath:c}=(i==null?void 0:i.detail)||{};if(c&&a&&c.commands){const{x:d,y:u,w:h,h:f}=a,{originW:m,originH:v,originX:g,originY:p}=c,S=h/m,E=f/v,w=g*S,y=p*E,x=d-w,b=u-y;e.save(),e.translate(x,b),e.scale(r*S,r*E);const C=Ia(c.commands||[]),z=new Path2D(C);e.clip(z),e.translate(0-x,0-b),e.setTransform(1,0,0,1,0,0),dt(e,Object.assign({},t),()=>{o==null||o()}),e.restore()}else o==null||o()}function ud(e,t,n){const{renderContent:o,originElem:i,calcElemSize:a,viewSizeInfo:s,parentOpacity:r}=n,c=s.devicePixelRatio,{clipPath:d,clipPathStrokeColor:u,clipPathStrokeWidth:h}=(i==null?void 0:i.detail)||{};if(d&&a&&d.commands&&typeof h=="number"&&h>0&&u){const{x:f,y:m,w:v,h:g}=a,{originW:p,originH:S,originX:E,originY:w}=d,y=v/p,x=g/S,b=E*y,C=w*x,z=f-b,L=m-C;e.save(),e.globalAlpha=r,e.translate(z,L),e.scale(c*y,c*x);const N=Ia(d.commands||[]),R=new Path2D(N);e.strokeStyle=u,e.lineWidth=h,e.stroke(R),e.translate(0-z,0-L),e.setTransform(1,0,0,1,0,0),dt(e,Object.assign({},t),()=>{o==null||o()}),e.restore()}else o==null||o()}function Cl(e,t,n){var o,i;const{pattern:a,viewScaleInfo:s,viewSizeInfo:r}=n,c=[];if(t.detail.background||a){const{x:d,y:u,w:h,h:f,radiusList:m}=Ai(t,{viewScaleInfo:s,viewSizeInfo:r});if(e.beginPath(),e.moveTo(d+m[0],u),e.arcTo(d+h,u,d+h,u+f,m[1]),e.arcTo(d+h,u+f,d,u+f,m[2]),e.arcTo(d,u+f,d,u,m[3]),e.arcTo(d,u,d+h,u,m[0]),e.closePath(),typeof a=="string")e.fillStyle=a;else if(["CanvasPattern"].includes(Zn.type(a)))e.fillStyle=a;else if(typeof t.detail.background=="string")e.fillStyle=t.detail.background;else if(((o=t.detail.background)===null||o===void 0?void 0:o.type)==="linear-gradient"){const v=ra(e,t.detail.background,{viewElementSize:{x:d,y:u,w:h,h:f},viewScaleInfo:s,opacity:e.globalAlpha});e.fillStyle=v}else if(((i=t.detail.background)===null||i===void 0?void 0:i.type)==="radial-gradient"){const v=ra(e,t.detail.background,{viewElementSize:{x:d,y:u,w:h,h:f},viewScaleInfo:s,opacity:e.globalAlpha});if(e.fillStyle=v,c&&c.length>0)for(let g=0;g<(c==null?void 0:c.length);g++){const p=c[g];p.method==="translate"?e.translate(p.args[0]+d,p.args[1]+u):p.method==="rotate"?e.rotate(...p.args):p.method==="scale"&&e.scale(...p.args)}}e.fill(),c&&c.length>0&&e.setTransform(1,0,0,1,0,0)}}function zl(e,t,n){if(t.detail.borderWidth===0||!hi(t.detail.borderColor))return;const{viewScaleInfo:o}=n,{scale:i}=o;let a=ca.borderColor;hi(t.detail.borderColor)===!0&&(a=t.detail.borderColor);const{borderWidth:s,borderRadius:r,borderDash:c,boxSizing:d=ca.boxSizing}=t.detail;let u=0;typeof s=="number"&&(u=s||1),u=u*i;let h=[0,0,0,0];if(typeof r=="number"){const S=r*i;h=[S,S,S,S]}else Array.isArray(r)&&(r==null?void 0:r.length)===4&&(h=[r[0]*i,r[1]*i,r[2]*i,r[3]*i]);e.strokeStyle=a;let f=[];Array.isArray(c)&&c.length>0&&(f=c.map(S=>Math.ceil(S*i)));let m=0,v=0,g=0,p=0;if(Array.isArray(s)&&(m=(s[0]||0)*i,v=(s[1]||0)*i,g=(s[2]||0)*i,p=(s[3]||0)*i),p||v||m||g){e.lineCap="butt";let{x:S,y:E,w,h:y}=t;d==="border-box"?(S=S+p/2,E=E+m/2,w=w-p/2-v/2,y=y-m/2-g/2):d==="content-box"?(S=S-p/2,E=E-m/2,w=w+p/2+v/2,y=y+m/2+g/2):(S=t.x,E=t.y,w=t.w,y=t.h),m&&(e.beginPath(),e.lineWidth=m,e.moveTo(S-p/2,E),e.lineTo(S+w+v/2,E),e.closePath(),e.stroke()),v&&(e.beginPath(),e.lineWidth=v,e.moveTo(S+w,E-m/2),e.lineTo(S+w,E+y+g/2),e.closePath(),e.stroke()),g&&(e.beginPath(),e.lineWidth=g,e.moveTo(S-p/2,E+y),e.lineTo(S+w+v/2,E+y),e.closePath(),e.stroke()),p&&(e.beginPath(),e.lineWidth=p,e.moveTo(S,E-m/2),e.lineTo(S,E+y+g/2),e.closePath(),e.stroke())}else{let{x:S,y:E,w,h:y}=t;d==="border-box"?(S=t.x+u/2,E=t.y+u/2,w=t.w-u,y=t.h-u):d==="content-box"?(S=t.x-u/2,E=t.y-u/2,w=t.w+u,y=t.h+u):(S=t.x,E=t.y,w=t.w,y=t.h),f.length>0?e.lineCap="butt":e.lineCap="square",w=Math.max(w,1),y=Math.max(y,1),h=h.map(x=>Math.min(x,w/2,y/2)),e.setLineDash(f),e.lineWidth=u,e.beginPath(),e.moveTo(S+h[0],E),e.arcTo(S+w,E,S+w,E+y,h[1]),e.arcTo(S+w,E+y,S,E+y,h[2]),e.arcTo(S,E+y,S,E,h[3]),e.arcTo(S,E,S+w,E,h[0]),e.closePath(),e.stroke()}e.setLineDash([])}function nn(e,t,n){const{detail:o}=t,{viewScaleInfo:i,renderContent:a}=n,{shadowColor:s,shadowOffsetX:r,shadowOffsetY:c,shadowBlur:d}=o;Se.number(d)?(e.save(),e.shadowColor=s||ca.shadowColor,e.shadowOffsetX=(r||0)*i.scale,e.shadowOffsetY=(c||0)*i.scale,e.shadowBlur=(d||0)*i.scale,a(),e.restore()):(e.save(),e.shadowColor="transparent",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,a(),e.restore())}function hd(e,t,n){const{detail:o,angle:i}=t,{viewScaleInfo:a,viewSizeInfo:s,parentOpacity:r}=n,{background:c="#000000",borderColor:d="#000000",boxSizing:u,borderWidth:h=0,borderDash:f}=o;let m=0;typeof h=="number"&&h>0?m=h:Array.isArray(h)&&typeof h[0]=="number"&&h[0]>0&&(m=h[0]),m=m*a.scale;const{x:v,y:g,w:p,h:S}=We({x:t.x,y:t.y,w:t.w,h:t.h},{viewScaleInfo:a})||t,E=Object.assign(Object.assign({},t),{x:v,y:g,w:p,h:S,angle:i});dt(e,{x:v,y:g,w:p,h:S,angle:i},()=>{nn(e,E,{viewScaleInfo:a,viewSizeInfo:s,renderContent:()=>{let w=p/2,y=S/2;const x=v+w,b=g+y,C=w,z=y;if(m>0&&(u==="content-box"?(w=w,y=y):u==="center-line"?(w=w-m/2,y=y-m/2):(w=w-m,y=y-m)),w>=0&&y>=0){const L=Kt(E)*r;e.globalAlpha=L,e.beginPath();const N=ra(e,c,{viewElementSize:{x:v,y:g,w:p,h:S},viewScaleInfo:a,opacity:e.globalAlpha});if(e.fillStyle=N,e.circle(x,b,C,z,0,0,2*Math.PI),e.closePath(),e.fill(),e.globalAlpha=r,typeof m=="number"&&m>0){const R=m/2+w,k=m/2+y;if(e.beginPath(),f){const _=f.map($=>$*a.scale);e.setLineDash(_)}e.strokeStyle=d,e.lineWidth=m,e.circle(x,b,R,k,0,0,2*Math.PI),e.closePath(),e.stroke(),e.setLineDash([])}}}})})}function fd(e,t,n){const{viewScaleInfo:o,viewSizeInfo:i,parentOpacity:a}=n,{x:s,y:r,w:c,h:d,angle:u}=We(t,{viewScaleInfo:o})||t,h=Object.assign(Object.assign({},t),{x:s,y:r,w:c,h:d,angle:u});dt(e,{x:s,y:r,w:c,h:d,angle:u},()=>{nn(e,h,{viewScaleInfo:o,viewSizeInfo:i,renderContent:()=>{go(e,h,{originElem:t,calcElemSize:{x:s,y:r,w:c,h:d,angle:u},viewScaleInfo:o,viewSizeInfo:i,parentOpacity:a,renderContent:()=>{}})}})})}function md(e,t,n){const o=n.loader.getContent(t),{viewScaleInfo:i,viewSizeInfo:a,parentOpacity:s}=n,{x:r,y:c,w:d,h:u,angle:h}=We(t,{viewScaleInfo:i})||t,f=Object.assign(Object.assign({},t),{x:r,y:c,w:d,h:u,angle:h});dt(e,{x:r,y:c,w:d,h:u,angle:h},()=>{nn(e,f,{viewScaleInfo:i,viewSizeInfo:a,renderContent:()=>{go(e,f,{originElem:t,calcElemSize:{x:r,y:c,w:d,h:u,angle:h},viewScaleInfo:i,viewSizeInfo:a,parentOpacity:s,renderContent:()=>{if(!o&&!n.loader.isDestroyed()&&n.loader.load(t,n.elementAssets||{}),t.type==="image"&&o){e.globalAlpha=Kt(t)*s;const{x:m,y:v,w:g,h:p,radiusList:S}=Ai(f,{viewScaleInfo:i,viewSizeInfo:a}),{detail:E}=t,{scaleMode:w,originW:y=0,originH:x=0}=E,b=e.$undoPixelRatio(y),C=e.$undoPixelRatio(x);if(e.save(),e.fillStyle="transparent",e.beginPath(),e.moveTo(m+S[0],v),e.arcTo(m+g,v,m+g,v+p,S[1]),e.arcTo(m+g,v+p,m,v+p,S[2]),e.arcTo(m,v+p,m,v,S[3]),e.arcTo(m,v,m+g,v,S[0]),e.closePath(),e.fill(),e.clip(),w&&x&&y){let z=0,L=0,N=b,R=C;const k=m,_=v,$=g,U=p;if(b>t.w||C>t.h){if(w==="fill"){const V=Math.max(t.w/b,t.h/C),P=b*V,W=C*V;z=(P-t.w)/2/V,L=(W-t.h)/2/V,N=t.w/V,R=t.h/V}else if(w==="tile")z=0,L=0,N=t.w,R=t.h;else if(w==="fit"){const V=Math.min(t.w/b,t.h/C);z=(b-t.w/V)/2,L=(C-t.h/V)/2,N=t.w/V,R=t.h/V}}e.drawImage(o,z,L,N,R,k,_,$,U)}else e.drawImage(o,m,v,g,p);e.globalAlpha=s,e.restore()}}})}})})}function gd(e,t,n){const o=n.loader.getContent(t),{viewScaleInfo:i,viewSizeInfo:a,parentOpacity:s}=n,{x:r,y:c,w:d,h:u,angle:h}=We(t,{viewScaleInfo:i,viewSizeInfo:a})||t;dt(e,{x:r,y:c,w:d,h:u,angle:h},()=>{!o&&!n.loader.isDestroyed()&&n.loader.load(t,n.elementAssets||{}),t.type==="svg"&&o&&(e.globalAlpha=Kt(t)*s,e.drawImage(o,r,c,d,u),e.globalAlpha=s)})}function vd(e,t,n){const o=n.loader.getContent(t),{viewScaleInfo:i,viewSizeInfo:a,parentOpacity:s}=n,{x:r,y:c,w:d,h:u,angle:h}=We(t,{viewScaleInfo:i,viewSizeInfo:a})||t;dt(e,{x:r,y:c,w:d,h:u,angle:h},()=>{!o&&!n.loader.isDestroyed()&&n.loader.load(t,n.elementAssets||{}),t.type==="html"&&o&&(e.globalAlpha=Kt(t)*s,e.drawImage(o,r,c,d,u),e.globalAlpha=s)})}const Vi=tn();function pd(e,t,n){return n<.5&&e<t&&(e-t)/e>-.15?!0:e>=t}function yd(e,t,n){const{viewScaleInfo:o,viewSizeInfo:i,parentOpacity:a}=n,{x:s,y:r,w:c,h:d,angle:u}=We(t,{viewScaleInfo:o})||t,h=Object.assign(Object.assign({},t),{x:s,y:r,w:c,h:d,angle:u});dt(e,{x:s,y:r,w:c,h:d,angle:u},()=>{nn(e,h,{viewScaleInfo:o,viewSizeInfo:i,renderContent:()=>{go(e,h,{originElem:t,calcElemSize:{x:s,y:r,w:c,h:d,angle:u},viewScaleInfo:o,viewSizeInfo:i,parentOpacity:a})}});{const f=Object.assign(Object.assign({},Vi),t.detail),m=f.fontSize||Vi.fontSize,v=m*o.scale;if(v<2)return;const p=(f.lineHeight||m)*o.scale;e.fillStyle=t.detail.color||Vi.color,e.textBaseline="top",e.$setFont({fontWeight:f.fontWeight,fontSize:v,fontFamily:xl(f.fontFamily)});let S=f.text.replace(/\r\n/gi,`
`);f.textTransform==="lowercase"?S=S.toLowerCase():f.textTransform==="uppercase"&&(S=S.toUpperCase());const E=p,w=S.split(`
`),y=[];let x=0;w.forEach((z,L)=>{if(f.minInlineSize==="maxContent")y.push({text:z,width:e.$undoPixelRatio(e.measureText(z).width)});else{let N="",k=z.split("");if(f.wordBreak==="normal"){const _=" ",$=z.split(_);k=[],$.forEach((U,V)=>{k.push(U),V<$.length-1&&k.push(_)})}if(k.length===1&&f.overflow==="visible")y.push({text:k[0],width:e.$undoPixelRatio(e.measureText(k[0]).width)});else if(k.length>0){for(let _=0;_<k.length&&(pd(e.$doPixelRatio(c),e.measureText(N+k[_]).width,o.scale)?N+=k[_]||"":(y.push({text:N,width:e.$undoPixelRatio(e.measureText(N).width)}),N=k[_]||"",x++),!((x+1)*E>d&&f.overflow==="hidden"));_++)if(k.length-1===_&&(x+1)*E<=d){y.push({text:N,width:e.$undoPixelRatio(e.measureText(N).width)}),L<w.length-1&&x++;break}}else y.push({text:"",width:0})}});let b=0,C=0;E>v&&(C=(E-v)/2),y.length*E<d&&(t.detail.verticalAlign==="top"?b=0:t.detail.verticalAlign==="bottom"?b+=d-y.length*E:b+=(d-y.length*E)/2);{const z=r+b;f.textShadowColor!==void 0&&hi(f.textShadowColor)&&(e.shadowColor=f.textShadowColor),f.textShadowOffsetX!==void 0&&Se.number(f.textShadowOffsetX)&&(e.shadowOffsetX=f.textShadowOffsetX),f.textShadowOffsetY!==void 0&&Se.number(f.textShadowOffsetY)&&(e.shadowOffsetY=f.textShadowOffsetY),f.textShadowBlur!==void 0&&Se.number(f.textShadowBlur)&&(e.shadowBlur=f.textShadowBlur),y.forEach((L,N)=>{let R=s;f.textAlign==="center"?R=s+(c-L.width)/2:f.textAlign==="right"&&(R=s+(c-L.width)),e.fillText(L.text,R,z+E*N+C)})}}})}var wd=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};function bd(e,t,n){var o,i;const{detail:a}=t,{originX:s,originY:r,originW:c,originH:d,fillRule:u}=a,{viewScaleInfo:h,viewSizeInfo:f,parentOpacity:m}=n,{x:v,y:g,w:p,h:S,angle:E}=We(t,{viewScaleInfo:h})||t,w=p/c,y=S/d,x=s*w,b=r*y,C=v-x,z=g-b,L=t.detail,N=wd(L,["clipPath","clipPathStrokeColor","clipPathStrokeWidth"]),R=h.scale*f.devicePixelRatio,k=Object.assign(Object.assign({},t),{x:v,y:g,w:p,h:S,angle:E});let _=Object.assign({},k);_.detail=N;let $=Object.assign({},t);$.detail=N,a.fill&&a.fill!=="string"&&(!((i=(o=a.fill)===null||o===void 0?void 0:o.type)===null||i===void 0)&&i.includes("gradient"))&&(_=Object.assign(Object.assign({},k),{detail:Object.assign(Object.assign({},k.detail),{background:a.fill,clipPath:{commands:a.commands,originX:s,originY:r,originW:c,originH:d}})}),$.detail=Object.assign({},_.detail)),dt(e,{x:v,y:g,w:p,h:S,angle:E},()=>{go(e,_,{originElem:$,calcElemSize:{x:v,y:g,w:p,h:S,angle:E},viewScaleInfo:h,viewSizeInfo:f,parentOpacity:m,renderContent:()=>{nn(e,k,{viewScaleInfo:h,viewSizeInfo:f,renderContent:()=>{e.save(),e.translate(C,z),e.scale(R*w/h.scale,R*y/h.scale);const U=Ia(a.commands||[]),V=new Path2D(U);a.fill&&(typeof a.fill=="string"?e.fillStyle=a.fill:e.fillStyle="transparent"),a.fill&&e.fill(V,u),a.stroke&&a.strokeWidth!==0&&(e.strokeStyle=a.stroke,e.lineWidth=(a.strokeWidth||1)/f.devicePixelRatio,e.lineCap=a.strokeLineCap||"square",e.stroke(V)),e.translate(-C,-z),e.restore()}})}})})}const Xa=.4;function Il(e,t,n){var o,i,a;if(((o=t==null?void 0:t.operations)===null||o===void 0?void 0:o.invisible)===!0)return;const{w:s,h:r}=t,{scale:c}=n.viewScaleInfo;if(c<1&&(s*c<Xa||r*c<Xa)||n.parentOpacity===0)return;const{overrideElementMap:d}=n;if(!(!((a=(i=d==null?void 0:d[t.uuid])===null||i===void 0?void 0:i.operations)===null||a===void 0)&&a.invisible))try{switch(t.type){case"rect":{fd(e,t,n);break}case"circle":{hd(e,t,n);break}case"text":{yd(e,t,n);break}case"image":{md(e,t,n);break}case"svg":{gd(e,t,n);break}case"html":{vd(e,t,n);break}case"path":{bd(e,t,n);break}case"group":{const u=Object.assign(Object.assign({},n.elementAssets||{}),t.detail.assets||{});Sd(e,t,Object.assign(Object.assign({},n),{elementAssets:u}));break}default:break}}catch(u){console.error(u)}}function Sd(e,t,n){const{viewScaleInfo:o,viewSizeInfo:i,parentOpacity:a}=n,{x:s,y:r,w:c,h:d,angle:u}=We({x:t.x,y:t.y,w:t.w,h:t.h,angle:t.angle},{viewScaleInfo:o})||t,h=Object.assign(Object.assign({},t),{x:s,y:r,w:c,h:d,angle:u});dt(e,{x:s,y:r,w:c,h:d,angle:u},()=>{e.globalAlpha=Kt(t)*a,nn(e,h,{viewScaleInfo:o,viewSizeInfo:i,renderContent:()=>{go(e,h,{originElem:t,calcElemSize:{x:s,y:r,w:c,h:d,angle:u},viewScaleInfo:o,viewSizeInfo:i,parentOpacity:a,renderContent:()=>{const{x:f,y:m,w:v,h:g,radiusList:p}=Ai(h,{viewScaleInfo:o,viewSizeInfo:i});if(t.detail.overflow==="hidden"&&(e.save(),e.fillStyle="transparent",e.beginPath(),e.moveTo(f+p[0],m),e.arcTo(f+v,m,f+v,m+g,p[1]),e.arcTo(f+v,m+g,f,m+g,p[2]),e.arcTo(f,m+g,f,m,p[3]),e.arcTo(f,m,f+v,m,p[0]),e.closePath(),e.fill(),e.clip()),Array.isArray(t.detail.children)){const{parentElementSize:S}=n,E={x:S.x+t.x,y:S.y+t.y,w:t.w||S.w,h:t.h||S.h,angle:t.angle},{calculator:w}=n;for(let y=0;y<t.detail.children.length;y++){let x=t.detail.children[y];if(x=Object.assign(Object.assign({},x),{x:E.x+x.x,y:E.y+x.y}),!(n.forceDrawAll!==!0&&!(w!=null&&w.needRender(x))))try{Il(e,x,Object.assign(Object.assign({},n),{parentOpacity:a*Kt(t)}))}catch(b){console.error(b)}}}t.detail.overflow==="hidden"&&e.restore()}})}}),e.globalAlpha=a})}const Ed=tn();function Ua(e,t,n){var o;const{elements:i=[]}=t,{parentOpacity:a}=n;for(let s=0;s<i.length;s++){const r=i[s],c=Object.assign(Object.assign({},r),{detail:Object.assign(Object.assign({},Ed),r==null?void 0:r.detail)});if(!(n.forceDrawAll!==!0&&!(!((o=n.calculator)===null||o===void 0)&&o.needRender(c))))try{Il(e,c,Object.assign(Object.assign({},n),{parentOpacity:a}))}catch(d){console.error(d)}}}function Md(e,t,n,o){const{viewScaleInfo:i,viewSizeInfo:a,parentOpacity:s}=n,r=Object.assign({uuid:"layout",type:"group"},t),{x:c,y:d,w:u,h}=We(r,{viewScaleInfo:i})||r,m=Object.assign(Object.assign({},r),{x:c,y:d,w:u,h,angle:0});if(e.globalAlpha=1,nn(e,m,{viewScaleInfo:i,viewSizeInfo:a,renderContent:()=>{Cl(e,m,{viewScaleInfo:i,viewSizeInfo:a})}}),t.detail.overflow==="hidden"){const{viewScaleInfo:v,viewSizeInfo:g}=n,p=Object.assign({uuid:"layout",type:"group"},t),S=We(p,{viewScaleInfo:v})||p,E=Object.assign(Object.assign({},p),S),{x:w,y,w:x,h:b,radiusList:C}=Ai(E,{viewScaleInfo:v,viewSizeInfo:g});e.save(),e.fillStyle="transparent",e.beginPath(),e.moveTo(w+C[0],y),e.arcTo(w+x,y,w+x,y+b,C[1]),e.arcTo(w+x,y+b,w,y+b,C[2]),e.arcTo(w,y+b,w,y,C[3]),e.arcTo(w,y,w+x,y,C[0]),e.closePath(),e.fill(),e.clip()}o(e),t.detail.overflow==="hidden"&&e.restore(),zl(e,m,{viewScaleInfo:i,viewSizeInfo:a}),e.globalAlpha=s}function xd(e,t,n){if(typeof(t==null?void 0:t.background)=="string"){const{viewSizeInfo:o}=n,{width:i,height:a}=o;e.globalAlpha=1,e.fillStyle=t.background,e.fillRect(0,0,i,a)}}var Wi=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})},ve=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},kn=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},nt,ao,zn,tt,bt,$o,Bi,Za,Qa,Ja,Al,Nl;const Cd=["image","svg","html"],Qn=e=>{var t,n,o;let i=null;return e.type==="image"?i=((t=e==null?void 0:e.detail)===null||t===void 0?void 0:t.src)||null:e.type==="svg"?i=((n=e==null?void 0:e.detail)===null||n===void 0?void 0:n.svg)||null:e.type==="html"&&(i=((o=e==null?void 0:e.detail)===null||o===void 0?void 0:o.html)||null),typeof i=="string"&&i?Ut(i)?i:Tn(i):Tn(`${$e()}-${e.uuid}-${$e()}-${$e()}`)};class zd extends Qt{constructor(){super(),nt.add(this),ao.set(this,{}),zn.set(this,{}),tt.set(this,{}),bt.set(this,!1),ve(this,nt,"m",$o).call(this,"image",(t,n)=>Wi(this,void 0,void 0,function*(){var o;const i=((o=n[t.detail.src])===null||o===void 0?void 0:o.value)||t.detail.src,a=yield zi(i);return{uuid:t.uuid,lastModified:Date.now(),content:a}})),ve(this,nt,"m",$o).call(this,"html",(t,n)=>Wi(this,void 0,void 0,function*(){var o;const i=((o=n[t.detail.html])===null||o===void 0?void 0:o.value)||t.detail.html,a=yield uc(i,{width:t.detail.originW||t.w,height:t.detail.originH||t.h});return{uuid:t.uuid,lastModified:Date.now(),content:a}})),ve(this,nt,"m",$o).call(this,"svg",(t,n)=>Wi(this,void 0,void 0,function*(){var o;const i=((o=n[t.detail.svg])===null||o===void 0?void 0:o.value)||t.detail.svg,a=yield cc(i);return{uuid:t.uuid,lastModified:Date.now(),content:a}}))}isDestroyed(){return ve(this,bt,"f")}destroy(){kn(this,bt,!0,"f"),this.clear(),kn(this,ao,null,"f"),kn(this,zn,null,"f"),kn(this,tt,null,"f")}load(t,n){ve(this,bt,"f")!==!0&&(ve(this,nt,"m",Nl).call(this,t)||Cd.includes(t.type)&&ve(this,nt,"m",Al).call(this,t,n))}getContent(t){var n,o;const i=Qn(t);return((o=(n=ve(this,tt,"f"))===null||n===void 0?void 0:n[i])===null||o===void 0?void 0:o.content)||null}getLoadItemMap(){return ve(this,tt,"f")}setLoadItemMap(t){kn(this,tt,t,"f")}}ao=new WeakMap,zn=new WeakMap,tt=new WeakMap,bt=new WeakMap,nt=new WeakSet,$o=function(t,n){ve(this,ao,"f")[t]=n},Bi=function(t){var n,o,i;let a=null;return t.type==="image"?a=((n=t==null?void 0:t.detail)===null||n===void 0?void 0:n.src)||null:t.type==="svg"?a=((o=t==null?void 0:t.detail)===null||o===void 0?void 0:o.svg)||null:t.type==="html"&&(a=((i=t==null?void 0:t.detail)===null||i===void 0?void 0:i.html)||null),a},Za=function(t){return{element:t,status:"null",content:null,error:null,startTime:-1,endTime:-1,source:ve(this,nt,"m",Bi).call(this,t)}},Qa=function(t){const n=Qn(t.element),o=ve(this,tt,"f")[n];ve(this,bt,"f")||(o?o.startTime<t.startTime&&(ve(this,tt,"f")[n]=t,this.trigger("load",Object.assign(Object.assign({},t),{countTime:t.endTime-t.startTime}))):(ve(this,tt,"f")[n]=t,this.trigger("load",Object.assign(Object.assign({},t),{countTime:t.endTime-t.startTime}))))},Ja=function(t){var n;const o=Qn(t.element),i=(n=ve(this,tt,"f"))===null||n===void 0?void 0:n[o];ve(this,bt,"f")||(i?i.startTime<t.startTime&&(ve(this,tt,"f")[o]=t,this.trigger("error",Object.assign(Object.assign({},t),{countTime:t.endTime-t.startTime}))):(ve(this,tt,"f")[o]=t,this.trigger("error",Object.assign(Object.assign({},t),{countTime:t.endTime-t.startTime}))))},Al=function(t,n){const o=ve(this,nt,"m",Za).call(this,t),i=Qn(t);if(ve(this,zn,"f")[i])return;ve(this,zn,"f")[i]=o;const a=ve(this,ao,"f")[t.type];typeof a=="function"&&!ve(this,bt,"f")&&(o.startTime=Date.now(),a(t,n).then(s=>{ve(this,bt,"f")||(o.content=s.content,o.endTime=Date.now(),o.status="load",ve(this,nt,"m",Qa).call(this,o))}).catch(s=>{console.warn(`Load element source "${o.source}" fail`,s,t),o.endTime=Date.now(),o.status="error",o.error=s,ve(this,nt,"m",Ja).call(this,o)}))},Nl=function(t){var n;const o=Qn(t),i=(n=ve(this,zn,"f"))===null||n===void 0?void 0:n[o];return!!(i&&i.status==="error"&&i.source&&i.source===ve(this,nt,"m",Bi).call(this,t))};var jn=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},st=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},da,At,yt,Xo,Dl;class Tl extends Qt{constructor(t){super(),da.add(this),At.set(this,void 0),yt.set(this,new zd),Xo.set(this,!1),jn(this,At,t,"f"),st(this,da,"m",Dl).call(this)}isDestroyed(){return st(this,Xo,"f")}destroy(){this.clear(),jn(this,At,null,"f"),st(this,yt,"f").destroy(),jn(this,yt,null,"f"),jn(this,Xo,!0,"f")}updateOptions(t){jn(this,At,t,"f")}drawData(t,n){const o=st(this,yt,"f"),{calculator:i,sharer:a}=st(this,At,"f"),s=st(this,At,"f").viewContext;s.clearRect(0,0,s.canvas.width,s.canvas.height);const r={x:0,y:0,w:n.viewSizeInfo.width,h:n.viewSizeInfo.height},c=Object.assign({loader:o,calculator:i,parentElementSize:r,elementAssets:t.assets,parentOpacity:1,overrideElementMap:a==null?void 0:a.getActiveOverrideElemenentMap()},n);xd(s,t.global,c),t.layout?Md(s,t.layout,c,()=>{Ua(s,t,c)}):Ua(s,t,c)}scale(t){const{sharer:n}=st(this,At,"f");if(!n)return;const{data:o,offsetTop:i,offsetBottom:a,offsetLeft:s,offsetRight:r,width:c,height:d,contextHeight:u,contextWidth:h,devicePixelRatio:f}=n.getActiveStoreSnapshot();o&&this.drawData(o,{viewScaleInfo:{scale:t,offsetTop:i,offsetBottom:a,offsetLeft:s,offsetRight:r},viewSizeInfo:{width:c,height:d,contextHeight:u,contextWidth:h,devicePixelRatio:f}})}setLoadItemMap(t){st(this,yt,"f").setLoadItemMap(t)}getLoadItemMap(){return st(this,yt,"f").getLoadItemMap()}getLoader(){return st(this,yt,"f")}}At=new WeakMap,yt=new WeakMap,Xo=new WeakMap,da=new WeakSet,Dl=function(){const t=st(this,yt,"f");t.on("load",n=>{this.trigger("load",n)}),t.on("error",n=>{console.error(n)})};var Fi=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},Be=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},wn,Re;class Pl{constructor(t){wn.set(this,void 0),Re.set(this,void 0),Fi(this,wn,t,"f"),Fi(this,Re,new Jt({defaultStorage:{viewVisibleInfoMap:{},visibleCount:0,invisibleCount:0}}),"f")}toGridNum(t,n){return(n==null?void 0:n.ignore)===!0?t:Math.round(t)}destroy(){Fi(this,wn,null,"f")}needRender(t){const o=Be(this,Re,"f").get("viewVisibleInfoMap")[t.uuid];return o?o.isVisibleInView:!0}isPointInElement(t,n,o,i){const a=Be(this,wn,"f").viewContext;return la(t,{context2d:a,element:n,viewScaleInfo:o,viewSizeInfo:i})}getPointElement(t,n){const o=Be(this,wn,"f").viewContext;return Gc(t,Object.assign(Object.assign({},n),{context2d:o}))}resetViewVisibleInfoMap(t,n){if(t){const{viewVisibleInfoMap:o,invisibleCount:i,visibleCount:a}=Yc(t.elements,n);Be(this,Re,"f").set("viewVisibleInfoMap",o),Be(this,Re,"f").set("invisibleCount",i),Be(this,Re,"f").set("visibleCount",a)}}updateVisiableStatus(t){const{viewVisibleInfoMap:n,invisibleCount:o,visibleCount:i}=yl(Be(this,Re,"f").get("viewVisibleInfoMap"),t);Be(this,Re,"f").set("viewVisibleInfoMap",n),Be(this,Re,"f").set("invisibleCount",o),Be(this,Re,"f").set("visibleCount",i)}calcViewRectInfoFromOrigin(t,n){const o=Be(this,Re,"f").get("viewVisibleInfoMap")[t];if(!(o!=null&&o.originRectInfo))return null;const{checkVisible:i,viewScaleInfo:a,viewSizeInfo:s}=n,{center:r,left:c,right:d,bottom:u,top:h,topLeft:f,topRight:m,bottomLeft:v,bottomRight:g}=o.originRectInfo;if(i===!0&&o.isVisibleInView===!1)return null;const p={viewScaleInfo:a,viewSizeInfo:s};return{center:me(r,p),left:me(c,p),right:me(d,p),bottom:me(u,p),top:me(h,p),topLeft:me(f,p),topRight:me(m,p),bottomLeft:me(v,p),bottomRight:me(g,p)}}calcViewRectInfoFromRange(t,n){const o=Be(this,Re,"f").get("viewVisibleInfoMap")[t];if(!(o!=null&&o.originRectInfo))return null;const{checkVisible:i,viewScaleInfo:a,viewSizeInfo:s}=n,{center:r,left:c,right:d,bottom:u,top:h,topLeft:f,topRight:m,bottomLeft:v,bottomRight:g}=o.rangeRectInfo;if(i===!0&&o.isVisibleInView===!1)return null;const p={viewScaleInfo:a,viewSizeInfo:s};return{center:me(r,p),left:me(c,p),right:me(d,p),bottom:me(u,p),top:me(h,p),topLeft:me(f,p),topRight:me(m,p),bottomLeft:me(v,p),bottomRight:me(g,p)}}modifyViewVisibleInfoMap(t,n){const{modifyOptions:o,viewScaleInfo:i,viewSizeInfo:a}=n,{type:s,content:r}=o,c=t.elements,d=Be(this,Re,"f").get("viewVisibleInfoMap");if(s==="deleteElement"){const{element:u}=r,h=[],f=m=>{h.push(m.uuid),m.type==="group"&&Array.isArray(m.detail.children)&&m.detail.children.forEach(v=>{f(v)})};f(u),h.forEach(m=>{delete d[m]}),Be(this,Re,"f").set("viewVisibleInfoMap",d)}else if(s==="addElement"||s==="updateElement"){const{position:u}=r,h=Ve(u,t.elements),f=hl(c,u);if(h)if(s==="updateElement"&&h.type==="group")this.resetViewVisibleInfoMap(t,{viewScaleInfo:i,viewSizeInfo:a});else{const m=vl(h,{groupQueue:f||[]}),v={originRectInfo:m,rangeRectInfo:Se.angle(h.angle)?pl(m):m,isVisibleInView:!0,isGroup:(h==null?void 0:h.type)==="group",position:[...u]};d[h.uuid]=v,Be(this,Re,"f").set("viewVisibleInfoMap",d),s==="updateElement"&&this.updateVisiableStatus({viewScaleInfo:i,viewSizeInfo:a})}}else s==="moveElement"&&this.resetViewVisibleInfoMap(t,{viewScaleInfo:i,viewSizeInfo:a})}}wn=new WeakMap,Re=new WeakMap;var Hi=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},te=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},Ee,In,qe,Uo,Ol,Zo,Qo,Jo,Ko,qo,ei,ti,ni,ft,mt,Yt;function Ka(e){return e>0||e<0||e===0}class Id extends Qt{constructor(t){super(),Ee.add(this),In.set(this,void 0),qe.set(this,void 0),Uo.set(this,!1),Zo.set(this,o=>{if(!te(this,Ee,"m",ft).call(this,o))return;const i=te(this,Ee,"m",mt).call(this,o);if(!te(this,Ee,"m",Yt).call(this,i))return;o.preventDefault(),o.stopPropagation();const a=o.deltaX>0||o.deltaX<0?o.deltaX:0,s=o.deltaY>0||o.deltaY<0?o.deltaY:0;o.ctrlKey===!0&&this.has("wheelScale")?this.trigger("wheelScale",{deltaX:a,deltaY:s,point:i}):this.has("wheel")&&this.trigger("wheel",{deltaX:a,deltaY:s,point:i})}),Qo.set(this,o=>{if(!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault();const i=te(this,Ee,"m",mt).call(this,o);te(this,Ee,"m",Yt).call(this,i)}),Jo.set(this,o=>{if(!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault();const i=te(this,Ee,"m",mt).call(this,o);if(!te(this,Ee,"m",Yt).call(this,i))return;const a=500,s=Date.now(),r=te(this,qe,"f").get("prevClickPoint");r&&s-r.t<=a&&Math.abs(r.x-i.x)<=5&&Math.abs(r.y-i.y)<=5?this.trigger("doubleClick",{point:i}):te(this,qe,"f").set("prevClickPoint",i)}),Ko.set(this,o=>{if(te(this,qe,"f").set("hasPointDown",!1),!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault();const i=te(this,Ee,"m",mt).call(this,o);this.trigger("pointLeave",{point:i})}),qo.set(this,o=>{if(te(this,qe,"f").set("hasPointDown",!1),!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault();const i=te(this,Ee,"m",mt).call(this,o);this.trigger("pointEnd",{point:i})}),ei.set(this,o=>{if(!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault(),o.stopPropagation();const i=te(this,Ee,"m",mt).call(this,o);if(!te(this,Ee,"m",Yt).call(this,i)){te(this,qe,"f").get("hasPointDown")&&(this.trigger("pointLeave",{point:i}),te(this,qe,"f").set("hasPointDown",!1));return}te(this,qe,"f").get("hasPointDown")===!0&&this.trigger("pointMove",{point:i})}),ti.set(this,o=>{if(!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault();const i=te(this,Ee,"m",mt).call(this,o);te(this,Ee,"m",Yt).call(this,i)&&(te(this,qe,"f").set("hasPointDown",!0),this.trigger("pointStart",{point:i}))}),ni.set(this,o=>{if(!te(this,Ee,"m",ft).call(this,o))return;o.preventDefault();const i=te(this,Ee,"m",mt).call(this,o);te(this,Ee,"m",Yt).call(this,i)&&this.trigger("hover",{point:i})});const n=new Jt({defaultStorage:{hasPointDown:!1,prevClickPoint:null}});Hi(this,qe,n,"f"),Hi(this,In,t,"f"),te(this,Ee,"m",Ol).call(this)}onEvents(){if(te(this,Uo,"f"))return;const t=window;t.addEventListener("mousemove",te(this,ni,"f")),t.addEventListener("mousedown",te(this,ti,"f")),t.addEventListener("mousemove",te(this,ei,"f")),t.addEventListener("mouseup",te(this,qo,"f")),t.addEventListener("mouseleave",te(this,Ko,"f")),t.addEventListener("wheel",te(this,Zo,"f"),{passive:!1}),t.addEventListener("click",te(this,Jo,"f")),t.addEventListener("contextmenu",te(this,Qo,"f"))}offEvents(){const t=window;t.removeEventListener("mousemove",te(this,ni,"f")),t.removeEventListener("mousedown",te(this,ti,"f")),t.removeEventListener("mousemove",te(this,ei,"f")),t.removeEventListener("mouseup",te(this,qo,"f")),t.removeEventListener("mouseleave",te(this,Ko,"f")),t.removeEventListener("wheel",te(this,Zo,"f")),t.removeEventListener("click",te(this,Jo,"f")),t.removeEventListener("contextmenu",te(this,Qo,"f"))}destroy(){this.offEvents(),te(this,qe,"f").destroy(),Hi(this,Uo,!0,"f")}}In=new WeakMap,qe=new WeakMap,Uo=new WeakMap,Zo=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,Ko=new WeakMap,qo=new WeakMap,ei=new WeakMap,ti=new WeakMap,ni=new WeakMap,Ee=new WeakSet,Ol=function(){this.onEvents()},ft=function(t){return t.target===te(this,In,"f").boardContent.boardContext.canvas},mt=function(t){const o=te(this,In,"f").boardContent.boardContext.canvas.getBoundingClientRect();return{x:t.clientX-o.left,y:t.clientY-o.top,t:Date.now()}},Yt=function(t){const n=te(this,In,"f").sharer.getActiveViewSizeInfo(),{width:o,height:i}=n;return!!(Ka(t.x)&&Ka(t.y)&&t.x<=o&&t.y<=i)};var qa=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},pe=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},ye,bn;const Ad={width:0,height:0,devicePixelRatio:1,contextWidth:0,contextHeight:0,data:null,scale:1,offsetLeft:0,offsetRight:0,offsetTop:0,offsetBottom:0,overrideElementMap:null};class Nd{constructor(){ye.set(this,void 0),bn.set(this,void 0);const t=new Jt({defaultStorage:Ad}),n=new Jt({defaultStorage:{}});qa(this,ye,t,"f"),qa(this,bn,n,"f")}getActiveStorage(t){return pe(this,ye,"f").get(t)}setActiveStorage(t,n){return pe(this,ye,"f").set(t,n)}getActiveStoreSnapshot(t){return pe(this,ye,"f").getSnapshot(t)}getSharedStorage(t){return pe(this,bn,"f").get(t)}setSharedStorage(t,n){return pe(this,bn,"f").set(t,n)}getSharedStoreSnapshot(t){return pe(this,bn,"f").getSnapshot(t)}getActiveViewScaleInfo(){return{scale:pe(this,ye,"f").get("scale"),offsetTop:pe(this,ye,"f").get("offsetTop"),offsetBottom:pe(this,ye,"f").get("offsetBottom"),offsetLeft:pe(this,ye,"f").get("offsetLeft"),offsetRight:pe(this,ye,"f").get("offsetRight")}}setActiveViewScaleInfo(t){const{scale:n,offsetTop:o,offsetBottom:i,offsetLeft:a,offsetRight:s}=t;pe(this,ye,"f").set("scale",n),pe(this,ye,"f").set("offsetTop",o),pe(this,ye,"f").set("offsetBottom",i),pe(this,ye,"f").set("offsetLeft",a),pe(this,ye,"f").set("offsetRight",s)}setActiveViewSizeInfo(t){pe(this,ye,"f").set("width",t.width),pe(this,ye,"f").set("height",t.height),pe(this,ye,"f").set("devicePixelRatio",t.devicePixelRatio),pe(this,ye,"f").set("contextWidth",t.contextWidth),pe(this,ye,"f").set("contextHeight",t.contextHeight)}getActiveViewSizeInfo(){return{width:pe(this,ye,"f").get("width"),height:pe(this,ye,"f").get("height"),devicePixelRatio:pe(this,ye,"f").get("devicePixelRatio"),contextWidth:pe(this,ye,"f").get("contextWidth"),contextHeight:pe(this,ye,"f").get("contextHeight")}}getActiveOverrideElemenentMap(){return pe(this,ye,"f").get("overrideElementMap")}setActiveOverrideElemenentMap(t){pe(this,ye,"f").set("overrideElementMap",t)}}ye=new WeakMap,bn=new WeakMap;var oi=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},Ie=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},so,Le,An,Sn,Rl,Ll;const{requestAnimationFrame:Dd}=window;class Td extends Qt{constructor(t){super(),so.add(this),Le.set(this,void 0),An.set(this,[]),Sn.set(this,"FREE"),oi(this,Le,t,"f"),Ie(this,so,"m",Rl).call(this)}resetViewVisibleInfoMap(t,n){t&&Ie(this,Le,"f").calculator.resetViewVisibleInfoMap(t,n)}drawFrame(){const{sharer:t}=Ie(this,Le,"f"),n=t.getActiveStoreSnapshot(),o=t.getSharedStoreSnapshot();Ie(this,An,"f").push({activeStore:n,sharedStore:o}),Ie(this,so,"m",Ll).call(this)}scale(t){const{scale:n,point:o,ignoreUpdateVisibleStatus:i}=t,{sharer:a}=Ie(this,Le,"f"),{moveX:s,moveY:r}=Bc({scale:n,point:o,viewScaleInfo:a.getActiveViewScaleInfo(),viewSizeInfo:a.getActiveViewSizeInfo()});return a.setActiveStorage("scale",n),i||Ie(this,Le,"f").calculator.updateVisiableStatus({viewScaleInfo:a.getActiveViewScaleInfo(),viewSizeInfo:a.getActiveViewSizeInfo()}),{moveX:s,moveY:r}}scroll(t){const{sharer:n}=Ie(this,Le,"f"),o=n.getActiveViewScaleInfo(),{moveX:i,moveY:a,ignoreUpdateVisibleStatus:s}=t,r=n.getActiveViewSizeInfo(),c=Fc({moveX:i,moveY:a,viewScaleInfo:o,viewSizeInfo:r});return n.setActiveViewScaleInfo(c),s||Ie(this,Le,"f").calculator.updateVisiableStatus({viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo()}),c}updateViewScaleInfo(t){const{sharer:n}=Ie(this,Le,"f"),o=Wc(t,{viewSizeInfo:n.getActiveViewSizeInfo()});return n.setActiveViewScaleInfo(o),Ie(this,Le,"f").calculator.updateVisiableStatus({viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo()}),o}resize(t={},n){const{sharer:o}=Ie(this,Le,"f"),i=o.getActiveViewSizeInfo(),a=Object.assign(Object.assign({},i),t),{width:s,height:r,devicePixelRatio:c}=a,{underlayContext:d,boardContext:u,overlayContext:h,viewContext:f}=Ie(this,Le,"f").boardContent;return u.canvas.width=s*c,u.canvas.height=r*c,u.canvas.style.width=`${s}px`,u.canvas.style.height=`${r}px`,d.canvas.width=s*c,d.canvas.height=r*c,h.canvas.width=s*c,h.canvas.height=r*c,f.canvas.width=s*c,f.canvas.height=r*c,o.setActiveViewSizeInfo(a),n!=null&&n.ignoreUpdateVisibleStatus||Ie(this,Le,"f").calculator.updateVisiableStatus({viewScaleInfo:o.getActiveViewScaleInfo(),viewSizeInfo:o.getActiveViewSizeInfo()}),a}}Le=new WeakMap,An=new WeakMap,Sn=new WeakMap,so=new WeakSet,Rl=function(){const{renderer:t}=Ie(this,Le,"f");t.on("load",()=>{this.drawFrame()})},Ll=function e(){if(Ie(this,Sn,"f")==="DRAWING"||Ie(this,An,"f").length===0)return;oi(this,Sn,"DRAWING","f");const t=Ie(this,An,"f").shift(),{renderer:n,boardContent:o,beforeDrawFrame:i,afterDrawFrame:a}=Ie(this,Le,"f");if(t){const{scale:s,offsetTop:r,offsetBottom:c,offsetLeft:d,offsetRight:u,width:h,height:f,contextHeight:m,contextWidth:v,devicePixelRatio:g}=t.activeStore,p={scale:s,offsetTop:r,offsetBottom:c,offsetLeft:d,offsetRight:u},S={width:h,height:f,contextHeight:m,contextWidth:v,devicePixelRatio:g};t!=null&&t.activeStore.data&&n.drawData(t.activeStore.data,{viewScaleInfo:p,viewSizeInfo:S}),i({snapshot:t}),o.drawView(),a({snapshot:t})}if(Ie(this,An,"f").length===0){oi(this,Sn,"COMPLETE","f");return}oi(this,Sn,"DRAWING","f")&&Dd(()=>{Ie(this,so,"m",e).call(this)})};var Nt=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},X=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},Ae,En,wt,yi,fe,Te,Nn,rt,Xe,Mn,Dn,ii,kl,es,ts,ns,os,is,as,ss,ls,rs,cs,jl,_l,Vl,Jn;class Pd{constructor(t){Ae.add(this),En.set(this,void 0),wt.set(this,new WeakMap),yi.set(this,[]),fe.set(this,[]),Te.set(this,void 0),Nn.set(this,void 0),rt.set(this,void 0),Xe.set(this,void 0),Mn.set(this,void 0),Dn.set(this,new Qt),ii.set(this,!1);const{boardContent:n}=t,o=new Nd,i=new Pl({viewContext:n.viewContext}),a=new Id({boardContent:n,sharer:o}),s=new Tl({viewContext:n.viewContext,sharer:o,calculator:i});Nt(this,En,t,"f"),Nt(this,rt,o,"f"),Nt(this,Te,a,"f"),Nt(this,Nn,s,"f"),Nt(this,Mn,i,"f"),Nt(this,Xe,new Td({boardContent:t.boardContent,sharer:o,renderer:s,calculator:X(this,Mn,"f"),beforeDrawFrame:r=>{X(this,Ae,"m",_l).call(this,r)},afterDrawFrame:r=>{X(this,Ae,"m",Vl).call(this,r)}}),"f"),X(this,Ae,"m",kl).call(this),X(this,Ae,"m",Jn).call(this)}isDestroyed(){return X(this,ii,"f")}destroy(){X(this,Te,"f").destroy(),X(this,Nn,"f").destroy(),X(this,Mn,"f").destroy(),X(this,Dn,"f").destroy(),Nt(this,ii,!0,"f")}getSharer(){return X(this,rt,"f")}getViewer(){return X(this,Xe,"f")}getRenderer(){return X(this,Nn,"f")}setData(t,n){const{modifiedOptions:o}=n||{},i=X(this,rt,"f");X(this,rt,"f").setActiveStorage("data",t);const a=i.getActiveViewSizeInfo(),s=i.getActiveViewScaleInfo(),r=dl(t.elements,{viewWidth:a.width,viewHeight:a.height,extend:!0});o?X(this,Xe,"f").resetViewVisibleInfoMap(t,{viewSizeInfo:a,viewScaleInfo:s}):X(this,Xe,"f").resetViewVisibleInfoMap(t,{viewSizeInfo:a,viewScaleInfo:s}),X(this,Xe,"f").drawFrame();const c=Object.assign(Object.assign({},a),r);return X(this,rt,"f").setActiveViewSizeInfo(c),{viewSizeInfo:c}}getData(){const{data:t}=X(this,rt,"f").getActiveStoreSnapshot();return t}use(t){var n,o,i;if(X(this,wt,"f").has(t)){const f=X(this,wt,"f").get(t);if(f){(o=(n=f.middlewareObject).use)===null||o===void 0||o.call(n),f.status="enable",X(this,wt,"f").set(t,f),X(this,Ae,"m",Jn).call(this);return}}const{boardContent:a,container:s}=X(this,En,"f"),r=X(this,rt,"f"),c=X(this,Xe,"f"),d=X(this,Mn,"f"),u=X(this,Dn,"f"),h=t({boardContent:a,sharer:r,viewer:c,calculator:d,eventHub:u,container:s});(i=h.use)===null||i===void 0||i.call(h),X(this,yi,"f").push(t),X(this,fe,"f").push(h),X(this,wt,"f").set(t,{status:"enable",middlewareObject:h}),X(this,Ae,"m",Jn).call(this)}disuse(t){var n,o;const i=X(this,wt,"f").get(t);i&&((o=(n=i.middlewareObject).disuse)===null||o===void 0||o.call(n),i.status="disable",X(this,wt,"f").set(t,i),X(this,Ae,"m",Jn).call(this))}scale(t){const n=X(this,Xe,"f"),{ignoreUpdateVisibleStatus:o}=t,{moveX:i,moveY:a}=n.scale(Object.assign(Object.assign({},t),{ignoreUpdateVisibleStatus:!0}));n.scroll({moveX:i,moveY:a,ignoreUpdateVisibleStatus:o})}scroll(t){return X(this,Xe,"f").scroll(t)}updateViewScaleInfo(t){return X(this,Xe,"f").updateViewScaleInfo(t)}resize(t,n){const o=X(this,Xe,"f").resize(t,n),{width:i,height:a,devicePixelRatio:s}=t,{boardContent:r}=X(this,En,"f");r.viewContext.$resize({width:i,height:a,devicePixelRatio:s}),r.overlayContext.$resize({width:i,height:a,devicePixelRatio:s}),r.boardContext.$resize({width:i,height:a,devicePixelRatio:s}),r.underlayContext.$resize({width:i,height:a,devicePixelRatio:s}),X(this,Xe,"f").drawFrame(),X(this,Te,"f").trigger("resize",o),X(this,rt,"f").setActiveViewSizeInfo(t)}clear(){const{boardContent:t}=X(this,En,"f"),{underlayContext:n,overlayContext:o,viewContext:i,boardContext:a}=t;n.clearRect(0,0,n.canvas.width,n.canvas.height),o.clearRect(0,0,o.canvas.width,o.canvas.height),i.clearRect(0,0,i.canvas.width,i.canvas.height),a.clearRect(0,0,a.canvas.width,a.canvas.height),X(this,Ae,"m",jl).call(this)}getEventHub(){return X(this,Dn,"f")}onWatcherEvents(){X(this,Te,"f").onEvents()}offWatcherEvents(){X(this,Te,"f").offEvents()}}En=new WeakMap,wt=new WeakMap,yi=new WeakMap,fe=new WeakMap,Te=new WeakMap,Nn=new WeakMap,rt=new WeakMap,Xe=new WeakMap,Mn=new WeakMap,Dn=new WeakMap,ii=new WeakMap,Ae=new WeakSet,kl=function(){X(this,Te,"f").on("pointStart",X(this,Ae,"m",es).bind(this)),X(this,Te,"f").on("pointEnd",X(this,Ae,"m",ts).bind(this)),X(this,Te,"f").on("pointMove",X(this,Ae,"m",ns).bind(this)),X(this,Te,"f").on("hover",X(this,Ae,"m",os).bind(this)),X(this,Te,"f").on("wheel",X(this,Ae,"m",as).bind(this)),X(this,Te,"f").on("wheelScale",X(this,Ae,"m",ss).bind(this)),X(this,Te,"f").on("scrollX",X(this,Ae,"m",ls).bind(this)),X(this,Te,"f").on("scrollY",X(this,Ae,"m",rs).bind(this)),X(this,Te,"f").on("resize",X(this,Ae,"m",cs).bind(this)),X(this,Te,"f").on("doubleClick",X(this,Ae,"m",is).bind(this)),X(this,Nn,"f").on("load",()=>{X(this,Dn,"f").trigger("loadResource")})},es=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.pointStart)===null||n===void 0?void 0:n.call(i,t))===!1)return}},ts=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.pointEnd)===null||n===void 0?void 0:n.call(i,t))===!1)return}},ns=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.pointMove)===null||n===void 0?void 0:n.call(i,t))===!1)return}},os=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.hover)===null||n===void 0?void 0:n.call(i,t))===!1)return}},is=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.doubleClick)===null||n===void 0?void 0:n.call(i,t))===!1)return}},as=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.wheel)===null||n===void 0?void 0:n.call(i,t))===!1)return}},ss=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.wheelScale)===null||n===void 0?void 0:n.call(i,t))===!1)return}},ls=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.scrollX)===null||n===void 0?void 0:n.call(i,t))===!1)return}},rs=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.scrollY)===null||n===void 0?void 0:n.call(i,t))===!1)return}},cs=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.resize)===null||n===void 0?void 0:n.call(i,t))===!1)return}},jl=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.clear)===null||n===void 0?void 0:n.call(i,t))===!1)return}},_l=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.beforeDrawFrame)===null||n===void 0?void 0:n.call(i,t))===!1)return}},Vl=function(t){var n;for(let o=0;o<X(this,fe,"f").length;o++){const i=X(this,fe,"f")[o];if(((n=i==null?void 0:i.afterDrawFrame)===null||n===void 0?void 0:n.call(i,t))===!1)return}},Jn=function(){const t=[],n=X(this,wt,"f");X(this,yi,"f").forEach(o=>{const i=n.get(o);(i==null?void 0:i.status)==="enable"&&(i!=null&&i.middlewareObject)&&t.push(i.middlewareObject)}),Nt(this,fe,t,"f")};const Od="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF92lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NzUzLCAyMDIxLzAyLzE1LTExOjUyOjEzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMDktMTdUMTY6MDc6MjYrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTA5LTE3VDE2OjEyOjUwKzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzLTA5LTE3VDE2OjEyOjUwKzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjliMGM0MzI2LWU4ZTQtNDlkNy04MmUzLTgxODkwYTE2ZmU1YSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjMzOGFhZDBmLWZkZjMtODE0MS1iMTZmLWNiZWIzNTQyYTJhMCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjUwODAxNzc1LWZlNGEtNDQyMy05NDQ3LThkYWRhNzZhYTllOSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTA4MDE3NzUtZmU0YS00NDIzLTk0NDctOGRhZGE3NmFhOWU5IiBzdEV2dDp3aGVuPSIyMDIzLTA5LTE3VDE2OjA3OjI2KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OWIwYzQzMjYtZThlNC00OWQ3LTgyZTMtODE4OTBhMTZmZTVhIiBzdEV2dDp3aGVuPSIyMDIzLTA5LTE3VDE2OjEyOjUwKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7W6XrzAAAGLklEQVRYhb2Xf2iUdRzHX/txtfXLplZ6Wblm6fzRmG6r7Uou1AxKRjQKYUqgaLBACFogppcK1h8aLRkMSYaJIA5hYMomZpskEfPOufCaDpZ6t7rbre263U3vzn3643meu+eu3XNzvz7w4bbdc/e89nl/Pu/v50HUCAQCx1tbW0uAx4CHgSwggxkKERkziUQif2mQ0WjU53a7vwSeBB4BTEDmTICmBBwYGDivVlDjlFAo9KvT6dwIPAHkANkq6MwDXr169bCISENDg9TX14s+BgcHf2hubi5mBmRPCXj06NFPREQ6OjoEkPLycrl06VIMMhKJeFwu1xdMs+wpAYuLi9eIiIyOjkpeXp4AAsj27dvF7/fHQIPB4C9dXV0fME2ypwQEXvX7/bdFRNauXRsDBMRkMsnhw4cTZB8YGGhsamp6hSmW3Qhw1Y0bN86LiNTW1iYAallWViZtbW162ftcLtdO/i/7tAAWtba2ficicvLkyTEBtdy6dasMDg7GQIeHh9s7OzvfBx5nkrIbAS7du3fvxyIiPT09hoBa1tXVJcv+fWNj4zLgUeAhJiC7EeDLwOsiMioisnDhwnFBrlixQi5evKiX/c6tW7c+R5E9lweU3QjwReDV/v7+bhGRqqqqcQFquWnTJvH5fHrZLzocjkoSZU9bTSPA54GV165daxYROXDgwAMBannw4MFk2RsaGhqWME7ZjQDNwIrTp09/JSLS0tIyIUBACgoK5MKFCzHIcDj85+3btz8FZpFGdiPAZ4DCmpqaTSIiPp9vwoBaVlVVidfr1ct+/sqVK+9iILsR4FzgJcASDoeHRUSKioomDQnI/v37E2T3+Xz1hw4dWjSW7EaAeUA+UNbX12cXEdmyZcuUAAJiNpvlzJkzetl73G53rVrN2EmUCjATuA9EgYjL5eoGKCkpGatNHijmz5/Pxo0b2blzJ2azOfZ3k8lUYDabv45Go/Y7d+6sIY0VZQOjGqDT6bxeWlrKqlWrJgRlsVhYv349FRUVWCwWcnJyEt4PBoOuoaEhu9frvdzR0fHTtm3buolvRpLqe3OBp4EllZWV74mIRKNRyc3NTSvf7Nmzpbq6Wk6cOCFut1uSY2RkJOB0Ou3Nzc3Ha2trPwPWAGXAEuBZFFPPAbKMevBhYA6wCKgIBoP9IiKrV682hLPZbP8DEpH7vb29N1paWn602WwHFyxYsAX4EKgE3gIsQBFQgOIeT6j3z0wFqEkc60OPx9Odn58/t6SkhPb29jFLbrVa2bNnDwBer7fv5s2bPQ6Ho7upqcnZ1tbmASJq3gPC6utdYESXYfWeo6mkBaUHRQ/odrv/yM/Pt5SWlqb8kAbncDh+W7lyZYN683u6DOvAwipsOOnniA4wZf9lqhdoVYzY7fbrQMpBsdlsWK1WRkZGAtXV1d8D/wA+wKNLr5o+YEC9ZggIAEHiFbyfDhCUCcoFngIWFxYWrtMaat68eQl9V15eHmu2+vr6OuAd4A2gGFgMLERp/mdQ+noWyuadi9Jr2aQ4k42GBPXDs1Ga97WhoaFbIiIbNmxIANTWq87Ozp9VuApgGfACihPkoRjwI+p3mlSgtA9ZRkYNYwwKJBr2rl27sFqthEKhwZqamqOAX5f/AsPE5btLvM/GJWO6yFb/82eBonPnztWJiJw9e1YAWb58eUzaI0eOfAO8CbwCPIfiZZN+eEoncSaKLPOApbt3794uIuL1ehOktdvtF4C3gRKURXcOSn9lTRRsvIAZKI4+l/gjQFREZMeOHSIiEggE+tetW/cRitkuRhmERxnnxjxZQFDWnzzURwCv1+vUHxHHjh37lri0C1Am9KGpgDMC1G8SQnxxCHs8Hqf2RldX10+bN28+i+JjwyT62KSaP13oAfWTHO7t7f0dIBQK/b1v375GlEnVjPYuyoQaHlNTDahVMALca29vdwBcvnz5+KlTp26OATft1UuODBS7yEOxj0K/329HOSWWopjxlE1tchhtM7FriPfgXSDDbrfXo0gbJr4QzIi0WiRPYBbKZJrUV23b0dYn7XSYcsBkS9EiO/k6lApq1cwiPjzaAM1Y9cYC1G6uAWrPCtrvMwoHqU02Q5caIEzj1KaS+D+vIjxtLug31gAAAABJRU5ErkJggg==",Wl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAYAAABHomvIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF92lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NzUzLCAyMDIxLzAyLzE1LTExOjUyOjEzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMDktMTdUMTY6MzE6MjMrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTA5LTE3VDE2OjQ0OjIyKzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzLTA5LTE3VDE2OjQ0OjIyKzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjY0MTBhYjUzLWM0ZjEtNDVhNS04MjhkLTIxOTczOWFjOTk3MSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjBkMDNmNjM5LTE5MzctY2Y0MC1hMTg0LTIyMjg0NzczNWNmYSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjgyYjQwZGRmLWE0ZGEtNDY3MC1iYzc2LTBhYjY3ZmI5M2I0ZSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ODJiNDBkZGYtYTRkYS00NjcwLWJjNzYtMGFiNjdmYjkzYjRlIiBzdEV2dDp3aGVuPSIyMDIzLTA5LTE3VDE2OjMxOjIzKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NjQxMGFiNTMtYzRmMS00NWE1LTgyOGQtMjE5NzM5YWM5OTcxIiBzdEV2dDp3aGVuPSIyMDIzLTA5LTE3VDE2OjQ0OjIyKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz57vRudAAAEk0lEQVRYhe3ZW0jbVxzA8e8/MX+NYnG9uI4xE3bvoLt0FzradRfGBtsYo32YdAhb6WQyBqV7KOylpYjzZShDGfjmyxgbgjjwyRm16SYMhgiNKDhbL3VtNF4xJOnf3x7+59i/Wf4aTbInf3AwJMdzPjnnf/n9/jFEhGzDMIxMb3uAIsDs6ek5urS05Dtz5syE+uwekAQS6u89YD19gC0NIpJ1c8GZQHlXV9fJRCIxGo/HxxoaGj4CngWOAEGgEihXfT07MeQC3MB1dna+lkgkRkXF6urq3xcuXPgUOAE8DzwGPOiGLARwEy4ej4+JiITD4elr167NiIgsLi7eqq2trQPeBI4Bj7sh8w10xZmmeds0zdn+/v5/RERisdjUuXPnvgLeAl50Q+YTaAA+oKy7u/uE3laNAwSQ4uLiu6FQ6G4G5DG13YeAMjWWkU+gBygJhULHNe769etTTpwDGXUiz58//yXwujp5qoAHgBLAk0+gNxKJHEulUiMKN2ma5gwgPp/vjhOXjlxYWJisq6urBV5RW30IKAW8eQPGYrGjlmXdEBEZHBy8aZrmFCCmac729fVtAHt7e6MO5N2+vr47IiJLS0s3L126dBZ4Sh2LZUBRwVdwYGBgVuwOYh/zsoF0bnPBVzDTMRgOh6dFhROokSIi8/Pz0+pEeaPQx+DGWdzV1XVSX2LcgCIic3NzMzU1NV8D7wIvq9WrLNRZvOk62NHRccqJTAdGo9Hb1dXV3wAfYt9VjgAPFfI66EQWAxU9PT0fuwEvXrzYBJwF3gFeAAJAhfrfrO4k/7lxZxnr2JlJqry8POnWyePx6H4JR0vhktVkHGOXQI20SkpKLLcOhmGsA5YCaZiVLS5XoADi9XpdkznDMERhnE0fCgUHZhvOW+CO4/8A5hR7wFxjD5hr7AFzjZyBlmVlrOYdYaS1HUUuQA/gWV9fd51URDyqn1c1j6MVFGjoidfW1oq2ABrYj0V82OmVzwHNajVdB88C5wOKTdM87NaxsrKyQsFKHC2BnTDo+/TWt8Bd5INeVC44NDT0xXYZdXNz8w/AaeyS8yjwCPdzQu92ht2m/OUjIyOfS1pkAoqItLS0fA+8D7wKPA0cxs6qC1O4T0xMfKYnb21tnXEDNjc3z+nXbW1t3wFvYz9dCAL7KUThHovFPtGTNjU1jQFSX18/lg68cuXKLUAaGxs3vkB7e/u3wHHgCQpUdnpTqdQvesJgMDisUVevXh3Xry9fvnxTv66qqprQ/cfHx/vVNj/J/couv0DAv7q6+pMDeYPNSalkwkUikX7s4ukl4FHgAODPN1CXnPsWFxd/dCAjW+GGhoZCwAfYpeczwMPAPjVW3gv3IvXN98disZ8dyBGNCwQC4/r94eHhfuy6+JS6zATUCeJXY+W9cNfIUuDAwsLCr05kIBDYeBQ8Ojr6h8Lpx25BtbWlGpfv62BG5PLy8m+SFpOTk38C76mVe84NVyhgOvLgysrK7xoXjUb/Uqt2XG1rEDiYCbcd0MgwsWtk+J1EI03An0wmw5Zlefx+/2n1eRKIO5r+rWTTpFsZ/gWFrGMmeObuqwAAAABJRU5ErkJggg==",Rd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAYAAABHomvIAAAEvUlEQVRYhc2Y20/cVRDHP8v+uKzAWkpDCtZq8BYhJkq8PBoJxgj7I2m0ryaSyFN9IT74pI8+8WJiggRj/APApFkSTGRJ+qKGUiyxbGPEWsUSuVhYC12Wy8+HmeMeYPe3d3WSye/k/M7le+bMzJkZ+J9ToEJreGVYN+vihcytstjQocUlAw0WCSoIVCv3Ae8CXwIt+u8XHVeOG8qLqgAHqAFCQCNwGugCthBJGd7S/tM6LqTzHI5KuqzgaoAHgEvAtwrkG2AG8FzXvep5nue67lX9N6P/PR1/SefXlBtkFXKNDUA/RyX1D9uUbYzOb9D1ygbSQU7eDMxhSSsSiVz3AxiJRK57nuf19/fPad8coqONFCBJPyUOIKc1OvcbgiY9ICDT8+0DHge2gR0gBeyTtviM5HeKAGlrrfMZVwhdAVaAr4F3KNF4gkA9cBbowOc68+3LwDn1Mhdy4/OcYk54nPr6+m54nofruvPa9SFQ6wfQTweNgTwInAGuQWk6mEUvHwb+Au4Dexx7ffK9+0q+CHWIBIOZ9skHYKWfK9tQ8gZoLDjIyWCg3ORY+2T8aYOyg4EaRIFrkCs4QU1NTSvabC20zyIDzuyfkYzEahHX8jHwE/LwXwHeJ4P7KIVIu5ouxFDC+HgLAy4MfEF2v1UpgOezATSiNVf6EvAWsD01NXVtdnb2bk9Pz81sp/q3KIi8t83Ae4DX0tJy0z7t8PDwD4FAYIX/WILVwKMAzc3Nu/agoaGhzmg0ugcsV0hIvlSNoH8IuIiebHJycrls4sotwaxGYvueAPAjEg3jum79yMjIr5WUjFLOxMpBIopWoBN4GfhOJ+4NDg4ulVt6i4uLm7r+BvAscA4fCXrAAfJQJ5Fg8gPgMuCMjo62d3V1LW1sbKRKlpXSxMTEmjZ/5qQrOwHwUAGmkIjiHhJdfKrM/Pz8Y+3t7RvT09Ob5QAYi8X2tbmke2cEZwAaCdoAt5QvIzEbiUSitbe3tyoej++UCnBhYSGkzdu6d1aQxkgOkfwgieQMCeCu8iwSnpNKpcIdHR3BZDJ5UCy4SCSyvL6+/giiSou67wE+eYmhAKKkIaAJUdynkdflNcQF3dFTpooxjmg0aozDAz4DXkB8bxPy1OYM7QzIOuAU0AY8pQu9CrwJ3AK8UCj0RyHgZmZmli1w3wOvAM/oHo1kiZiygbSDh7PAE8DzQA/wBqKnnuM4a2NjY7dygbtw4cICRy31deBFJA09o7eWsU7kJ1KTLJmyRyOSn5zS70fAkwBtbW2/DwwMHHR3d9d3dnY2rK6u7o2Pj2/GYrH9eDzurK2tndM1vwI+QXT7T2BTD5skQz6SCyAcLRoZkGEFGQbeRqpbubK+BPA5MI14h00L3I6Cy2h4+eQbJsKuRa6iQcGFFfB5oBt4DpFsI+Ky7iDBxW3gBhBH/GtC+R7i1lKk3UxRAG2QpvxWr0AbtB3SA5jkx36djH/dVlDbyibN3M8GDvJPyI2PSulixm/u6kZ1OQCaJ/S+tndJX6tvsFBIxcCUdA3vW5ubxMrObc0hDMhd/Rqp5QQHxeW8dubnHGM7tzVv/IECMlxQ/bpcRfRMqaNRheNcUGG9XFWDACfzWs/6Fl3t/xtO//8gpbCORQAAAABJRU5ErkJggg==",Ld="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAER0lEQVRYhe2YT2hjRRjAf8lL22xsNsm6EWKrSKvuIkIh+O9QRFxEW18KUsoe7FHoRaWCN1FPetOrIHgVKS0q9P5OxaJbodkalgVrtVZjS7Ntd02z6abPw3yzmaT585q+elj2g2HmvZn35jffN/PNNwP35R6XgM/fuif4n+dO2klQvgsaZRc4NJJvoJbHdhrIAkJAN2ADHwFfAw9J3ZoB/b9I0AA6A0SBc0Aa2EVpSqddeZ+QdmfkO+u0gIPSQQR4HfhRQH4AHMDNZDJXXNd1M5nMFalzdB3wJTAOPAD0yEB9066G6wXepVZTd5MpTdporZ6jVqsatmMJoTR3HvgJQ1u2bS+3ArRte9l1XXdsbGyJo1pdBN6Wf3d3ChlAmSQO9LeC8fquQRpDWaerHWSjSr1iu4BkJyOsF9u2s67rkslkluTVxygltAVsJBZqdCngEj5osIlW+4EYytRNF04jeu3vulCT+7QkLH20dEOhumft97pQI4s3+iiRSPwtxVSbd39J8eEGvzFXc1NAs8KSFAZeBt4AHgNeBFDWObkEAne7HAK2gT2gCFQatdca1GbtBj4E3veFprVYVLXXcg4GqM6588BbAMlkcm1qamqzr6/v6ikBet5RgiizJoDPAXdgYGDZXHkzMzPrrk9CdRWngUeAsxxdCzVwpgZ/BigWiz1mo4mJif7jqMajeJrU5hywgGvAej6fvzA0NLThN1Eul9uT4g5VTbYFNKUIfAbsZ7PZvuHh4Wt+As7Ozu5IcY2j219TQB0NV4A7qODgO4CFhYWLg4ODOb8AHccpG4A68m6pRQ1YAQ6A28A+8BXwBcDq6upTqVTquh+AuVyuW4q/opRRaQdZD1gCbgE3ge+BT4HdfD7/ZDwe/z2bzRY6hRsfH1/e3Nx8FDX/sgbgoZfvg6jo4ixqW7oIPA+8CrwHrAJuJBLJd+JaHMf5k6qmPgGeQe1SCenXk0/U21xcIC8AzwGvAJPAEuAmEon1xcXFba9w8/Pz5oqdB14CnpY+oij35km0qwmjwqAU8ISM9hIwBeQA17KsG9PT07+1gxsZGdmgdqW+BjwLDAAPoo4ALU+W9arVwWoIpXp9kouKZpPAO8AwQCwW+2d0dLQ0OTkZSafT0UKhUJ6bm9t2HKeysrIS3tra0g7+KvABUJC0g5rrJdRcbLpImtleRzYashc1P2OSXwbebDVykX3gW+Ab1AHqhuQ3pe6AJlFMO0CoPROHDcio5I8DL1A9C8dQbmod+APYAK4DvwjQnsDdErgyVTfTEaCG1GFYGHXG7TVSo2OkdvhlAflXoHSuNdfStFqaRhEi2kfdprrj6M5LAt0I8EDaaMdflPal48CB95hMr3Bt8h4jD0kyL5E0pN6dysZzW7N2AqjbmhdIZjJvufTOpE19x3g+9s1XJ/ck5tVbfdhu+rxDfLiSO+lFToCjZwrXyH2/0Lwv95z8B1jAqXmDnj4YAAAAAElFTkSuQmCC",kd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAIiklEQVRYhe2YW2yUxxmGn7W96zXGNnZsr2FJHQyYBHNIU1ttAqVUVjlJUAtxQyUXhKgQktUDdSUkuEDtBVJ9UQXRC0RJRblrq/SCIARpFImWQ8VBIZQinJpQYozNyWaxiw/rfXsx3+z+6xNOe9tPGv2nOTzzffPPvDMhSXwJC1nKAXIDV/9ellLAqF1T9o5A2Ry7J5A/Fbh3mUMh8qYJ5kHCQATID6QIkBcAHAVGgKFAStq33EB53/ao5Rm064i9g0CmqcDyrNICYCZQBJTYdaa9j1jelDUwCAwAz4F+ex61DhZauXzr1CDwDHhq1wFg2Do1KWAo0NsCAyoDKoGYXcuBWdZY1PKnzAsDQB/wBOg1yKTVN8vqmoHz6nOgC7gHdFrbCasrNRFgyMCj5qVXgDlANfAaMA/4ir2rMI+MtSHgEdAN9BjsiNVZYR0sNq8+AtqB69Z2MuDBcYA+pAXW0yoDWgTUWXrd8k1l+cBcSxjIIBlPB63G8uUB/8Z57znwAkgGAX1YC4BSK7QIWA7UWwoDJJNJzp49y4ULF2hvb6e7u5tEIkFhYSGVlZXMmzePhoYGNmzYQElJCVZv2tPt7e3s2bOHvr4+9u3bx/r16+PWjg/zQ9x4BEk+5UkqklQt6ZuSdkn6jaRbMhsYGFBbW5uWLVvmp5MpU3V1tVpbW9XV1aWgbdy4MZ2npqbGvx6W9DtJ35e0RFJREDBX0gxJcUnfkPQDScck3fGlz549q7q6ummBjU2xWEzvvfdeGvCtt95Kf6uoqAiyfyBpt6SvSZrlAUOSIpLKJS2X9D1Jv5Z025d69913FQqFJmy8rKxMS5YsUUNDg5YvX67Zs2dPCrpjxw6NjIxoxYoV6XdVVVVBwI8l/UTS1yWVesBcC+18SRsk/ULS33yJtra2CRtramrSiRMn1NXVpWQyKUlKpVJ6+vSpTp48qZ07dyo/P39cua1bt6q+vn4ywL9IapX0tqQyDxiRFDPq3ZL+JCklSadOnRrXwMKFC3X69GlNx65du6aVK1eOqyMYjTGAf50IsNC8t1FSm6TPJOn+/fuKxWJZFb/zzjvjBvx0bO/evQqHwxNG4mUe9MtYMZk5bwHA4cOH6enpSc9BixYt4uTJk5SVlflXfcBN4DFuapoHLPQfz58/z9WrVwmFQsTjceLxOHfv3uUlNlZcpFeMEtzsXg2QSCQ4duxYulQoFOLQoUNBuE7gvAE+x82b/VZHyblz52hsbCSZTL4MCGWrqUECq0gQsBi3ts4B+PDDD3n48GG61OrVq1mzZo1/fGZw54HbVmGV1bMAWPbRRx9NC24CwD7cajLiAXNwIS7ELW3lAGfOnMmqZPv27cHHvwM3gH8AnwH/wnn0C+AuwLZt25g/f/5L4cLhMNu2bfOPnbh1+xkZ9UMebvmKGmQEoLOzM11JQUEBK1eu9I/JAFAPTqnk4hTNY9xS1V5TU1N7+fJlOjo6SKXS+jPLJFFUVMTixYsxmJtW/inOi2nAXDI/C0BWeMvKyojFYv6xz1LCKhnCRSEBPMCFfBaQKi0tfb2+vn5qFzp7AnwCXAM+t45mAUJGfgMwOpoWtIRCWZ/89BB8TuJ+lG5cNEatkXYgjtN+BYG2ktaxBE4U3AP+iRsud3EeHCTwk6Ss0IhvtaKiIk3Q19dHb28vhYWF4H6mYtxwiBrQIE4aPTHgIVzoO3E/TzlOV4YD3/stj9eMPj2xzg4HAYMSPQnkxePxNGB/fz+XLl1iy5Yt4HTeq+aZTtyA9h18Yb33G6aRQBqyDiUNLihmH1q54LAZ9ZHKISPRn1loaGxsJGjHjx8PPi6xtAgnNufgVHcRmf1J2DpTiJsjvYout3c5gQ49Ns89s3fpOdB70I+Hx7iBXrV27VqKi4tJJBKAm3auXLmCDfpy4G3rZSHur/aSPg83BCpx24MFuNUlbnkHcGMubEDdxpG0lBn8AcBBsgfsVysqKti6dStHjhwBYGRkhJaWFs6dO0ckEgGYj9v0xIA71rkha7jUgBYCb5hHGRoaIj8/f4Z5s8jafUpmN/diLBwAkmZKWiipSdKvJN2VpI6ODhUVFWUt7Js2bdLAwMBYLdAt6VNJlyV9IumLsRkOHjyo2tparVixQrdvp2Xmn00YrJI0R05VBRV+GjAiqcoUxA8lnfI1HD16dJz6WLVqla5fvz4tFdPZ2anm5uas8s3Nzf7zp5J+LmmNpFcl5U8GmCupWFKtpO9K+qWkG76W3bt3j4OMRqNqaWnRhQsXNDQ0lAWVTCZ169YtHThwQFVVVePKtrS0+Kw3pgsYso+Vkuol7ZD0W0ldvsHW1tZJZXxtba0aGxvV1NSkdevWaenSpYpGoxPmXb9+vXp6ejzgx5J+ZiGeLSk8GaD34ky5Hd23JP1I0h8kPQmGu7y8/L/aNEUiEe3fv1/Dw8Pp6Es6KqlZ0puSXpHbVU4KiPVglqQFkr4j6aeSfi/pvq/13r172rVrlyorK6cFFo1GtXnzZl25ciU4Ch5J+qOkH0v6tqTXzDk5EwGGlNFjOWQOd8px4vUN4E3cpn2pz/jgwQPef/99Ll68yJ07d+jt7WVwcJBIJEJJSQlz586loaGBTZs2UVdXF5w0OoDLwFWcbPsct6r04+bRLHEYCoWyAD1kBDfHleHmsxrccccS3NFHNV/eenBy6iZwCycMOnHz5wBuDh2nyyY6H0zhFmoF7vtxk+l9q3ieQfrDo8msF7cy3cN56g7ZWnKcep7IxnrQmz+wHKu2K3EKJWbPpWSUTQ4ZtRJc23sC6ZGB9ZM52JwcboIQjzUvZvNxYfeHlyVkZFcBbux6wKA6ShjoM5yM8uH0Xpuy8ekAQuZc2W8P8nEei9p9mMmPgAfJHO0O27e0lHppw9MEDJo//A4eoE91iB48SJ80lFMB/t/+V/sPGZfTmtMFR4EAAAAASUVORK5CYII=";var wi=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},xe=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},Ue,bi,lo,xn,ai,$t,Bl,Fl,Ct,ds,us;class jd{constructor(t,n){Ue.add(this),bi.set(this,void 0),lo.set(this,void 0),xn.set(this,null),ai.set(this,null),$t.set(this,{auto:Od,"drag-default":Rd,"drag-active":Ld,"rotate-0":Wl,rotate:kd}),wi(this,lo,t,"f"),wi(this,bi,n.eventHub,"f"),xe(this,Ue,"m",Bl).call(this),xe(this,Ue,"m",Fl).call(this)}}bi=new WeakMap,lo=new WeakMap,xn=new WeakMap,ai=new WeakMap,$t=new WeakMap,Ue=new WeakSet,Bl=function(){const t=xe(this,bi,"f");xe(this,Ue,"m",Ct).call(this,"default"),t.on("cursor",n=>{var o;n.type==="over-element"||!n.type?xe(this,Ue,"m",Ct).call(this,"auto"):n.type==="resize-rotate"?xe(this,Ue,"m",Ct).call(this,"rotate"):typeof n.type=="string"&&(!((o=n.type)===null||o===void 0)&&o.startsWith("resize-"))?xe(this,Ue,"m",ds).call(this,n):n.type==="drag-default"?xe(this,Ue,"m",Ct).call(this,"drag-default"):n.type==="drag-active"?xe(this,Ue,"m",Ct).call(this,"drag-active"):xe(this,Ue,"m",Ct).call(this,"auto")})},Fl=function(){zi(Wl).then(t=>{wi(this,ai,t,"f")}).catch(t=>{console.error(t)})},Ct=function(t){if(xe(this,xn,"f")===t)return;wi(this,xn,t,"f");const n=xe(this,$t,"f")[xe(this,xn,"f")]||xe(this,$t,"f").auto;let o=0,i=0;(t.startsWith("rotate-")&&xe(this,$t,"f")[xe(this,xn,"f")]||t==="rotate")&&(o=10,i=10),t==="default"?xe(this,lo,"f").style.cursor="default":xe(this,lo,"f").style.cursor=`image-set(url(${n})2x) ${o} ${i}, auto`},ds=function(t){var n;let o=0;t.type==="resize-top"?o+=0:t.type==="resize-top-right"?o+=45:t.type==="resize-right"?o+=90:t.type==="resize-bottom-right"?o+=135:t.type==="resize-bottom"?o+=180:t.type==="resize-bottom-left"?o+=225:t.type==="resize-left"?o+=270:t.type==="resize-top-left"&&(o+=315),o+=lt(((n=t==null?void 0:t.element)===null||n===void 0?void 0:n.angle)||0),Array.isArray(t.groupQueue)&&t.groupQueue.length>0&&t.groupQueue.forEach(a=>{o+=lt(a.angle||0)}),o=lt(o);const i=xe(this,Ue,"m",us).call(this,o);xe(this,Ue,"m",Ct).call(this,i)},us=function(t){const n=`rotate-${t}`;if(!xe(this,$t,"f")[n]){const o=xe(this,ai,"f");if(o){const i=document.createElement("canvas"),a=o.width,s=o.height,r={x:a/2,y:s/2};i.width=a,i.height=s;const c=i.getContext("2d"),d=St(t);c.translate(r.x,r.y),c.rotate(d),c.translate(-r.x,-r.y),c.drawImage(o,0,0,a,s),c.translate(r.x,r.y),c.rotate(-d),c.translate(-r.x,-r.y);const u=i.toDataURL("image/png");xe(this,$t,"f")[n]=u}}return n};const Aa="change",Fe="SELECT",be=Symbol(`${Fe}_actionType`),jt=Symbol(`${Fe}_resizeType`),So=Symbol(`${Fe}_areaStart`),Eo=Symbol(`${Fe}_areaEnd`),gt=Symbol(`${Fe}_hoverElement`),_n=Symbol(`${Fe}_hoverElementVertexes`),Dt=Symbol(`${Fe}_selectedElementList`),_d=Symbol(`${Fe}_selectedElementListVertexes`),sn=Symbol(`${Fe}_selectedElementController`),ln=Symbol(`${Fe}_selectedElementPosition`),Ge=Symbol(`${Fe}_groupQueue`),Gi=Symbol(`${Fe}_groupQueueVertexesList`),Mo=Symbol(`${Fe}_isMoving`),Yi=Symbol(`${Fe}_enableSelectInGroup`),xo=Symbol(`${Fe}_enableSnapToGrid`),Hl=2,Vd=4,Gl=1,vo="#1973ba",hs="#5b5959b5",Yl=10,Wd="#f7276e",si="@middleware/select",Si="@middleware/select-clear",ua="@middleware/select-in-group",ha="@middleware/snap-to-grid";function Pt(e,t,n){const{borderColor:o,borderWidth:i,background:a,lineDash:s}=n;e.setLineDash([]),e.lineWidth=i,e.strokeStyle=o,e.fillStyle=a,e.setLineDash(s),e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y),e.lineTo(t[2].x,t[2].y),e.lineTo(t[3].x,t[3].y),e.lineTo(t[0].x,t[0].y),e.closePath(),e.stroke(),e.fill()}function fa(e,t,n,o){const{borderColor:i,borderWidth:a,lineDash:s}=o;e.setLineDash([]),e.lineWidth=a,e.strokeStyle=i,e.setLineDash(s),e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.closePath(),e.stroke()}function Bd(e,t,n){const{size:o,borderColor:i,borderWidth:a,background:s}=n,r=t,c=o/2,d=c,u=c;if(d>=0&&u>=0){if(typeof a=="number"&&a>0){const h=a/2+d,f=a/2+u;e.beginPath(),e.strokeStyle=i,e.lineWidth=a,e.circle(r.x,r.y,h,f,0,0,2*Math.PI),e.closePath(),e.stroke()}e.beginPath(),e.fillStyle=s,e.circle(r.x,r.y,d,u,0,0,2*Math.PI),e.closePath(),e.fill()}}function vt(e,t,n){const{borderColor:o,borderWidth:i,lineDash:a}=n;e.setLineDash([]),e.lineWidth=i,e.strokeStyle=o,e.setLineDash(a),e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[2].x,t[2].y),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(t[1].x,t[1].y),e.lineTo(t[3].x,t[3].y),e.closePath(),e.stroke()}function fs(e,t,n){const{size:o,borderColor:i,borderWidth:a,lineDash:s}=n,r=t.x-o/2,c=t.x+o/2,d=t.y-o/2,u=t.y+o/2;vt(e,[{x:r,y:d},{x:c,y:d},{x:c,y:u},{x:r,y:u}],{borderColor:i,borderWidth:a,lineDash:s})}function ms(e,t,n){if(!t)return;const o={borderColor:vo,borderWidth:1,background:"transparent",lineDash:[]};Pt(e,je(t,n),o)}function gs(e,t,n){if(!t)return;const o={borderColor:hs,borderWidth:1,background:"transparent",lineDash:[]};Pt(e,je(t,n),o);const{controller:i}=n;if(i){const{topLeft:a,topRight:s,bottomLeft:r,bottomRight:c,topMiddle:d,bottomMiddle:u,leftMiddle:h,rightMiddle:f}=i,m=Object.assign(Object.assign({},o),{borderWidth:1,background:hs});vt(e,je(d.vertexes,n),m),vt(e,je(u.vertexes,n),m),vt(e,je(h.vertexes,n),m),vt(e,je(f.vertexes,n),m),vt(e,je(a.vertexes,n),m),vt(e,je(s.vertexes,n),m),vt(e,je(r.vertexes,n),m),vt(e,je(c.vertexes,n),m)}}function vs(e,t,n){if(!t)return;const{hideControllers:o}=n,{elementWrapper:i,topLeft:a,topRight:s,bottomLeft:r,bottomRight:c,top:d,rotate:u}=t,h={borderColor:vo,borderWidth:Hl,background:"transparent",lineDash:[]},f=Object.assign(Object.assign({},h),{borderWidth:Vd,background:"#FFFFFF"});Pt(e,je(i,n),h),o||(fa(e,me(d.center,n),me(u.center,n),Object.assign(Object.assign({},f),{borderWidth:2})),Pt(e,je(a.vertexes,n),f),Pt(e,je(s.vertexes,n),f),Pt(e,je(r.vertexes,n),f),Pt(e,je(c.vertexes,n),f),Bd(e,me(u.center,n),Object.assign(Object.assign({},f),{size:Yl,borderWidth:2})))}function Fd(e,t){const{start:n,end:o}=t;e.setLineDash([]),e.lineWidth=Gl,e.strokeStyle=vo,e.fillStyle="#1976d24f",e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,n.y),e.lineTo(o.x,o.y),e.lineTo(n.x,o.y),e.closePath(),e.stroke(),e.fill()}function Hd(e,t){const{areaSize:n}=t,{x:o,y:i,w:a,h:s}=n;e.setLineDash([]),e.lineWidth=Gl,e.strokeStyle=vo,e.fillStyle="#1976d21c",e.beginPath(),e.moveTo(o,i),e.lineTo(o+a,i),e.lineTo(o+a,i+s),e.lineTo(o,i+s),e.closePath(),e.stroke(),e.fill()}function Gd(e,t,n){for(let o=0;o<t.length;o++){const i=t[o],a={borderColor:vo,borderWidth:Hl,background:"transparent",lineDash:[4,4]};Pt(e,je(i,n),a)}}function ps(e,t){const{xLines:n,yLines:o}=t,i={borderColor:Wd,borderWidth:1,lineDash:[]},a=Object.assign(Object.assign({},i),{size:6});n&&n.forEach(s=>{s.forEach((r,c)=>{fs(e,r,a),s[c+1]&&fa(e,s[c],s[c+1],i)})}),o&&o.forEach(s=>{s.forEach((r,c)=>{fs(e,r,a),s[c+1]&&fa(e,s[c],s[c+1],i)})})}function de(e){return e*Math.PI/180}function Co(e,t){return Math.sqrt(e*e+t*t)}function oe(e,t){return t>0?Math.abs(e):0-Math.abs(e)}function ma(e,t){const{ctx:n,viewScaleInfo:o,vertexes:i}=t,a=me(i[0],{viewScaleInfo:o}),s=me(i[1],{viewScaleInfo:o}),r=me(i[2],{viewScaleInfo:o}),c=me(i[3],{viewScaleInfo:o});return n.beginPath(),n.moveTo(a.x,a.y),n.lineTo(s.x,s.y),n.lineTo(r.x,r.y),n.lineTo(c.x,c.y),n.lineTo(a.x,a.y),n.closePath(),!!n.isPointInPath(e.x,e.y)}function ys(e,t){const{ctx:n,viewScaleInfo:o,viewSizeInfo:i,groupQueue:a}=t;if(!a||!((a==null?void 0:a.length)>0))return!1;const s=za(a),r=s[s.length-1];return r?ma(e,{ctx:n,vertexes:r,viewScaleInfo:o,viewSizeInfo:i}):!1}function Vn(e,t){var n,o,i;const a={type:null,elements:[],elementVertexesList:[],groupQueue:[],groupQueueVertexesList:[]},{ctx:s,data:r,calculator:c,selectedElements:d,viewScaleInfo:u,viewSizeInfo:h,areaSize:f,groupQueue:m,selectedElementController:v}=t;if(v){const{left:g,right:p,top:S,bottom:E,topLeft:w,topRight:y,bottomLeft:x,bottomRight:b,rotate:C}=v,z=[g,p,S,E,w,y,x,b,C];for(let L=0;L<z.length;L++){const N=z[L];if(ma(e,{ctx:s,vertexes:N.vertexes,viewSizeInfo:h,viewScaleInfo:u})){a.type=`resize-${N.type}`,d&&(d==null?void 0:d.length)>0&&(a.groupQueue=m||[],a.elements=[d[0]]);break}}}if(m&&Array.isArray(m)&&m.length>0){const g=m[m.length-1];if(!((n=g==null?void 0:g.detail)===null||n===void 0)&&n.children&&Array.isArray((o=g==null?void 0:g.detail)===null||o===void 0?void 0:o.children))for(let p=g.detail.children.length-1;p>=0;p--){const S=g.detail.children[p],E=ro(S,{groupQueue:m});if(E&&ma(e,{ctx:s,vertexes:E,viewScaleInfo:u,viewSizeInfo:h}))return a.type||(a.type="over-element"),a.groupQueue=m,a.elements=[S],a}return a}if(a.type!==null)return a;if(f&&Array.isArray(d)&&(d==null?void 0:d.length)>1){const{x:g,y:p,w:S,h:E}=f;if(e.x>=g&&e.x<=g+S&&e.y>=p&&e.y<=p+E)return a.type="list-area",a.elements=d,a}if(r){const{index:g,element:p}=c.getPointElement(e,{data:r,viewScaleInfo:u,viewSizeInfo:h});if(g>=0&&p&&((i=p==null?void 0:p.operations)===null||i===void 0?void 0:i.invisible)!==!0)return a.elements=[p],a.type="over-element",a}return a}function Yd(e,t){var n,o,i,a,s,r,c,d,u;let{x:h,y:f,w:m,h:v,angle:g=0}=e;const p=ot({x:h,y:f,w:m,h:v,angle:g});g=lt(g);const S=St(g),E=!!(!((n=e==null?void 0:e.operations)===null||n===void 0)&&n.limitRatio),{start:w,end:y,resizeType:x,scale:b}=t;let C=Object.assign({},w),z=Object.assign({},y),L={x:C.x,y:p.y},N={x:z.x,y:p.y},R=Object.assign({},L),k=Object.assign({},N),_={x:p.x,y:C.y},$={x:p.x,y:z.y},U=Object.assign({},_),V=Object.assign({},$),P=(k.x-R.x)/b,W=(k.y-R.y)/b,A=Co(P,W),Y=(V.x-U.x)/b,G=(V.y-U.y)/b,I=Co(Y,G);(g>0||g<0)&&(C=Me(p,w,0-S),z=Me(p,y,0-S),L={x:C.x,y:p.y},N={x:z.x,y:p.y},R=Me(p,L,S),k=Me(p,N,S),_={x:p.x,y:C.y},$={x:p.x,y:z.y},U=Me(p,_,S),V=Me(p,$,S),P=(k.x-R.x)/b,W=(k.y-R.y)/b,A=Co(P,W),A=oe(A,W),Y=(V.x-U.x)/b,G=(V.y-U.y)/b,I=Co(Y,G),I=oe(I,G));let H=(y.x-w.x)/b,Z=(y.y-w.y)/b;if(E===!0){if(["resize-top","resize-bottom","resize-left","resize-right"].includes(x)){const M=Math.max(Math.abs(H),Math.abs(Z));H=(H>=0?1:-1)*M,Z=(Z>=0?1:-1)*M/e.w*e.h;const O=Math.max(Math.abs(Y),Math.abs(G));Y=(Y>=0?1:-1)*O,G=(G>=0?1:-1)*O/e.w*e.h;const D=Math.max(Math.abs(P),Math.abs(W));P=(P>=0?1:-1)*D,W=(W>=0?1:-1)*D/e.w*e.h}else if(["resize-top-left","resize-top-right","resize-bottom-left","resize-bottom-right"].includes(x)){{const M=Math.abs(H);H=(H>=0?1:-1)*M;const O=M/e.w*e.h;x==="resize-top-left"||x==="resize-bottom-right"?Z=H>0?O:-O:(x==="resize-top-right"||x==="resize-bottom-left")&&(Z=H>0?-O:O)}A=Math.abs(A),I=A/e.w*e.h}}switch(x){case"resize-top":{if(g===0)v-Z>0&&(f+=Z,v-=Z,((o=e.operations)===null||o===void 0?void 0:o.limitRatio)===!0&&(h+=Z/e.h*e.w/2,m-=Z/e.h*e.w));else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){I=0-oe(I,G);const D=de(g),F=I/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D)}else if(g<180){I=oe(I,Y);const D=de(g-90),F=I/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D)}else if(g<270){I=oe(I,G);const D=de(g-180),F=I/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D)}else if(g<360){I=0-oe(I,Y);const D=de(g-270),F=I/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D)}v+I>0&&(((i=e.operations)===null||i===void 0?void 0:i.limitRatio)===!0&&(m=m+I/e.h*e.w),v=v+I,h=M-m/2,f=O-v/2)}break}case"resize-bottom":{if(g===0)e.h+Z>0&&(v+=Z,((a=e.operations)===null||a===void 0?void 0:a.limitRatio)===!0&&(h-=Z/e.h*e.w/2,m+=Z/e.h*e.w));else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){I=oe(I,G);const D=de(g),F=I/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D)}else if(g<180){I=0-oe(I,Y);const D=de(g-90),F=I/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D)}else if(g<270){I=oe(I,Y);const D=de(g-180),F=I/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D)}else if(g<360){I=oe(I,Y);const D=de(g-270),F=I/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D)}v+I>0&&(((s=e.operations)===null||s===void 0?void 0:s.limitRatio)===!0&&(m=m+I/e.h*e.w),v=v+I,h=M-m/2,f=O-v/2)}break}case"resize-left":{if(g===0)e.w-H>0&&(h+=H,m-=H,((r=e.operations)===null||r===void 0?void 0:r.limitRatio)===!0&&(v-=H/e.w*e.h,f+=H/e.w*e.h/2));else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){A=0-oe(A,P);const D=de(g),F=A/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D)}else if(g<180){A=oe(A,P);const D=de(g-90),F=A/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D)}else if(g<270){A=oe(A,W);const D=de(g-180),F=A/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D)}else if(g<360){A=oe(A,W);const D=de(g-270),F=A/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D)}m+A>0&&(((c=e.operations)===null||c===void 0?void 0:c.limitRatio)===!0&&(v=v+A/e.w*e.h),m=m+A,h=M-m/2,f=O-v/2)}break}case"resize-right":{if(g===0)e.w+H>0&&(m+=H,((d=e.operations)===null||d===void 0?void 0:d.limitRatio)===!0&&(f-=H*e.h/e.w/2,v+=H*e.h/e.w));else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){A=oe(A,W);const D=de(g),F=A/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D)}else if(g<180){A=oe(A,Z);const D=de(g-90),F=A/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D)}else if(g<270){A=oe(A,Z);const D=de(g-180),F=A/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D),A=0-A}else if(g<360){A=oe(A,H);const D=de(g-270),F=A/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D)}m+A>0&&(((u=e.operations)===null||u===void 0?void 0:u.limitRatio)===!0&&(v=v+A/e.w*e.h),m=m+A,h=M-m/2,f=O-v/2)}break}case"resize-top-left":{if(g===0)m-H>0&&(h+=H,m-=H),v-Z>0&&(f+=Z,v-=Z);else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){I=0-oe(I,G),A=0-oe(A,E?0-I:P);const D=I/2;M=M+D*Math.sin(S),O=O-D*Math.cos(S);const F=A/2;M=M-F*Math.cos(S),O=O-F*Math.sin(S)}else if(g<180){I=oe(I,Y),A=oe(A,E?I:P);const D=de(g-90),F=I/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D);const j=A/2;M=M+j*Math.sin(D),O=O-j*Math.cos(D)}else if(g<270){I=oe(I,G),A=oe(A,E?I:W);const D=de(g-180),F=I/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D);const j=A/2;M=M+j*Math.cos(D),O=O+j*Math.sin(D)}else if(g<360){I=0-oe(I,Y),A=oe(A,E?I:W);const D=de(g-270),F=I/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D);const j=A/2;M=M-j*Math.sin(D),O=O+j*Math.cos(D)}v+I>0&&(v=v+I),m+A>0&&(m=m+A),h=M-m/2,f=O-v/2}break}case"resize-top-right":{if(g===0)m+H>0&&(m+=H),v-Z>0&&(f+=Z,v-=Z);else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){I=0-oe(I,G),A=oe(A,E?I:W);const D=de(g),F=I/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D);const j=A/2;M=M+j*Math.cos(D),O=O+j*Math.sin(D)}else if(g<180){I=oe(I,Y),A=oe(A,E?I:W);const D=de(g-90),F=I/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D);const j=A/2;M=M-j*Math.sin(D),O=O+j*Math.cos(D)}else if(g<270){const D=de(g-180);I=oe(I,G),A=oe(A,E?I:0-P);const F=I/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D);const j=A/2;M=M-j*Math.cos(D),O=O-j*Math.sin(D)}else if(g<360){I=0-oe(I,Y),A=oe(A,E?I:P);const D=de(g-270),F=I/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D);const j=A/2;M=M+j*Math.sin(D),O=O-j*Math.cos(D)}v+I>0&&(v=v+I),m+A>0&&(m=m+A),h=M-m/2,f=O-v/2}break}case"resize-bottom-left":{if(g===0)e.h+Z>0&&(v+=Z),e.w-H>0&&(h+=H,m-=H);else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){I=oe(I,G),A=0-oe(A,E?0-I:P);const D=de(g),F=I/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D);const j=A/2;M=M-j*Math.cos(D),O=O-j*Math.sin(D)}else if(g<180){I=0-oe(I,Y),A=oe(A,E?I:P);const D=de(g-90),F=I/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D);const j=A/2;M=M+j*Math.sin(D),O=O-j*Math.cos(D)}else if(g<270){I=oe(I,Y),A=oe(A,E?I:W);const D=de(g-180),F=I/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D);const j=A/2;M=M+j*Math.cos(D),O=O+j*Math.sin(D)}else if(g<360){I=oe(I,Y),A=oe(A,E?I:W);const D=de(g-270),F=I/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D);const j=A/2;M=M-j*Math.sin(D),O=O+j*Math.cos(D)}v+I>0&&(v=v+I),m+A>0&&(m=m+A),h=M-m/2,f=O-v/2}break}case"resize-bottom-right":{if(g===0)e.h+Z>0&&(v+=Z),e.w+H>0&&(m+=H);else if(g>0||g<0){let M=p.x,O=p.y;if(g<90){I=oe(I,G),A=oe(A,E?I:W);const D=de(g),F=I/2;M=M-F*Math.sin(D),O=O+F*Math.cos(D);const j=A/2;M=M+j*Math.cos(D),O=O+j*Math.sin(D)}else if(g<180){I=0-oe(I,Y),A=oe(A,E?I:Z);const D=de(g-90),F=I/2;M=M-F*Math.cos(D),O=O-F*Math.sin(D);const j=A/2;M=M-j*Math.sin(D),O=O+j*Math.cos(D)}else if(g<270){I=oe(I,Y),A=oe(A,E?I:0-W);const D=de(g-180),F=I/2;M=M+F*Math.sin(D),O=O-F*Math.cos(D);const j=A/2;M=M-j*Math.cos(D),O=O-j*Math.sin(D)}else if(g<360){I=oe(I,Y),A=oe(A,E?I:P);const D=de(g-270),F=I/2;M=M+F*Math.cos(D),O=O+F*Math.sin(D);const j=A/2;M=M+j*Math.sin(D),O=O-j*Math.cos(D)}v+I>0&&(v=v+I),m+A>0&&(m=m+A),h=M-m/2,f=O-v/2}break}}return{x:h,y:f,w:m,h:v,angle:e.angle}}function $d(e,t){const{x:n,y:o,w:i,h:a,angle:s=0}=e,{center:r,start:c,end:d,viewScaleInfo:u}=t,h=me(r,{viewScaleInfo:u}),f=lt(s),m=jc(h,c,d),v=f+kc(m);return{x:n,y:o,w:i,h:a,angle:v}}function Xd(e,t){var n;const o=[],i=[],a=[],{viewScaleInfo:s,viewSizeInfo:r,start:c,end:d}=t;if(!(Array.isArray(e.elements)&&c&&d))return{indexes:o,uuids:i,elements:a};const u=Math.min(c.x,d.x),h=Math.max(c.x,d.x),f=Math.min(c.y,d.y),m=Math.max(c.y,d.y);for(let v=0;v<e.elements.length;v++){const g=e.elements[v];if(((n=g==null?void 0:g.operations)===null||n===void 0?void 0:n.lock)===!0)continue;const p=We(g,{viewScaleInfo:s,viewSizeInfo:r}),S=ot(p);if(S.x>=u&&S.x<=h&&S.y>=f&&S.y<=m&&(o.push(v),i.push(g.uuid),a.push(g),p.angle&&(p.angle>0||p.angle<0))){const E=On(p);if(E.length===4){const w=[E[0].x,E[1].x,E[2].x,E[3].x],y=[E[0].y,E[1].y,E[2].y,E[3].y];p.x=Math.min(...w),p.y=Math.min(...y),p.w=Math.abs(Math.max(...w)-Math.min(...w)),p.h=Math.abs(Math.max(...y)-Math.min(...y))}}}return{indexes:o,uuids:i,elements:a}}function $i(e,t){var n;if(!Array.isArray(e))return null;const o={x:0,y:0,w:0,h:0},{viewScaleInfo:i,viewSizeInfo:a}=t;let s=null;for(let r=0;r<e.length;r++){const c=e[r];if(!((n=c==null?void 0:c.operations)===null||n===void 0)&&n.invisible)continue;const d=We(c,{viewScaleInfo:i,viewSizeInfo:a});if(d.angle&&(d.angle>0||d.angle<0)){const u=On(d);if(u.length===4){const h=[u[0].x,u[1].x,u[2].x,u[3].x],f=[u[0].y,u[1].y,u[2].y,u[3].y];d.x=Math.min(...h),d.y=Math.min(...f),d.w=Math.abs(Math.max(...h)-Math.min(...h)),d.h=Math.abs(Math.max(...f)-Math.min(...f))}}if(s){const u=Math.min(d.x,o.x),h=Math.min(d.y,o.y),f=Math.max(d.x+d.w,o.x+o.w),m=Math.max(d.y+d.h,o.y+o.h);o.x=u,o.y=h,o.w=Math.abs(f-u),o.h=Math.abs(m-h)}else o.x=d.x,o.y=d.y,o.w=d.w,o.h=d.h;s=d}return o}function Ud(e,t){var n;if((t==null?void 0:t.type)==="group"&&Array.isArray((n=t==null?void 0:t.detail)===null||n===void 0?void 0:n.children))for(let o=0;o<t.detail.children.length;o++){const i=t.detail.children[o];if(e.uuid===i.uuid)return!0}return!1}function Zd(e,t,n){let o=t.x-e.x,i=t.y-e.y;const a=[];if(n.forEach(s=>{const{x:r,y:c,w:d,h:u,angle:h=0}=s;a.push({x:r,y:c,w:d,h:u,angle:0-h})}),(n==null?void 0:n.length)>0){const s=gi(e,a),r=gi(t,a);o=r.x-s.x,i=r.y-s.y}return{moveX:o,moveY:i}}const ws=2;function bs(e){return{minX:e.topLeft.x,minY:e.topLeft.y,maxX:e.bottomRight.x,maxY:e.bottomRight.y,midX:e.center.x,midY:e.center.y}}const rn=(e,t)=>{if(e.length===0)throw null;if(e.length===1)return e[0];let n=0,o=e.length-1;for(;n<=o;){const i=Math.floor((n+o)/2);if(e[i]===t)return e[i];e[i]<t?n=i+1:o=i-1}return n>=e.length?e[o]:o<0?e[n]:Math.abs(e[o]-t)<=Math.abs(e[n]-t)?e[o]:e[n]},Ke=(e,t)=>Math.abs(e-t)<1e-5;function Xi(e,t){var n,o;const{data:i,groupQueue:a,calculator:s,viewScaleInfo:r,viewSizeInfo:c}=t;let d=i.elements||[];(a==null?void 0:a.length)>0&&(d=((o=(n=a[a.length-1])===null||n===void 0?void 0:n.detail)===null||o===void 0?void 0:o.children)||[]);const u=[];d.forEach(V=>{if(V.uuid!==e){const P=s.calcViewRectInfoFromRange(V.uuid,{checkVisible:!0,viewScaleInfo:r,viewSizeInfo:c});P&&u.push(P)}});const h=s.calcViewRectInfoFromRange(e,{viewScaleInfo:r,viewSizeInfo:c});if(!h)return null;const f={},m={},v={},g={},p=[],S=[];let E=[],w=[];const y=bs(h);f[y.minX]=[y.minY,y.midY,y.maxY],f[y.midX]=[y.minY,y.midY,y.maxY],f[y.maxX]=[y.minY,y.midY,y.maxY],m[y.minY]=[y.minX,y.midX,y.maxX],m[y.midY]=[y.minX,y.midX,y.maxX],m[y.maxY]=[y.minX,y.midX,y.maxX],u.forEach(V=>{const P=bs(V);v[P.minX]||(v[P.minX]=[]),v[P.midX]||(v[P.midX]=[]),v[P.maxX]||(v[P.maxX]=[]),g[P.minY]||(g[P.minY]=[]),g[P.midY]||(g[P.midY]=[]),g[P.maxY]||(g[P.maxY]=[]),v[P.minX]=[P.minY,P.midY,P.maxY],v[P.midX]=[P.minY,P.midY,P.maxY],v[P.maxX]=[P.minY,P.midY,P.maxY],E.push(P.minX),E.push(P.midX),E.push(P.maxX),g[P.minY]=[P.minX,P.midX,P.maxX],g[P.midY]=[P.minX,P.midX,P.maxX],g[P.maxY]=[P.minX,P.midX,P.maxX],w.push(P.minY),w.push(P.midY),w.push(P.maxY)}),E=E.sort((V,P)=>V-P),w=w.sort((V,P)=>V-P);let x=null,b=null,C=null,z=null,L=null,N=null,R=null,k=null;if(E.length>0){C=rn(E,y.minX),z=rn(E,y.midX),L=rn(E,y.maxX);const V=Math.abs(C-y.minX),P=Math.abs(z-y.midX),W=Math.abs(L-y.maxX),A=Math.min(V,P,W);A<=ws/r.scale&&(Ke(A,V)?x=C-y.minX:Ke(A,P)?x=z-y.midX:Ke(A,W)&&(x=L-y.maxX))}if(w.length>0){N=rn(w,y.minY),R=rn(w,y.midY),k=rn(w,y.maxY);const V=Math.abs(N-y.minY),P=Math.abs(R-y.midY),W=Math.abs(k-y.maxY),A=Math.min(V,P,W);A<=ws/r.scale&&(Ke(A,V)?b=N-y.minY:Ke(A,P)?b=R-y.midY:Ke(A,W)&&(b=k-y.maxY))}const _=Object.assign({},y);if(x!==null&&(_.minX+=x,_.midX+=x,_.maxX+=x),b!==null&&(_.minY+=b,_.midY+=b,_.maxY+=b),Se.x(x)&&x!==null&&C!==null&&z!==null&&L!==null){if(Ke(x,C-y.minX)){const V={x:C,yList:[]};V.yList.push(_.minY),V.yList.push(_.maxY),V.yList.push(...(g==null?void 0:g[C])||[]),p.push(V)}if(Ke(x,z-y.minX)){const V={x:z,yList:[]};V.yList.push(_.minY),V.yList.push(_.maxY),V.yList.push(...(g==null?void 0:g[z])||[]),p.push(V)}if(Ke(x,L-y.minX)){const V={x:L,yList:[]};V.yList.push(_.minY),V.yList.push(_.maxY),V.yList.push(...(g==null?void 0:g[L])||[]),p.push(V)}}if(Se.y(b)&&b!==null&&N!==null&&R!==null&&k!==null){if(Ke(b,N-y.minY)){const V={y:N,xList:[]};V.xList.push(_.minX),V.xList.push(_.maxX),V.xList.push(...(v==null?void 0:v[N])||[]),S.push(V)}if(Ke(b,R-y.midY)){const V={y:R,xList:[]};V.xList.push(_.minX),V.xList.push(_.maxX),V.xList.push(...(v==null?void 0:v[N])||[]),S.push(V)}if(Ke(b,k-y.maxY)){const V={y:k,xList:[]};V.xList.push(_.minX),V.xList.push(_.maxX),V.xList.push(...(v==null?void 0:v[k])||[]),S.push(V)}}const $=[];(p==null?void 0:p.length)>0&&p.forEach((V,P)=>{$.push([]),V.yList.forEach(W=>{$[P].push({x:V.x,y:W})})});const U=[];return(S==null?void 0:S.length)>0&&S.forEach((V,P)=>{U.push([]),V.xList.forEach(W=>{U[P].push({x:W,y:V.y})})}),{offsetX:x,offsetY:b,yLines:$,xLines:U}}const Ei="@middleware/text-edit",ga="@middleware/text-change",Qd=tn(),Ss=e=>{const{eventHub:t,boardContent:n,viewer:o,sharer:i}=e,a=n.boardContext.canvas,s=document.createElement("div");s.setAttribute("contenteditable","true");const r=document.createElement("div"),c=e.container||document.body,d=document.createElement("div");let u=null,h=[];r.appendChild(s),r.style.position="absolute",d.appendChild(r),d.style.position="fixed",d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.display="none",c.appendChild(d);const f=w=>{S(),p(w),d.style.display="block",u!=null&&u.uuid&&(i.setActiveOverrideElemenentMap({[u.uuid]:{operations:{invisible:!0}}}),o.drawFrame())},m=()=>{if(u!=null&&u.uuid){const w=i.getActiveOverrideElemenentMap();w&&delete w[u.uuid],i.setActiveOverrideElemenentMap(w),o.drawFrame()}d.style.display="none",u=null,h=[]},v=()=>{const w=a.getBoundingClientRect(),{left:y,top:x,width:b,height:C}=w;return{left:y,top:x,width:b,height:C}},g=w=>{const{size:y,parent:x}=w,b=document.createElement("div"),{x:C,y:z,w:L,h:N}=y,R=lt(y.angle||0);return b.style.position="absolute",b.style.left=`${C}px`,b.style.top=`${z}px`,b.style.width=`${L}px`,b.style.height=`${N}px`,b.style.transform=`rotate(${R}deg)`,x.appendChild(b),b},p=w=>{const{viewScaleInfo:y,element:x,groupQueue:b}=w,{scale:C,offsetTop:z,offsetLeft:L}=y;r.children&&Array.from(r.children).forEach(W=>{W.remove()});let N=r;for(let W=0;W<b.length;W++){const A=b[W],{x:Y,y:G,w:I,h:H}=A,Z=lt(A.angle||0),M={x:Y*C,y:G*C,w:I*C,h:H*C,angle:Z};W===0&&(M.x+=L,M.y+=z),N=g({size:M,parent:N})}const R=Object.assign(Object.assign({},Qd),x.detail);let k=x.x*C+L,_=x.y*C+z,$=x.w*C,U=x.h*C;b.length>0&&(k=x.x*C,_=x.y*C,$=x.w*C,U=x.h*C);let V="center",P="center";R.textAlign==="left"?V="start":R.textAlign==="right"&&(V="end"),R.verticalAlign==="top"?P="start":R.verticalAlign==="bottom"&&(P="end"),s.style.display="inline-flex",s.style.justifyContent=V,s.style.alignItems=P,s.style.position="absolute",s.style.left=`${k-1}px`,s.style.top=`${_-1}px`,s.style.width=`${$+2}px`,s.style.height=`${U+2}px`,s.style.transform=`rotate(${lt(x.angle||0)}deg)`,s.style.boxSizing="border-box",s.style.border="1px solid #1973ba",s.style.resize="none",s.style.overflow="hidden",s.style.wordBreak="break-all",s.style.borderRadius=`${(typeof R.borderRadius=="number"?R.borderRadius:0)*C}px`,s.style.background=`${R.background||"transparent"}`,s.style.color=`${R.color||"#333333"}`,s.style.fontSize=`${R.fontSize*C}px`,s.style.lineHeight=`${(R.lineHeight||R.fontSize)*C}px`,s.style.fontFamily=xl(R.fontFamily),s.style.fontWeight=`${R.fontWeight}`,s.style.padding="0",s.style.margin="0",s.style.outline="none",s.innerText=R.text||"",N.appendChild(s)},S=()=>{const{left:w,top:y,width:x,height:b}=v();r.style.position="absolute",r.style.overflow="hidden",r.style.top=`${y}px`,r.style.left=`${w}px`,r.style.width=`${x}px`,r.style.height=`${b}px`};d.addEventListener("click",()=>{m()}),s.addEventListener("click",w=>{w.stopPropagation()}),s.addEventListener("input",()=>{u&&h&&(u.detail.text=s.innerText||"",t.trigger(ga,{element:{uuid:u.uuid,detail:{text:u.detail.text}},position:[...h||[]]}),o.drawFrame())}),s.addEventListener("blur",()=>{u&&h&&t.trigger(ga,{element:{uuid:u.uuid,detail:{text:u.detail.text}},position:[...h]}),m()}),s.addEventListener("keydown",w=>{w.stopPropagation()}),s.addEventListener("keypress",w=>{w.stopPropagation()}),s.addEventListener("keyup",w=>{w.stopPropagation()}),s.addEventListener("wheel",w=>{w.stopPropagation(),w.preventDefault()});const E=w=>{var y;w!=null&&w.position&&(w!=null&&w.element)&&((y=w==null?void 0:w.element)===null||y===void 0?void 0:y.type)==="text"&&(u=w.element,h=w.position),f(w)};return{name:"@middleware/text-editor",use(){t.on(Ei,E)},disuse(){t.off(Ei,E)}}},po="LAYOUT_SELECT",_t=Symbol(`${po}_layoutActionType`),zo=Symbol(`${po}_layoutControlType`),Io=Symbol(`${po}_layoutController`),cn=Symbol(`${po}_layoutIsHover`),pt=Symbol(`${po}_layoutIsSelected`),Na="#b331c9",$l="#5b5959b5",Wn=10;function Ao(e,t){e.setLineDash([]),e.fillStyle="#FFFFFF",e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y),e.lineTo(t[2].x,t[2].y),e.lineTo(t[3].x,t[3].y),e.closePath(),e.fill(),e.strokeStyle=Na,e.lineWidth=2,e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y),e.lineTo(t[2].x,t[2].y),e.lineTo(t[3].x,t[3].y),e.closePath(),e.stroke()}function Kn(e,t){const{vertexes:n,strokeStyle:o,lineWidth:i}=t;e.setLineDash([]),e.strokeStyle=o,e.lineWidth=i,e.beginPath(),e.moveTo(n[0].x,n[0].y),e.lineTo(n[2].x,n[2].y),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(n[1].x,n[1].y),e.lineTo(n[3].x,n[3].y),e.closePath(),e.stroke()}function No(e,t){const{start:n,end:o,centerVertexes:i,disabled:a}=t,s=a===!0?1:2,r=a===!0?$l:Na;e.setLineDash([]),e.strokeStyle=r,e.lineWidth=s,e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.closePath(),e.stroke(),a===!0&&Kn(e,{vertexes:i,lineWidth:s,strokeStyle:r})}function Jd(e,t){const{controller:n,operations:o}=t,{topLeft:i,topRight:a,bottomLeft:s,bottomRight:r,topMiddle:c,rightMiddle:d,bottomMiddle:u,leftMiddle:h}=n;No(e,{start:i.center,end:a.center,centerVertexes:c.vertexes,disabled:!!(o!=null&&o.disabledTop)}),No(e,{start:a.center,end:r.center,centerVertexes:d.vertexes,disabled:!!(o!=null&&o.disabledRight)}),No(e,{start:r.center,end:s.center,centerVertexes:u.vertexes,disabled:!!(o!=null&&o.disabledBottom)}),No(e,{start:s.center,end:i.center,centerVertexes:h.vertexes,disabled:!!(o!=null&&o.disabledLeft)});const f={lineWidth:1,strokeStyle:$l};(o==null?void 0:o.disabledTopLeft)===!0?Kn(e,Object.assign({vertexes:i.vertexes},f)):Ao(e,i.vertexes),(o==null?void 0:o.disabledTopRight)===!0?Kn(e,Object.assign({vertexes:a.vertexes},f)):Ao(e,a.vertexes),(o==null?void 0:o.disabledBottomRight)===!0?Kn(e,Object.assign({vertexes:r.vertexes},f)):Ao(e,r.vertexes),(o==null?void 0:o.disabledBottomLeft)===!0?Kn(e,Object.assign({vertexes:s.vertexes},f)):Ao(e,s.vertexes)}function Kd(e,t){const{layoutSize:n}=t,{x:o,y:i,w:a,h:s}=n;e.setLineDash([]),e.strokeStyle=Na,e.lineWidth=1,e.beginPath(),e.moveTo(o,i),e.lineTo(o+a,i),e.lineTo(o+a,i+s),e.lineTo(o,i+s),e.lineTo(o,i),e.closePath(),e.stroke()}const Es=e=>{const{sharer:t,boardContent:n,calculator:o,viewer:i,eventHub:a}=e,{overlayContext:s}=n;let r=null,c=null,d=null,u=null;const h=()=>{r=null,t.setSharedStorage(_t,null),t.setSharedStorage(zo,null),t.setSharedStorage(Io,null),t.setSharedStorage(cn,null),t.setSharedStorage(pt,null),c=null,d=null,u=null},f=()=>t.getSharedStorage(gt)?(h(),!0):!1,m=()=>{const w=t.getSharedStorage(be);return w&&w!=="area"?(h(),!0):!1},v=()=>{const w=t.getActiveStorage("data");if(w!=null&&w.layout){const{x:y,y:x,w:b,h:C}=w.layout;return{x:y,y:x,w:b,h:C}}return null},g=w=>{const y=v();if(y){const{x,y:b,w:C,h:z}=y,L=t.getActiveViewScaleInfo(),N=We({x:x-Wn/2,y:b-Wn/2,w:C+Wn,h:z+Wn},{viewScaleInfo:L});return Hc(w,N)}return!1},p=()=>{const w=t.getActiveViewScaleInfo(),y=v();if(y){const x=$a(y,{viewScaleInfo:w,controllerSize:10});t.setSharedStorage(Io,x)}else t.setSharedStorage(Io,null)},S=w=>{const y=t.getActiveStorage("data"),x=t.getSharedStorage(Io);if(x&&(y!=null&&y.layout)&&(w!=null&&w.point)){let b=null;if(x){const{topLeft:C,top:z,topRight:L,right:N,bottomRight:R,bottom:k,bottomLeft:_,left:$}=x,U=[C,z,L,N,R,k,_,$];for(let V=0;V<U.length;V++){const P=U[V];if(gl(w.point,P.vertexes)){b=`${P.type}`;break}}if(b)return t.setSharedStorage(zo,b),a.trigger(Si,{}),b}}return null},E=w=>{u!==!0&&a.trigger("cursor",{type:w&&`resize-${w}`,groupQueue:[],element:v()})};return{name:"@middleware/layout-selector",use:()=>{h(),p()},hover:w=>{if(u!==!0&&!m()&&!f()){if(g(w.point)?t.setSharedStorage(cn,!0):(t.setSharedStorage(cn,!1),c===!0&&(i.drawFrame(),c=!1)),t.getSharedStorage(pt)===!0){const y=t.getSharedStorage(_t),x=t.getActiveStorage("data");if(x!=null&&x.layout)if(y!=="resize"){p();const b=S(w);b?E(b):(E(),t.setSharedStorage(_t,null))}else{const b=S(w);E(b)}return}t.getSharedStorage(cn)&&!c&&i.drawFrame(),c=t.getSharedStorage(cn)}},pointStart:w=>{if(m())return;g(w.point)?t.setSharedStorage(pt,!0):(d===!0&&(h(),i.drawFrame()),t.setSharedStorage(pt,!1)),p();const y=S(w);r=w.point,y&&t.setSharedStorage(_t,"resize"),t.getSharedStorage(pt)===!0&&!d&&i.drawFrame(),d=t.getSharedStorage(pt)},pointMove:w=>{if(!t.getSharedStorage(pt)&&m())return;const y=t.getSharedStorage(_t),x=t.getSharedStorage(zo),b=t.getActiveStorage("data");if(y==="resize"&&x&&(b!=null&&b.layout)){if(r){u=!0;const C=t.getActiveStorage("scale"),z=w.point.x-r.x,L=w.point.y-r.y,N=z/C,R=L/C,{x:k,y:_,w:$,h:U,operations:V={}}=b.layout,{position:P="absolute"}=V;x==="top"?P==="relative"?(b.layout.h=o.toGridNum(U-R),i.scroll({moveY:L})):(b.layout.y=o.toGridNum(_+R),b.layout.h=o.toGridNum(U-R)):x==="right"?b.layout.w=o.toGridNum($+N):x==="bottom"?b.layout.h=o.toGridNum(U+R):x==="left"?P==="relative"?(b.layout.w=o.toGridNum($-N),i.scroll({moveX:z})):(b.layout.x=o.toGridNum(k+N),b.layout.w=o.toGridNum($-N)):x==="top-left"?P==="relative"?(b.layout.w=o.toGridNum($-N),b.layout.h=o.toGridNum(U-R),i.scroll({moveX:z,moveY:L})):(b.layout.x=o.toGridNum(k+N),b.layout.y=o.toGridNum(_+R),b.layout.w=o.toGridNum($-N),b.layout.h=o.toGridNum(U-R)):x==="top-right"?P==="relative"?(i.scroll({moveY:L}),b.layout.w=o.toGridNum($+N),b.layout.h=o.toGridNum(U-R)):(b.layout.y=o.toGridNum(_+R),b.layout.w=o.toGridNum($+N),b.layout.h=o.toGridNum(U-R)):x==="bottom-right"?(b.layout.w=o.toGridNum($+N),b.layout.h=o.toGridNum(U+R)):x==="bottom-left"&&(P==="relative"?(i.scroll({moveX:z}),b.layout.w=o.toGridNum($-N),b.layout.h=o.toGridNum(U+R)):(b.layout.x=o.toGridNum(k+N),b.layout.w=o.toGridNum($-N),b.layout.h=o.toGridNum(U+R)))}return r=w.point,p(),i.drawFrame(),!1}if(["resize"].includes(y))return!1},pointEnd:()=>{u=!1;const w=t.getSharedStorage(_t),y=t.getSharedStorage(zo),x=t.getActiveStorage("data");x&&w==="resize"&&y&&a.trigger(Aa,{type:"changeLayout",data:x})},beforeDrawFrame:({snapshot:w})=>{var y;if(m())return;const{sharedStore:x,activeStore:b}=w,C=x[_t],z=x[cn],L=x[pt];if(!((y=b.data)===null||y===void 0)&&y.layout){const{x:N,y:R,w:k,h:_}=b.data.layout,$=ho(w),U={x:N,y:R,w:k,h:_},V=$a(U,{viewScaleInfo:$,controllerSize:Wn});if(z===!0){const P=We(U,{viewScaleInfo:$});Kd(s,{layoutSize:P})}(C&&["resize"].includes(C)||L===!0)&&Jd(s,{controller:V,operations:b.data.layout.operations||{}})}},scrollX:()=>{h()},scrollY:()=>{h()},wheelScale:()=>{h()}}},Ms=e=>{const{viewer:t,sharer:n,boardContent:o,calculator:i,eventHub:a}=e,{overlayContext:s}=o;let r=null,c=null;n.setSharedStorage(be,null),n.setSharedStorage(xo,!0);const d=()=>n.getSharedStorage(Dt),u=w=>{let y=n.getSharedStorage(Ge);Array.isArray(y)||(y=[]),y.length>0?Ud(w,y[y.length-1])?y.push(w):y=[]:y.length===0&&y.push(w);const x=za(y);return n.setSharedStorage(Ge,y),n.setSharedStorage(Gi,x),y.length>0},h=w=>{n.setSharedStorage(gt,w);let y=null;w&&(y=ro(w,{groupQueue:n.getSharedStorage(Ge)})),n.setSharedStorage(_n,y)},f=(w,y)=>{var x;if(n.setSharedStorage(Dt,w),w.length===1){const b=bo(w[0],{groupQueue:n.getSharedStorage(Ge),controllerSize:Yl,viewScaleInfo:n.getActiveViewScaleInfo()});n.setSharedStorage(sn,b),n.setSharedStorage(ln,ct(w[0].uuid,((x=n.getActiveStorage("data"))===null||x===void 0?void 0:x.elements)||[]))}else n.setSharedStorage(sn,null),n.setSharedStorage(ln,[]);(y==null?void 0:y.triggerEvent)===!0&&a.trigger(si,{uuids:w.map(b=>b.uuid)})},m=()=>({ctx:s,calculator:i,data:n.getActiveStorage("data"),selectedElements:d(),viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo(),groupQueue:n.getSharedStorage(Ge),areaSize:null,selectedElementController:n.getSharedStorage(sn),selectedElementPosition:n.getSharedStorage(ln)}),v=()=>{n.setSharedStorage(be,null),n.setSharedStorage(jt,null),n.setSharedStorage(So,null),n.setSharedStorage(Eo,null),n.setSharedStorage(Ge,[]),n.setSharedStorage(Gi,[]),n.setSharedStorage(gt,null),n.setSharedStorage(_n,null),n.setSharedStorage(Dt,[]),n.setSharedStorage(_d,null),n.setSharedStorage(sn,null),n.setSharedStorage(ln,[]),n.setSharedStorage(Mo,null),n.setSharedStorage(Yi,null)};v();const g=({uuids:w,positions:y})=>{let x=[];const b=n.getSharedStorage(be),C=n.getActiveStorage("data");y&&Array.isArray(y)?x=fl(y,(C==null?void 0:C.elements)||[]):x=Go(w,(C==null?void 0:C.elements)||[]);let z=!1;if(!b&&x.length===1?(n.setSharedStorage(be,"select"),z=!0):b==="select"&&x.length===1&&(z=!0),z){const L=x[0],N=Ca(L.uuid,(C==null?void 0:C.elements)||[]);n.setSharedStorage(Ge,N),f(x),t.drawFrame()}},p=()=>{v(),t.drawFrame()},S=w=>{n.setSharedStorage(xo,!!w.enable)},E=w=>{n.setSharedStorage(Yi,!!w.enable)};return{name:"@middleware/selector",use(){a.on(si,g),a.on(Si,p),a.on(ua,E),a.on(ha,S)},disuse(){a.off(si,g),a.off(Si,p),a.off(ua,E),a.off(ha,S)},hover:w=>{var y,x,b,C,z;const L=n.getSharedStorage(pt),N=n.getSharedStorage(jt),R=n.getSharedStorage(be),k=n.getSharedStorage(Ge),_=W=>{if(L===!0)return;const A=W.type;c===null&&a.trigger("cursor",{type:A,groupQueue:W.groupQueue,element:W.elements[0]})};if((k==null?void 0:k.length)>0){if(!ys(w.point,{ctx:s,viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo(),groupQueue:n.getSharedStorage(Ge)})){h(null),t.drawFrame();return}const A=Vn(w.point,m());if(_(A),N||["area","drag","drag-list"].includes(R)){h(null),t.drawFrame();return}if(((y=A==null?void 0:A.elements)===null||y===void 0?void 0:y.length)===1){h(A.elements[0]),t.drawFrame();return}h(null),t.drawFrame();return}if(N||["area","drag","drag-list"].includes(R)){h(null);return}if(R==="drag"){h(null);return}const $=d(),U=n.getActiveViewScaleInfo(),V=n.getActiveViewSizeInfo(),P=Vn(w.point,Object.assign(Object.assign({},m()),{areaSize:$i($,{viewScaleInfo:U,viewSizeInfo:V,calculator:i})}));if(_(P),P.type===null){(n.getSharedStorage(gt)||n.getSharedStorage(_n))&&(n.setSharedStorage(gt,null),n.setSharedStorage(_n,null),t.drawFrame());return}if(!(P.type==="over-element"&&n.getSharedStorage(be)==="select"&&P.elements.length===1&&P.elements[0].uuid===((b=(x=d())===null||x===void 0?void 0:x[0])===null||b===void 0?void 0:b.uuid))&&!(P.type==="over-element"&&n.getSharedStorage(be)===null&&P.elements.length===1&&P.elements[0].uuid===((C=n.getSharedStorage(gt))===null||C===void 0?void 0:C.uuid))){if(P.type==="over-element"&&((z=P==null?void 0:P.elements)===null||z===void 0?void 0:z.length)===1){h(P.elements[0]),t.drawFrame();return}if(n.getSharedStorage(gt)){h(null),t.drawFrame();return}}},pointStart:w=>{var y,x,b,C,z,L,N,R,k,_;r=w.point;const $=n.getSharedStorage(Ge);if(($==null?void 0:$.length)>0){if(ys(w.point,{ctx:s,viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo(),groupQueue:$})){const P=Vn(w.point,m());if(((y=P==null?void 0:P.elements)===null||y===void 0?void 0:y.length)===1&&((b=(x=P.elements[0])===null||x===void 0?void 0:x.operations)===null||b===void 0?void 0:b.lock)===!0)return;h(null),P.type==="over-element"&&((C=P==null?void 0:P.elements)===null||C===void 0?void 0:C.length)===1?(f([P.elements[0]],{triggerEvent:!0}),n.setSharedStorage(be,"drag")):!((z=P.type)===null||z===void 0)&&z.startsWith("resize-")?(n.setSharedStorage(jt,P.type),n.setSharedStorage(be,"resize")):f([],{triggerEvent:!0})}else v();t.drawFrame();return}const U=$i(d(),{viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo(),calculator:i}),V=Vn(w.point,Object.assign(Object.assign({},m()),{areaSize:U,groupQueue:[]}));((L=V==null?void 0:V.elements)===null||L===void 0?void 0:L.length)===1&&((R=(N=V.elements[0])===null||N===void 0?void 0:N.operations)===null||R===void 0?void 0:R.lock)===!0||(h(null),V.type==="list-area"?n.setSharedStorage(be,"drag-list"):V.type==="over-element"&&((k=V==null?void 0:V.elements)===null||k===void 0?void 0:k.length)===1?(f([V.elements[0]],{triggerEvent:!0}),n.setSharedStorage(be,"drag")):!((_=V.type)===null||_===void 0)&&_.startsWith("resize-")?(n.setSharedStorage(jt,V.type),n.setSharedStorage(be,"resize")):(v(),n.setSharedStorage(be,"area"),n.setSharedStorage(So,w.point),f([],{triggerEvent:!0})),t.drawFrame())},pointMove:w=>{var y,x,b;n.setSharedStorage(Mo,!0);const C=n.getActiveStorage("data"),z=d(),L=n.getActiveStorage("scale")||1,N=n.getActiveViewScaleInfo(),R=n.getActiveViewSizeInfo(),k=r,_=w.point,$=n.getSharedStorage(jt),U=n.getSharedStorage(be),V=n.getSharedStorage(Ge),P=n.getSharedStorage(xo);if(U==="drag"){if(c="drag",C&&(z==null?void 0:z.length)===1&&k&&_&&((x=(y=z[0])===null||y===void 0?void 0:y.operations)===null||x===void 0?void 0:x.lock)!==!0){const{moveX:W,moveY:A}=Zd(k,_,V);let Y=i.toGridNum(W/L),G=i.toGridNum(A/L);if(P===!0){const I=Xi(z[0].uuid,{calculator:i,data:C,groupQueue:V,viewScaleInfo:N,viewSizeInfo:R});try{I&&(Se.x(I.offsetX)&&I.offsetX!==null&&(Y=i.toGridNum(Y+I.offsetX)),Se.y(I.offsetY)&&I.offsetY!==null&&(G=i.toGridNum(G+I.offsetY)))}catch(H){console.error(H)}}z[0].x=i.toGridNum(z[0].x+Y),z[0].y=i.toGridNum(z[0].y+G),f([z[0]]),i.modifyViewVisibleInfoMap(C,{modifyOptions:{type:"updateElement",content:{element:z[0],position:n.getSharedStorage(ln)||[]}},viewSizeInfo:R,viewScaleInfo:N})}t.drawFrame()}else if(U==="drag-list"){if(c="drag-list",C&&k&&_&&(z==null?void 0:z.length)>1){const W=(_.x-k.x)/L,A=(_.y-k.y)/L;z.forEach(Y=>{var G;Y&&((G=Y==null?void 0:Y.operations)===null||G===void 0?void 0:G.lock)!==!0&&(Y.x=i.toGridNum(Y.x+W),Y.y=i.toGridNum(Y.y+A),i.modifyViewVisibleInfoMap(C,{modifyOptions:{type:"updateElement",content:{element:Y,position:ct(Y.uuid,C.elements)||[]}},viewSizeInfo:R,viewScaleInfo:N}))}),n.setActiveStorage("data",C)}t.drawFrame()}else if(U==="resize"){if(C&&(z==null?void 0:z.length)===1&&k&&($!=null&&$.startsWith("resize-"))){c="resize";const W=[];V.forEach(G=>{const{x:I,y:H,w:Z,h:M,angle:O=0}=G;W.push({x:I,y:H,w:Z,h:M,angle:0-O})});let A=k,Y=_;if(V.length>0&&(A=gi(k,W),Y=gi(_,W)),$==="resize-rotate"){const G=n.getSharedStorage(sn),I=[G.topLeft.center,G.topRight.center,G.bottomLeft.center,G.bottomRight.center],H=ll(I),Z=$d(z[0],{center:H,viewScaleInfo:N,viewSizeInfo:R,start:k,end:_,resizeType:$,sharer:n});z[0].angle=i.toGridNum(Z.angle||0)}else{const G=Yd(z[0],{scale:L,start:A,end:Y,resizeType:$,sharer:n}),I={ignore:!!z[0].angle};z[0].x=i.toGridNum(G.x,I),z[0].y=i.toGridNum(G.y,I),z[0].type==="group"&&((b=z[0].operations)===null||b===void 0?void 0:b.deepResize)===!0?Sl(z[0],{w:i.toGridNum(G.w,I),h:i.toGridNum(G.h,I)}):(z[0].w=i.toGridNum(G.w,I),z[0].h=i.toGridNum(G.h,I))}f([z[0]]),i.modifyViewVisibleInfoMap(C,{modifyOptions:{type:"updateElement",content:{element:z[0],position:n.getSharedStorage(ln)||[]}},viewSizeInfo:R,viewScaleInfo:N}),t.drawFrame()}}else U==="area"&&(c="area",n.setSharedStorage(Eo,w.point),t.drawFrame());r=w.point},pointEnd(w){c=null,n.setSharedStorage(Mo,!1);const y=n.getActiveStorage("data"),x=n.getSharedStorage(Dt),b=n.getSharedStorage(gt),C=n.getSharedStorage(jt),z=n.getSharedStorage(be),L=n.getActiveViewSizeInfo();let N=!1;if(r=null,z==="resize"&&C)n.setSharedStorage(jt,null),N=!0;else if(z==="area"){if(n.setSharedStorage(be,null),y){const k=n.getSharedStorage(So),_=n.getSharedStorage(Eo);if(k&&_){const{elements:$}=Xd(y,{start:k,end:_,calculator:i,viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo()});$.length>0&&(n.setSharedStorage(be,"drag-list"),f($,{triggerEvent:!0}),N=!0)}}}else z==="drag-list"?(n.setSharedStorage(be,"drag-list-end"),N=!0):y&&(i.getPointElement(w.point,{data:y,viewScaleInfo:n.getActiveViewScaleInfo(),viewSizeInfo:n.getActiveViewSizeInfo()}).element?(n.setSharedStorage(be,"select"),N=!0):n.setSharedStorage(be,null));n.getSharedStorage(be)===null&&(v(),N=!0),(()=>{if(N){if(y&&Array.isArray(y==null?void 0:y.elements)&&["drag","drag-list"].includes(z)){const k=_c(y.elements,L,{extend:!0});n.setActiveStorage("contextHeight",k.contextSize.contextHeight),n.setActiveStorage("contextWidth",k.contextSize.contextWidth)}y&&["drag","drag-list","drag-list-end","resize"].includes(z)&&a.trigger(Aa,{data:y,type:"dragElement",selectedElements:x,hoverElement:b}),t.drawFrame()}})()},pointLeave(){r=null,v(),t.drawFrame()},doubleClick(w){var y,x,b,C,z,L,N,R;if(n.getSharedStorage(Yi)===!1)return;const k=Vn(w.point,m());if(n.setSharedStorage(sn,null),n.setSharedStorage(Dt,[]),!(k.elements.length===1&&((x=(y=k.elements[0])===null||y===void 0?void 0:y.operations)===null||x===void 0?void 0:x.lock)===!0)){if(k.elements.length===1&&((b=k.elements[0])===null||b===void 0?void 0:b.type)==="group"){if(u(k.elements[0])===!0){n.setSharedStorage(be,null),t.drawFrame();return}}else k.elements.length===1&&((C=k.elements[0])===null||C===void 0?void 0:C.type)==="text"&&!(!((L=(z=k.elements[0])===null||z===void 0?void 0:z.operations)===null||L===void 0)&&L.invisible)&&a.trigger(Ei,{element:k.elements[0],groupQueue:n.getSharedStorage(Ge)||[],position:ct((N=k.elements[0])===null||N===void 0?void 0:N.uuid,((R=n.getActiveStorage("data"))===null||R===void 0?void 0:R.elements)||[]),viewScaleInfo:n.getActiveViewScaleInfo()});n.setSharedStorage(be,null)}},beforeDrawFrame({snapshot:w}){var y;const{activeStore:x,sharedStore:b}=w,{scale:C,offsetLeft:z,offsetTop:L,offsetRight:N,offsetBottom:R,width:k,height:_,contextHeight:$,contextWidth:U,devicePixelRatio:V}=x,P=e.sharer,W={scale:C,offsetLeft:z,offsetTop:L,offsetRight:N,offsetBottom:R},A={width:k,height:_,contextHeight:$,contextWidth:U,devicePixelRatio:V},G=b[Dt][0],I=b[gt],H=b[_n],Z=b[be],M=b[So],O=b[Eo],D=b[Ge],F=b[Gi],j=b[Mo],K=b[xo],ie={calculator:i,viewScaleInfo:W,viewSizeInfo:A},le=G?bo(G,{groupQueue:D,controllerSize:10,viewScaleInfo:W}):null,Qe=!!(!((y=I==null?void 0:I.operations)===null||y===void 0)&&y.lock);if((D==null?void 0:D.length)>0){if(Gd(s,F,ie),I&&Z!=="drag"&&(Qe?gs(s,H,Object.assign(Object.assign({},ie),{controller:bo(I,{groupQueue:D,controllerSize:10,viewScaleInfo:W})})):ms(s,H,ie)),!Qe&&G&&["select","drag","resize"].includes(Z)&&(vs(s,le,Object.assign(Object.assign({},ie),{element:G,calculator:i,hideControllers:!!j&&Z==="drag"})),Z==="drag"&&K===!0)){const Je=Xi(G.uuid,{calculator:i,data:x.data,groupQueue:D,viewScaleInfo:W,viewSizeInfo:A});if(Je){const{offsetX:Rn,offsetY:Oi,xLines:Ri,yLines:Li}=Je;(Rn===0||Oi===0)&&ps(s,{xLines:Ri,yLines:Li})}}}else if(I&&Z!=="drag"&&(Qe?gs(s,H,Object.assign(Object.assign({},ie),{controller:bo(I,{groupQueue:D,controllerSize:10,viewScaleInfo:W})})):ms(s,H,ie)),!Qe&&G&&["select","drag","resize"].includes(Z)){if(vs(s,le,Object.assign(Object.assign({},ie),{element:G,calculator:i,hideControllers:!!j&&Z==="drag"})),Z==="drag"&&K===!0){const Je=Xi(G.uuid,{calculator:i,data:x.data,groupQueue:D,viewScaleInfo:W,viewSizeInfo:A});if(Je){const{offsetX:Rn,offsetY:Oi,xLines:Ri,yLines:Li}=Je;(Rn===0||Oi===0)&&ps(s,{xLines:Ri,yLines:Li})}}}else if(Z==="area"&&M&&O)Fd(s,{start:M,end:O});else if(["drag-list","drag-list-end"].includes(Z)){const Je=$i(d(),{viewScaleInfo:P.getActiveViewScaleInfo(),viewSizeInfo:P.getActiveViewSizeInfo(),calculator:i});Je&&Hd(s,{areaSize:Je})}}}},on="SCROLL",li=Symbol(`${on}_xThumbRect`),ri=Symbol(`${on}_yThumbRect`),qn=Symbol(`${on}_hoverXThumbRect`),eo=Symbol(`${on}_hoverYThumbRect`),Cn=Symbol(`${on}_prevPoint`),va=Symbol(`${on}_activePoint`),to=Symbol(`${on}_activeThumbType`),qd=12,xs=16,eu=.3,Bn={width:qd,thumbColor:"#0000008A",thumbHoverColor:"#000000EE",scrollBarColor:"#FFFFFF60",showScrollBar:!1};function Cs(e,t,n){const o=e,{x:i,y:a,w:s,h:r}=n;return o.beginPath(),o.rect(i,a,s,r),o.closePath(),!!o.isPointInPath(t.x,t.y)}function tu(e,t,n){let o=null;const{xThumbRect:i,yThumbRect:a}=n;return i&&Cs(e,t,i)?o="X":a&&Cs(e,t,a)&&(o="Y"),o}function nu(e){const{sharedStore:t}=e;return{activePoint:t[va]||null,prevPoint:t[Cn]||null,activeThumbType:t[to]||null,xThumbRect:t[li]||null,yThumbRect:t[ri]||null,hoverXThumb:t[qn],hoverYThumb:t[eo]}}function ou(e){const{viewScaleInfo:t,viewSizeInfo:n,hoverXThumb:o,hoverYThumb:i}=e,{width:a,height:s}=n,{offsetTop:r,offsetBottom:c,offsetLeft:d,offsetRight:u}=t,h=xs*2.5,f=xs;let m=0,v=0;m=Math.max(h,a-f*2-(Math.abs(d)+Math.abs(u))),m>=a&&(m=a),v=Math.max(h,s-f*2-(Math.abs(r)+Math.abs(c))),v>=s&&(v=s);const g=f,p=a-m-f;let S=g;d>0?S=g:u>0?S=p:d<=0&&m>0&&!(d===0&&u===0)&&(S=g+(a-m)*Math.abs(d)/(Math.abs(d)+Math.abs(u)),S=Math.min(Math.max(0,S-g),a-m));const E=f,w=s-v-f;let y=E;r>0?y=E:c>0?y=w:r<=0&&v>0&&!(r===0&&c===0)&&(y=E+(s-v)*Math.abs(r)/(Math.abs(r)+Math.abs(c)),y=Math.min(Math.max(0,y-E),s-v));const x={x:S,y:s-f,w:m,h:f},b={x:a-f,y,w:f,h:v};return{lineSize:f,xSize:m,ySize:v,translateY:y,translateX:S,xThumbColor:o?Bn.thumbHoverColor:Bn.thumbColor,yThumbColor:i?Bn.thumbHoverColor:Bn.thumbColor,scrollBarColor:Bn.scrollBarColor,xThumbRect:x,yThumbRect:b}}function zs(e,t){let{x:n,y:o,h:i,w:a}=t;e.save(),e.shadowColor="#FFFFFF",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=1;{const{color:s,axis:r}=t;r==="X"?(o=o+i/4+0,i=i/2):r==="Y"&&(n=n+a/4+0,a=a/2);let c=t.r;c=Math.min(c,a/2,i/2),(a<c*2||i<c*2)&&(c=0),e.globalAlpha=eu,e.beginPath(),e.moveTo(n+c,o),e.arcTo(n+a,o,n+a,o+i,c),e.arcTo(n+a,o+i,n,o+i,c),e.arcTo(n,o+i,n,o,c),e.arcTo(n,o,n+a,o,c),e.closePath(),e.fillStyle=s,e.fill(),e.globalAlpha=1,e.beginPath(),e.lineWidth=1,e.strokeStyle=s,e.setLineDash([]),e.moveTo(n+c,o),e.arcTo(n+a,o,n+a,o+i,c),e.arcTo(n+a,o+i,n,o+i,c),e.arcTo(n,o+i,n,o,c),e.arcTo(n,o,n+a,o,c),e.closePath(),e.stroke()}e.restore()}function iu(e,t){const n=e,{viewScaleInfo:o,viewSizeInfo:i,scrollInfo:a}=t,{activeThumbType:s,prevPoint:r,activePoint:c,hoverXThumb:d,hoverYThumb:u}=a,h=ou({viewScaleInfo:o,viewSizeInfo:i,hoverXThumb:d,hoverYThumb:u});let f=Object.assign({},h.xThumbRect),m=Object.assign({},h.yThumbRect);return s&&r&&c&&(s==="X"&&a.xThumbRect?(f=Object.assign({},a.xThumbRect),f.x=f.x+(c.x-r.x)):s==="Y"&&a.yThumbRect&&(m=Object.assign({},a.yThumbRect),m.y=m.y+(c.y-r.y))),zs(n,Object.assign(Object.assign({axis:"X"},f),{r:h.lineSize/2,color:h.xThumbColor})),zs(n,Object.assign(Object.assign({axis:"Y"},m),{r:h.lineSize/2,color:h.yThumbColor})),n.globalAlpha=1,{xThumbRect:f,yThumbRect:m}}function au(e,t){const{snapshot:n}=t,o=Ii(n),i=ho(n),a=nu(n),{xThumbRect:s,yThumbRect:r}=iu(e,{viewSizeInfo:o,viewScaleInfo:i,scrollInfo:a});return{xThumbRect:s,yThumbRect:r}}const Is=e=>{const{viewer:t,boardContent:n,sharer:o,eventHub:i}=e,{overlayContext:a}=n;o.setSharedStorage(li,null),o.setSharedStorage(ri,null);let s=!1;const r=()=>{o.setSharedStorage(Cn,null),o.setSharedStorage(va,null),o.setSharedStorage(to,null),o.setSharedStorage(qn,null),o.setSharedStorage(eo,null),s=!1};r();const c=h=>{const f=o.getSharedStorage(Cn);if(f){const{offsetLeft:m,offsetRight:v}=o.getActiveViewScaleInfo(),{width:g}=o.getActiveViewSizeInfo(),p=-(h.x-f.x),S=g+Math.abs(m)+Math.abs(v),E=p*S/g;t.scroll({moveX:E}),t.drawFrame()}},d=h=>{const f=o.getSharedStorage(Cn);if(f){const{offsetTop:m,offsetBottom:v}=o.getActiveViewScaleInfo(),{height:g}=o.getActiveViewSizeInfo(),p=-(h.y-f.y),S=g+Math.abs(m)+Math.abs(v),E=p*S/g;t.scroll({moveY:E}),t.drawFrame()}},u=h=>tu(a,h,{xThumbRect:o.getSharedStorage(li),yThumbRect:o.getSharedStorage(ri)});return{name:"@middleware/scroller",wheel:h=>{t.scroll({moveX:0-h.deltaX,moveY:0-h.deltaY}),t.drawFrame()},hover:h=>{if(s===!0)return!1;const{point:f}=h,m=u(f);if(m==="X"||m==="Y")return m==="X"?(o.setSharedStorage(qn,!0),o.setSharedStorage(eo,!1)):(o.setSharedStorage(qn,!1),o.setSharedStorage(eo,!0)),i.trigger("cursor",{type:"default"}),!1;o.setSharedStorage(qn,!1),o.setSharedStorage(eo,!1)},pointStart:h=>{const{point:f}=h,m=u(f);if(m==="X"||m==="Y")return s=!0,o.setSharedStorage(to,m),o.setSharedStorage(Cn,f),!1},pointMove:h=>{const{point:f}=h,m=o.getSharedStorage(to);if(m==="X"||m==="Y")return o.setSharedStorage(va,f),m==="X"?c(f):m==="Y"&&d(f),o.setSharedStorage(Cn,f),!1},pointEnd:()=>{s=!1;const h=o.getSharedStorage(to);if(r(),h==="X"||h==="Y")return t.scroll({moveX:0,moveY:0}),t.drawFrame(),!1},beforeDrawFrame({snapshot:h}){const{xThumbRect:f,yThumbRect:m}=au(a,{snapshot:h});o.setSharedStorage(li,f),o.setSharedStorage(ri,m)}}},Xl="@middleware/scale",As=e=>{const{viewer:t,sharer:n,eventHub:o}=e,i=50,a=.05;return{name:"@middleware/scaler",wheelScale(s){const{deltaY:r,point:c}=s,{scale:d}=n.getActiveViewScaleInfo();let u=d;if(r<0?u=d*1.1:r>0&&(u=d*.9),u<a||u>i)return;const{moveX:h,moveY:f}=t.scale({scale:u,point:c});t.scroll({moveX:h,moveY:f}),t.drawFrame();const m=ge(d);o.trigger(Xl,{scale:m})}}},De=16,su="#FFFFFFA8",lu="#00000080",Ul="#000000",Zl="#00000080",Ql="monospace",pa=10,Jl=100,Ns="#AAAAAA20",Ds="#AAAAAA40",Ni=1,Ts="#196097",dn=[1,2,5,10,20,50,100,200,500];function ru(e){e=Math.max(dn[0],Math.min(e,dn[dn.length-1]));for(let t=0;t<dn.length-1;t++){const n=dn[t],o=dn[t+1];if(e>o)continue;if(e===n||e===o)return e;const i=(n+o)/2;return e<=i?n:o}return e}function Kl(e){const{scale:t,viewLength:n,viewOffset:o}=e,i=[];let a=10;a=ge(a/t,{decimalPlaces:0}),a=ru(a);const s=a*10,r=a*5;let c=0;const d=a*t,u=0-o,h=0,f=u%d,m=(u-f+d)/t,v=h+(d-f);for(;v+c*d<n;){const g=ge(m+c*a,{decimalPlaces:0}),p=ge(v+c*d,{decimalPlaces:0}),S={num:g,position:p,showNum:g%s===0,isKeyNum:g%s===0,isSubKeyNum:g%r===0};i.push(S),c++}return{list:i,rulerUnit:a}}function cu(e){const{viewScaleInfo:t,viewSizeInfo:n}=e,{scale:o,offsetLeft:i}=t,{width:a}=n;return Kl({axis:"X",scale:o,viewLength:a,viewOffset:i})}function du(e){const{viewScaleInfo:t,viewSizeInfo:n}=e,{scale:o,offsetTop:i}=t,{height:a}=n;return Kl({axis:"Y",scale:o,viewLength:a,viewOffset:i})}function uu(e,t){const{scaleList:n}=t,o=De,i=De*4/5,a=De*2/5,s=De*1/5,r=De/5;for(let c=0;c<n.length;c++){const d=n[c];d.position<De||(e.beginPath(),e.moveTo(d.position,o),e.lineTo(d.position,d.isKeyNum?s:d.isSubKeyNum?a:i),e.closePath(),e.lineWidth=Ni,e.setLineDash([]),e.fillStyle=Ul,e.stroke(),d.isKeyNum&&(e.fillStyle=Zl,e.textBaseline="top",e.$setFont({fontWeight:Jl,fontSize:pa,fontFamily:Ql}),e.fillText(`${d.num}`,d.position+r,r)))}}function hu(e,t){const{scaleList:n}=t,o=De,i=De*4/5,a=De*2/5,s=De*1/5,r=De/5;for(let c=0;c<n.length;c++){const d=n[c];if(!(d.position<De)&&(e.beginPath(),e.moveTo(o,d.position),e.lineTo(d.isKeyNum?s:d.isSubKeyNum?a:i,d.position),e.closePath(),e.fillStyle=Ul,e.lineWidth=Ni,e.setLineDash([]),e.stroke(),d.showNum===!0)){const u=r,h=d.position+r,f=`${d.num}`;fo(e,-90,{x:u,y:h},()=>{e.fillStyle=Zl,e.textBaseline="top",e.$setFont({fontWeight:Jl,fontSize:pa,fontFamily:Ql}),e.fillText(f,r+pa,d.position+r)})}}}function fu(e,t){const{viewSizeInfo:n}=t,{width:o,height:i}=n;e.beginPath(),e.moveTo(0,0),e.lineTo(o+1,0),e.lineTo(o+1,De),e.lineTo(De,De),e.lineTo(De,i+1),e.lineTo(0,i+1),e.lineTo(0,0),e.closePath(),e.fillStyle=su,e.fill(),e.lineWidth=Ni,e.setLineDash([]),e.strokeStyle=lu,e.stroke()}function mu(e,t){const{xList:n,yList:o,viewSizeInfo:i}=t,{width:a,height:s}=i;for(let r=0;r<n.length;r++){const c=n[r];e.beginPath(),e.moveTo(c.position,0),e.lineTo(c.position,s),c.isKeyNum===!0||c.isSubKeyNum===!0?e.strokeStyle=Ds:e.strokeStyle=Ns,e.closePath(),e.lineWidth=Ni,e.setLineDash([]),e.stroke()}for(let r=0;r<o.length;r++){const c=o[r];e.beginPath(),e.moveTo(0,c.position),e.lineTo(a,c.position),c.isKeyNum===!0||c.isSubKeyNum===!0?e.strokeStyle=Ds:e.strokeStyle=Ns,e.lineWidth=1,e.closePath(),e.stroke()}}function gu(e,t){const{snapshot:n,calculator:o}=t,{sharedStore:i}=n,a=i[Dt],s=i[be];if(["select","drag","drag-list","drag-list-end"].includes(s)&&a.length>0){const r=ho(n),c=Ii(n),d=[],u=[],h=[],f=[],m=[];if(a.forEach(E=>{const w=o.calcViewRectInfoFromRange(E.uuid,{viewScaleInfo:r,viewSizeInfo:c});w&&(d.push(w),u.push(w.left.x),h.push(w.right.x),f.push(w.top.y),m.push(w.bottom.y))}),!(d.length>0))return;const v=Math.min(...u),g=Math.max(...h),p=Math.min(...f),S=Math.max(...m);e.globalAlpha=1,e.beginPath(),e.moveTo(v,0),e.lineTo(g,0),e.lineTo(g,De),e.lineTo(v,De),e.fillStyle=Ts,e.closePath(),e.fill(),e.beginPath(),e.moveTo(0,p),e.lineTo(De,p),e.lineTo(De,S),e.lineTo(0,S),e.fillStyle=Ts,e.closePath(),e.fill()}}const ya="@middleware/show-ruler",Ps=e=>{const{boardContent:t,viewer:n,eventHub:o,calculator:i}=e,{overlayContext:a,underlayContext:s}=t;let r=!0,c=!0;const d=u=>{typeof(u==null?void 0:u.show)=="boolean"&&(r=u.show),typeof(u==null?void 0:u.showGrid)=="boolean"&&(c=u.showGrid),(typeof(u==null?void 0:u.show)=="boolean"||typeof(u==null?void 0:u.showGrid)=="boolean")&&n.drawFrame()};return{name:"@middleware/ruler",use(){o.on(ya,d)},disuse(){o.off(ya,d)},beforeDrawFrame:({snapshot:u})=>{if(r===!0){const h=ho(u),f=Ii(u);gu(a,{snapshot:u,calculator:i}),fu(a,{viewScaleInfo:h,viewSizeInfo:f});const{list:m,rulerUnit:v}=cu({viewScaleInfo:h,viewSizeInfo:f});uu(a,{scaleList:m});const{list:g}=du({viewScaleInfo:h,viewSizeInfo:f});hu(a,{scaleList:g}),c===!0&&mu(v===1?a:s,{xList:m,yList:g,viewScaleInfo:h,viewSizeInfo:f})}}}},vu="DRAG",Do=Symbol(`${vu}_prevPoint`),Os=e=>{const{eventHub:t,sharer:n,viewer:o}=e;let i=!1;return{name:"@middleware/dragger",hover(){i!==!0&&t.trigger("cursor",{type:"drag-default"})},pointStart(a){const{point:s}=a;n.setSharedStorage(Do,s),i=!0,t.trigger("cursor",{type:"drag-active"})},pointMove(a){const{point:s}=a,r=n.getSharedStorage(Do);if(s&&r){const c=s.x-r.x,d=s.y-r.y;o.scroll({moveX:c,moveY:d}),o.drawFrame()}n.setSharedStorage(Do,s)},pointEnd(){i=!1,n.setSharedStorage(Do,null),t.trigger("cursor",{type:"drag-default"})}}},Da="monospace";function pu(e,t){const{point:n,rotateCenter:o,angle:i,text:a,color:s,background:r,fontSize:c,lineHeight:d}=t;fo(e,i,o,()=>{e.$setFont({fontWeight:"300",fontSize:c,fontFamily:Da});const u=(d-c)/2,h=e.$undoPixelRatio(e.measureText(a).width),f={x:n.x-h/2-u,y:n.y},m={x:f.x+h+u*2,y:f.y+c+u},v={x:n.x-h/2,y:n.y};e.setLineDash([]),e.fillStyle=r,e.beginPath(),e.moveTo(f.x,f.y),e.lineTo(m.x,f.y),e.lineTo(m.x,m.y),e.lineTo(f.x,m.y),e.closePath(),e.fill(),e.fillStyle=s,e.textBaseline="top",e.fillText(a,v.x,v.y+u)})}function yu(e,t){const{point:n,rotateCenter:o,angle:i,text:a,color:s,background:r,fontSize:c,lineHeight:d}=t;fo(e,i,o,()=>{e.$setFont({fontWeight:"300",fontSize:c,fontFamily:Da});const u=(d-c)/2,h=e.$undoPixelRatio(e.measureText(a).width),f={x:n.x,y:n.y},m={x:f.x+h+u*2,y:f.y+c+u},v={x:n.x+u,y:n.y};e.setLineDash([]),e.fillStyle=r,e.beginPath(),e.moveTo(f.x,f.y),e.lineTo(m.x,f.y),e.lineTo(m.x,m.y),e.lineTo(f.x,m.y),e.closePath(),e.fill(),e.fillStyle=s,e.textBaseline="top",e.fillText(a,v.x,v.y+u)})}function wu(e,t){const{point:n,rotateCenter:o,angle:i,text:a,color:s,background:r,fontSize:c,lineHeight:d}=t;fo(e,i,o,()=>{e.$setFont({fontWeight:"300",fontSize:c,fontFamily:Da});const u=(d-c)/2,h=e.$undoPixelRatio(e.measureText(a).width),f={x:n.x,y:n.y},m={x:f.x+h+u*2,y:f.y+c+u},v={x:n.x+u,y:n.y};e.setLineDash([]),e.fillStyle=r,e.beginPath(),e.moveTo(f.x,f.y),e.lineTo(m.x,f.y),e.lineTo(m.x,m.y),e.lineTo(f.x,m.y),e.closePath(),e.fill(),e.fillStyle=s,e.textBaseline="top",e.fillText(a,v.x,v.y+u)})}const Ui="#1973bac6",Zi="#ffffff",Vt=10,Qi=16,Rs=e=>{const{boardContent:t,calculator:n}=e,{overlayContext:o}=t;return{name:"@middleware/info",beforeDrawFrame({snapshot:i}){const{sharedStore:a}=i,s=a[Dt],r=a[be],c=a[Ge]||[];if(s.length===1){const d=s[0];if(d&&["select","drag","resize"].includes(r)){const u=ho(i),h=Ii(i),{x:f,y:m,w:v,h:g,angle:p}=d,S=[...c,{uuid:$e(),x:f,y:m,w:v,h:g,angle:p,type:"group",detail:{children:[]}}],E={viewScaleInfo:u,viewSizeInfo:h},w=n.calcViewRectInfoFromOrigin(d.uuid,E);let y=0;S.forEach(b=>{y+=b.angle||0});const x=St(lt(0-y));if(w){const b=w==null?void 0:w.center,C={topLeft:Me(b,w.topLeft,x),topRight:Me(b,w.topRight,x),bottomRight:Me(b,w.bottomRight,x),bottomLeft:Me(b,w.bottomLeft,x),center:Me(b,w.center,x),top:Me(b,w.top,x),right:Me(b,w.right,x),bottom:Me(b,w.bottom,x),left:Me(b,w.left,x)},z=ge(d.x,{decimalPlaces:2}),L=ge(d.y,{decimalPlaces:2}),N=ge(d.w,{decimalPlaces:2}),R=ge(d.h,{decimalPlaces:2}),k=`${ge(z,{decimalPlaces:0})},${ge(L,{decimalPlaces:0})}`,_=`${ge(N,{decimalPlaces:0})}x${ge(R,{decimalPlaces:0})}`,$=`${ge(d.angle||0,{decimalPlaces:0})}°`;pu(o,{point:{x:C.bottom.x,y:C.bottom.y+Vt},rotateCenter:C.center,angle:y,text:_,fontSize:Vt,lineHeight:Qi,color:Zi,background:Ui}),yu(o,{point:{x:C.topLeft.x,y:C.topLeft.y-Vt*2},rotateCenter:C.center,angle:y,text:k,fontSize:Vt,lineHeight:Qi,color:Zi,background:Ui}),wu(o,{point:{x:C.top.x+Vt,y:C.top.y-Vt*2},rotateCenter:C.center,angle:y,text:$,fontSize:Vt,lineHeight:Qi,color:Zi,background:Ui})}}}}}};var Ji=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},Ce=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},wa,ze,ci,Mi,ql;class bu{constructor(t,n){wa.add(this),ze.set(this,void 0),ci.set(this,void 0),Mi.set(this,void 0);const{devicePixelRatio:o=1,width:i,height:a,createCustomContext2D:s}=n;Ji(this,Mi,t,"f");const r=document.createElement("canvas");Ji(this,ci,r,"f"),Ce(this,wa,"m",ql).call(this),t.appendChild(r);const c=Oc(r,{width:i,height:a,devicePixelRatio:o,offscreen:!0,createCustomContext2D:s}),d=new Pd({boardContent:c,container:t}),u=d.getSharer();u.setActiveViewSizeInfo({width:i,height:a,devicePixelRatio:o,contextWidth:i,contextHeight:a}),Ji(this,ze,d,"f"),this.resize(u.getActiveViewSizeInfo());const h=d.getEventHub();new jd(t,{eventHub:h})}isDestroyed(){return Ce(this,ze,"f").isDestroyed()}destroy(){Ce(this,ze,"f").destroy(),Ce(this,ci,"f").remove()}use(t){Ce(this,ze,"f").use(t)}disuse(t){Ce(this,ze,"f").disuse(t)}setData(t,n){cl((t==null?void 0:t.elements)||[]),Ce(this,ze,"f").setData(t,n)}getData(){return Ce(this,ze,"f").getData()}scale(t){Ce(this,ze,"f").scale(t),Ce(this,ze,"f").getViewer().drawFrame()}resize(t){const n=Ce(this,ze,"f"),i=n.getSharer().getActiveViewSizeInfo();n.resize(Object.assign(Object.assign({},i),t))}clear(){Ce(this,ze,"f").clear()}on(t,n){Ce(this,ze,"f").getEventHub().on(t,n)}off(t,n){Ce(this,ze,"f").getEventHub().off(t,n)}trigger(t,n){Ce(this,ze,"f").getEventHub().trigger(t,n)}getViewInfo(){const n=Ce(this,ze,"f").getSharer(),o=n.getActiveViewSizeInfo(),i=n.getActiveViewScaleInfo();return{viewSizeInfo:o,viewScaleInfo:i}}refresh(){Ce(this,ze,"f").getViewer().drawFrame()}setViewScale(t){Ce(this,ze,"f").updateViewScaleInfo(t)}getLoadItemMap(){return Ce(this,ze,"f").getRenderer().getLoadItemMap()}onBoardWatcherEvents(){Ce(this,ze,"f").onWatcherEvents()}offBoardWatcherEvents(){Ce(this,ze,"f").offWatcherEvents()}}ze=new WeakMap,ci=new WeakMap,Mi=new WeakMap,wa=new WeakSet,ql=function(){const t=Ce(this,Mi,"f");t.style.position="relative"};const xi="select",Su={mode:xi};function Eu(){return{mode:xi,enableRuler:!1,enableScale:!1,enableScroll:!1,enableSelect:!1,enableTextEdit:!1,enableDrag:!1,enableInfo:!1}}var Mu=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})};function xu(e){return Mu(this,void 0,void 0,function*(){const{data:t,width:n,height:o,devicePixelRatio:i,viewScaleInfo:a,viewSizeInfo:s,loadItemMap:r}=e;let c=Fo({width:n,height:o,devicePixelRatio:i}),d=new Pl({viewContext:c}),u=new Tl({viewContext:c,calculator:d});u.setLoadItemMap(r),u.drawData(t,{viewScaleInfo:a,viewSizeInfo:s,forceDrawAll:!0});let h=null,f=c.$getOffscreenCanvas();if(f){const m=yield f.convertToBlob();h=window.URL.createObjectURL(m)}return f=null,c=null,d=null,u=null,{blobURL:h,width:n,height:o,devicePixelRatio:i}})}const Cu=Aa,Ls={change:Cu,ruler:ya,scale:Xl,select:si,clearSelect:Si,textEdit:Ei,textChange:ga},he={};Object.keys(Ls).forEach(e=>{Object.defineProperty(he,e,{value:Ls[e],writable:!1})});function zu(e){return["select","drag","readOnly"].includes(e)}function er(e,t){const{enableRuler:n,enableScale:o,enableScroll:i,enableSelect:a,enableTextEdit:s,enableDrag:r,enableInfo:c}=t.getSnapshot();i===!0?e.use(Is):i===!1&&e.disuse(Is),a===!0?(e.use(Es),e.use(Ms)):a===!1&&(e.disuse(Es),e.disuse(Ms)),o===!0?e.use(As):o===!1&&e.disuse(As),n===!0?e.use(Ps):n===!1&&e.disuse(Ps),s===!0?e.use(Ss):s===!1&&e.disuse(Ss),r===!0?e.use(Os):r===!1&&e.disuse(Os),c===!0?e.use(Rs):c===!1&&e.disuse(Rs)}function ba(e,t,n){let o=!1,i=!1,a=!1,s=!1,r=!1,c=!1;const d=!0;let u="select";n.set("mode",u),zu(e)?u=e:console.warn(`${e} is invalid mode of iDraw.js`),u==="select"?(o=!0,i=!0,a=!0,s=!0,r=!1,c=!0):u==="drag"?(o=!0,i=!0,a=!1,s=!1,r=!0,c=!0):u==="readOnly"&&(o=!1,i=!1,a=!1,s=!1,r=!1,c=!1),n.set("enableScale",o),n.set("enableScroll",i),n.set("enableSelect",a),n.set("enableTextEdit",s),n.set("enableDrag",r),n.set("enableRuler",c),n.set("enableInfo",d),er(t,n)}var Iu=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})},Ki=function(e,t,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},se=function(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)},no,ue,oo,Xt,tr,Sa;class Au{constructor(t,n){no.add(this),ue.set(this,void 0),oo.set(this,void 0),Xt.set(this,new Jt({defaultStorage:Eu()}));const o=Object.assign(Object.assign({},Su),n),{width:i,height:a,devicePixelRatio:s,createCustomContext2D:r}=o,c=new bu(t,{width:i,height:a,devicePixelRatio:s,createCustomContext2D:r});Ki(this,ue,c,"f"),Ki(this,oo,o,"f"),se(this,no,"m",tr).call(this)}reset(t){const n=se(this,ue,"f"),o=se(this,Xt,"f");o.clear(),ba(t.mode||xi,n,o),n.refresh(),Ki(this,oo,Object.assign(Object.assign({},se(this,oo,"f")),t),"f")}setMode(t){const n=se(this,ue,"f"),o=se(this,Xt,"f");ba(t||xi,n,o),n.refresh()}enable(t){se(this,no,"m",Sa).call(this,t,!0)}disable(t){se(this,no,"m",Sa).call(this,t,!1)}setData(t){const n=se(this,ue,"f");n.setData(t),n.trigger(he.change,{data:t,type:"setData"})}getData(t){const n=se(this,ue,"f").getData();return n&&(t==null?void 0:t.compact)===!0?ac(n,{loadItemMap:se(this,ue,"f").getLoadItemMap()}):n}getViewInfo(){return se(this,ue,"f").getViewInfo()}scale(t){se(this,ue,"f").scale(t)}setViewScale(t){const n=se(this,ue,"f");n.setViewScale(t),n.refresh()}centerContent(t){const n=(t==null?void 0:t.data)||se(this,ue,"f").getData(),{viewSizeInfo:o}=this.getViewInfo();if(n!=null&&n.layout||Array.isArray(n==null?void 0:n.elements)&&(n==null?void 0:n.elements.length)>0){const i=ld(n,{viewSizeInfo:o});this.setViewScale(i)}}resize(t){se(this,ue,"f").resize(t)}on(t,n){se(this,ue,"f").on(t,n)}off(t,n){se(this,ue,"f").off(t,n)}trigger(t,n){se(this,ue,"f").trigger(t,n)}selectElement(t){this.selectElements([t])}selectElements(t){this.trigger(he.select,{uuids:t})}selectElementByPosition(t){this.selectElementsByPositions([t])}selectElementsByPositions(t){this.trigger(he.select,{positions:t})}cancelElements(){this.trigger(he.select,{uuids:[]})}createElement(t,n){const{viewScaleInfo:o,viewSizeInfo:i}=se(this,ue,"f").getViewInfo();return id(t,(n==null?void 0:n.element)||{},(n==null?void 0:n.viewCenter)===!0?{viewScaleInfo:o,viewSizeInfo:i}:void 0)}updateElement(t){const n=se(this,ue,"f"),o=n.getData()||{elements:[]};Rt(t.uuid,t,o.elements),n.setData(o),n.refresh(),n.trigger(he.change,{data:o,type:"updateElement"})}addElement(t,n){var o;const i=se(this,ue,"f"),a=i.getData()||{elements:[]};if(!n||!(!((o=n==null?void 0:n.position)===null||o===void 0)&&o.length))a.elements.push(t);else if(n!=null&&n.position){const s=[...n==null?void 0:n.position];El(t,s,a.elements)}return i.setData(a),i.refresh(),i.trigger(he.change,{data:a,type:"addElement"}),a}deleteElement(t){const n=se(this,ue,"f"),o=n.getData()||{elements:[]};ad(t,o.elements),n.setData(o),n.refresh(),n.trigger(he.change,{data:o,type:"deleteElement"})}moveElement(t,n){const o=se(this,ue,"f"),i=o.getData()||{elements:[]},a=ct(t,i.elements),{elements:s}=pi(i.elements,{from:a,to:n});i.elements=s,o.setData(i),o.refresh(),o.trigger(he.change,{data:i,type:"moveElement"})}getImageBlobURL(t){return Iu(this,void 0,void 0,function*(){const n=this.getData()||{elements:[]},{devicePixelRatio:o}=t||{devicePixelRatio:1},i=vi(n.elements),{viewSizeInfo:a}=this.getViewInfo();return yield xu({width:i.w,height:i.h,devicePixelRatio:o,data:n,viewScaleInfo:{scale:1,offsetLeft:-i.x,offsetTop:-i.y,offsetBottom:0,offsetRight:0},viewSizeInfo:Object.assign(Object.assign({},a),{devicePixelRatio:o}),loadItemMap:se(this,ue,"f").getLoadItemMap()})})}isDestroyed(){return se(this,ue,"f").isDestroyed()}destroy(){const t=se(this,ue,"f"),n=se(this,Xt,"f");t.destroy(),n.destroy()}getViewCenter(){const{viewScaleInfo:t,viewSizeInfo:n}=this.getViewInfo();return rd({viewScaleInfo:t,viewSizeInfo:n})}$onBoardWatcherEvents(){se(this,ue,"f").onBoardWatcherEvents()}$offBoardWatcherEvents(){se(this,ue,"f").offBoardWatcherEvents()}}ue=new WeakMap,oo=new WeakMap,Xt=new WeakMap,no=new WeakSet,tr=function(){const t=se(this,ue,"f"),n=se(this,Xt,"f");ba("select",t,n)},Sa=function(t,n){const o=se(this,Xt,"f");if(["ruler","scroll","scale","info"].includes(t)){const i={ruler:"enableRuler",scroll:"enableScroll",scale:"enableScale",info:"enableInfo"};o.set(i[t],!!n),er(se(this,ue,"f"),o),se(this,ue,"f").refresh()}else t==="selectInGroup"?se(this,ue,"f").trigger(ua,{enable:!!n}):t==="snapToGrid"&&se(this,ue,"f").trigger(ha,{enable:!!n})};const Nu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}),l.createElement("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}))),qi="base-scale-selector",Du=e=>{const{className:t,style:n,defaultValue:o,value:i,onChange:a}=e,s=B(qi),r=B(qi,"menu-item"),c=B(qi,"input"),[d,u]=T.useState(100);T.useEffect(()=>{const g=ge(parseFloat(i||"1")*100);u(g)},[i]);const h=g=>{const{key:p}=g;a==null||a(p)},f=g=>{g.stopPropagation()},v={items:[{label:l.createElement("span",{className:r},l.createElement(ae,{className:c,size:"small",value:d,suffix:"%",onClick:f,step:1,min:10,max:1e4,controls:!1,onChange:g=>{if(g&&g>0){const p=ge(g/100);a==null||a(`${p}`)}}})),key:"custom"},...[.5,1,2,3].map(g=>({key:`${g}`,label:l.createElement("span",{className:r},`${ge(g*100)}%`)}))],onClick:h,selectedKeys:[`${i||o}`]};return T.useMemo(()=>l.createElement(Pn,{className:ce(s,t),menu:v},l.createElement(Oe,{icon:l.createElement(Nu,null),size:"small"},`${ge(parseFloat(i||"1")*100)}%`)),[t,n,o,i,a,d])},nr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M508 512m-112 0a112 112 0 1 0 224 0 112 112 0 1 0-224 0Z"}),l.createElement("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3-7.7 16.2-7.7 35.2 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM508 688c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z"}))),or=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M942.3 486.4l-0.1-0.1-0.1-0.1c-36.4-76.7-80-138.7-130.7-186L760.7 351c43.7 40.2 81.5 93.7 114.1 160.9C791.5 684.2 673.4 766 512 766c-51.3 0-98.3-8.3-141.2-25.1l-54.7 54.7C374.6 823.8 439.8 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0.1-51.3zM878.3 154.2l-42.4-42.4c-3.1-3.1-8.2-3.1-11.3 0L707.8 228.5C649.4 200.2 584.2 186 512 186c-192.2 0-335.4 100.5-430.2 300.3v0.1c-7.7 16.2-7.7 35.2 0 51.5 36.4 76.7 80 138.7 130.7 186.1L111.8 824.5c-3.1 3.1-3.1 8.2 0 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0l712.8-712.8c3.1-3 3.1-8.1 0-11.2zM398.9 537.4c-1.9-8.2-2.9-16.7-2.9-25.4 0-61.9 50.1-112 112-112 8.7 0 17.3 1 25.4 2.9L398.9 537.4z m184.5-184.5C560.5 342.1 535 336 508 336c-97.2 0-176 78.8-176 176 0 27 6.1 52.5 16.9 75.4L263.3 673c-43.7-40.2-81.5-93.7-114.1-160.9C232.6 339.8 350.7 258 512 258c51.3 0 98.3 8.3 141.2 25.1l-69.8 69.8z"}),l.createElement("path",{d:"M508 624c-6.4 0-12.7-0.5-18.8-1.6l-51.1 51.1c21.4 9.3 45.1 14.4 69.9 14.4 97.2 0 176-78.8 176-176 0-24.8-5.1-48.5-14.4-69.9l-51.1 51.1c1 6.1 1.6 12.4 1.6 18.8C620 573.9 569.9 624 508 624z"}))),ir=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"}))),ar=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}))),sr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M853.333333 170.666667H170.666667a42.666667 42.666667 0 0 0-42.666667 42.666666v128a42.666667 42.666667 0 0 0 85.333333 0V256h256v554.666667H384a42.666667 42.666667 0 0 0 0 85.333333h256a42.666667 42.666667 0 0 0 0-85.333333h-85.333333V256h256v85.333333a42.666667 42.666667 0 0 0 85.333333 0V213.333333a42.666667 42.666667 0 0 0-42.666667-42.666666z"}))),lr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M0.00592 521.157814v-103.646801l430.267025 235.101281c36.191582 13.567843 70.207188 15.615819 111.870706 0.191998l440.986902-258.365013v103.614802l-435.386966 258.877007c-42.175512 18.303788-91.326944 18.303788-126.398539 0L0.00592 521.157814z"}),l.createElement("path",{d:"M0.00592 743.651242v-104.798789l406.427301 221.43744c17.2798 9.439891 40.511532 17.599797 65.119247 20.383764h27.999676c32.511624-5.023942 47.103455-10.207882 67.615218-22.943735l415.931191-258.173014v98.974855l-430.875018 268.95689c-42.111513 17.439798-95.806892 18.079791-130.878487 0.575994L0.00592 743.619242zM20.069688 246.024995L399.073306 20.971598c41.279523-26.303696 90.430954-27.967677 133.342458-4.35195l421.083131 198.621703c35.743587 17.599797 37.18357 61.311291 2.655969 81.151062l-414.043212 226.205384a165.758083 165.758083 0 0 1-133.374458 4.415949L22.725657 327.208057C9.157814 318.664155 0.90191 303.56033 0.229917 285.000545c-0.607993-18.911781 10.719876-32.159628 19.807771-38.94355z"})," ")),rr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3-12.3 12.7-12.1 32.9 0.6 45.3l183.7 179.1-43.4 252.9c-1.2 6.9-0.1 14.1 3.2 20.3 8.2 15.6 27.6 21.7 43.2 13.4L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}))),cr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32z m-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792z m0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z"}),l.createElement("path",{d:"M304 456c48.6 0 88-39.4 88-88s-39.4-88-88-88-88 39.4-88 88 39.4 88 88 88z m0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}))),Tu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M256 682.666667a85.333333 85.333333 0 1 0 0 170.666666 85.333333 85.333333 0 0 0 0-170.666666z m-170.666667 85.333333a170.666667 170.666667 0 1 1 341.333334 0 170.666667 170.666667 0 0 1-341.333334 0zM768 170.666667a85.333333 85.333333 0 1 0 0 170.666666 85.333333 85.333333 0 0 0 0-170.666666z m-170.666667 85.333333a170.666667 170.666667 0 1 1 341.333334 0 170.666667 170.666667 0 0 1-341.333334 0z"}),l.createElement("path",{d:"M707.84 316.16a42.666667 42.666667 0 0 1 0 60.330667l-331.178667 331.178666a42.666667 42.666667 0 0 1-60.330666-60.330666l331.178666-331.178667a42.666667 42.666667 0 0 1 60.330667 0z"}))),dr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M145 96l66 746.6L511.8 928l299.6-85.4L878.7 96H145z m610.9 700.6l-244.1 69.6-245.2-69.6-56.7-641.2h603.8l-57.8 641.2z"}),l.createElement("path",{d:"M281 249l1.7 24.3 22.7 253.5h206.5v-0.1h112.9l-11.4 118.5L511 672.9v0.2h-0.8l-102.4-27.7-6.5-73.2h-91l11.3 144.7 188.6 52h1.7v-0.4l187.7-51.7 1.7-16.3 21.2-242.2 3.2-24.3H511v0.2H389.9l-8.2-94.2h352.1l1.7-19.5 4.8-47.2L742 249H511z"}))),Pu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-0.7 5.2-2L869 536.2c14.7-12.8 14.7-35.6 0-48.4z"}))),ur=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 0.3L512 465.6l-99.3-118.4-66.1-0.3c-4.4 0-8 3.5-8 8 0 1.9 0.7 3.7 1.9 5.2l130.1 155L340.5 670c-1.2 1.5-1.9 3.3-1.9 5.2 0 4.4 3.6 8 8 8l66.1-0.3L512 564.4l99.3 118.4 66 0.3c4.4 0 8-3.5 8-8 0-1.9-0.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}),l.createElement("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}))),Wt="node",Ou=e=>{const{className:t,style:n,type:o,uuid:i,nodeKey:a,title:s,position:r,parentModName:c,generateClassName:d,onTitleChange:u,onOperationToggle:h,onDelete:f,onSelect:m,onGoToGroup:v,operations:g,isSelected:p}=e,[S,E]=T.useState(!1),[w,y]=T.useState(!1),x=T.useRef(s),b=d(c,Wt),C=d(c,Wt,"icon"),z=d(c,Wt,"title"),L=d(c,Wt,"title","input"),N=d(c,Wt,"title","icon"),R=d(c,Wt,"action"),k=d(c,Wt,"selected"),_=T.useRef(0),$=T.useRef(null);T.useEffect(()=>{var M;S===!0&&((M=$.current)===null||M===void 0||M.focus())},[S]);const U=M=>{E(!1),u==null||u({uuid:a,value:M.target.value||""})},V=M=>{x.current=M.target.value||""},P=M=>{var O;M.code==="Enter"&&(E(!1),u==null||u({uuid:a,value:((O=M==null?void 0:M.target)===null||O===void 0?void 0:O.value)||""}))},W=M=>{M.stopPropagation(),M.preventDefault()},A=M=>{M.stopPropagation(),y(!0)},Y=M=>{M.stopPropagation(),y(!1)},G=M=>{const O=Date.now(),D=O-_.current;_.current=O,m==null||m({uuids:[i],positions:[r]}),D<=300&&D>0&&(M.stopPropagation(),M.preventDefault(),E(!0))},I=M=>{M.stopPropagation(),M.preventDefault(),f==null||f({uuid:a})},H=M=>{M.stopPropagation(),M.preventDefault(),h==null||h({uuid:a,operations:{invisible:!g.invisible}})},Z=M=>{M.stopPropagation(),M.preventDefault(),v==null||v({uuid:i,position:r})};return T.useMemo(()=>{x.current=s;function M(O){return O==="rect"?l.createElement(ir,{className:N}):O==="circle"?l.createElement(ar,{className:N}):O==="text"?l.createElement(sr,{className:N}):O==="path"?l.createElement(Tu,{className:N}):O==="image"?l.createElement(cr,{className:N}):O==="svg"?l.createElement(rr,{className:N}):O==="group"?l.createElement(lr,{className:N}):O==="html"?l.createElement(dr,{className:N}):l.createElement("span",{className:N})}return l.createElement("span",{key:a,style:n,className:ce(b,t,p?k:null),onClick:G,onMouseOver:A,onMouseLeave:Y},l.createElement("span",{className:z},M(o),l.createElement("span",null,s)),w&&l.createElement("span",{className:R},o==="group"&&l.createElement(Pu,{className:C,onClick:Z}),g.invisible?l.createElement(or,{className:C,onClick:H}):l.createElement(nr,{className:C,onClick:H}),l.createElement(ur,{className:C,onClick:I})),S&&l.createElement("span",{className:L},l.createElement(Lt,{ref:$,size:"small",defaultValue:s,onBlur:U,onClick:W,onKeyDown:P,onChange:V})))},[a,s,S,o,w,g,p])};function Ru(e,t){const n=[],{position:o}=t;if(Array.isArray(e)){const i=[...o];e.forEach((a,s)=>{i.push(s),n.push(hr(a,Object.assign(Object.assign({},t),{position:[...i]}))),i.pop()})}return n}const hr=(e,t)=>{const{parentModName:n,onTitleChange:o,onOperationToggle:i,onDelete:a,onSelect:s,onGoToGroup:r,position:c,selectedKeys:d}=t,u={key:e.key,title:l.createElement(Ou,{parentModName:n,uuid:e.key,title:e.title,position:c,operations:e.operations,nodeKey:e.key,type:e.type,generateClassName:t.generateClassName,onTitleChange:o,onOperationToggle:i,onDelete:a,onSelect:s,onGoToGroup:r,isSelected:d==null?void 0:d.includes(e.key)}),children:[]};if(Array.isArray(e.children)){const h=[...c];e.children.forEach((f,m)=>{h.push(m),u.children.push(hr(f,Object.assign(Object.assign({},t),{position:[...h]}))),h.pop()})}return u},Lu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"}),l.createElement("path",{d:"M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8C574.1 404.4 544.1 392 512 392z"}))),ku=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M264 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM760 654c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496zM904 794H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 370H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}))),ju=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M120 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM120 654h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM904 794H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 370H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}))),_u=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M904 158H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 582H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 794H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 370H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}))),Vu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16z m-52 268H212V212h200v200zM864 144H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16z m-52 268H612V212h200v200zM864 544H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16z m-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}))),Wu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M554.666667 469.333333v85.333334h-85.333334v-85.333334z m85.333333 0v85.333334h85.333333v-85.333334z m170.666667 0v85.333334h85.333333v-85.333334z m0 170.666667v85.333333h85.333333v-85.333333zM128 469.333333v85.333334h85.333333v-85.333334z m170.666667 0v85.333334h85.333333v-85.333334z m170.666666-341.333333v85.333333h85.333334V128z m170.666667 0v85.333333h85.333333V128z m170.666667 0v85.333333h85.333333V128z m0 170.666667v85.333333h85.333333v-85.333333zM128 640v85.333333h85.333333v-85.333333z m0-341.333333v85.333333h85.333333v-85.333333z m341.333333 341.333333v85.333333h85.333334v-85.333333z m0-341.333333v85.333333h85.333334v-85.333333zM128 128v85.333333h85.333333V128z m170.666667 0v85.333333h85.333333V128zM128 810.666667v85.333333h768v-85.333333z"}))),Bu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M592 928H432a48 48 0 1 0 0 96h160a48 48 0 1 0 0-96zM976 0H784a48 48 0 1 0 0 96h144v144.016a48 48 0 1 0 96 0V48a48 48 0 0 0-48-48zM240 928H96v-144a48 48 0 1 0-96 0v192a48 48 0 0 0 48 48h192a48 48 0 1 0 0-96zM48 640a48 48 0 0 0 48-48V432a48 48 0 1 0-96 0v160a48 48 0 0 0 48 48zM240 0H48a48 48 0 0 0-48 48v192a48 48 0 1 0 96 0V96h144a48 48 0 1 0 0-96z m784 592V432a48 48 0 1 0-96 0v160a48 48 0 1 0 96 0zM592 0H432a48 48 0 1 0 0 96h160a48 48 0 1 0 0-96z m384 736a48 48 0 0 0-48 48v144h-144a48 48 0 1 0 0 96h192a48 48 0 0 0 48-48V784a48 48 0 0 0-48-48z"}))),Fu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M554.666667 469.333333v85.333334h-85.333334v-85.333334z m85.333333 0v85.333334h85.333333v-85.333334z m170.666667 0v85.333334h85.333333v-85.333334z m0 170.666667v85.333333h85.333333v-85.333333z m-512-170.666667v85.333334h85.333333v-85.333334z m170.666666-341.333333v85.333333h85.333334V128z m170.666667 0v85.333333h85.333333V128z m170.666667 0v85.333333h85.333333V128z m0 170.666667v85.333333h85.333333v-85.333333zM469.333333 640v85.333333h85.333334v-85.333333z m0-341.333333v85.333333h85.333334v-85.333333zM128 128v768h85.333333V128z m170.666667 0v85.333333h85.333333V128z m170.666666 682.666667v85.333333h85.333334v-85.333333z m170.666667 0v85.333333h85.333333v-85.333333z m170.666667 0v85.333333h85.333333v-85.333333z m-512 0v85.333333h85.333333v-85.333333z"}))),Hu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M298.666667 896h85.333333v-85.333333h-85.333333v85.333333zM128 213.333333h85.333333V128H128v85.333333z m170.666667 0h85.333333V128h-85.333333v85.333333z m0 341.333334h85.333333v-85.333334h-85.333333v85.333334zM128 896h85.333333v-85.333333H128v85.333333z m341.333333 0h85.333334v-85.333333h-85.333334v85.333333zM128 554.666667h85.333333v-85.333334H128v85.333334z m0 170.666666h85.333333v-85.333333H128v85.333333z m0-341.333333h85.333333v-85.333333H128v85.333333z m341.333333 341.333333h85.333334v-85.333333h-85.333334v85.333333z m170.666667-170.666666h85.333333v-85.333334h-85.333333v85.333334z m170.666667-426.666667v768h85.333333V128h-85.333333z m-170.666667 768h85.333333v-85.333333h-85.333333v85.333333z m0-682.666667h85.333333V128h-85.333333v85.333333z m-170.666667 341.333334h85.333334v-85.333334h-85.333334v85.333334z m0-341.333334h85.333334V128h-85.333334v85.333333z m0 170.666667h85.333334v-85.333333h-85.333334v85.333333z"}))),Gu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M298.666667 896h85.333333v-85.333333h-85.333333v85.333333z m0-341.333333h85.333333v-85.333334h-85.333333v85.333334z m170.666666 0h85.333334v-85.333334h-85.333334v85.333334z m0 341.333333h85.333334v-85.333333h-85.333334v85.333333zM128 725.333333h85.333333v-85.333333H128v85.333333z m0 170.666667h85.333333v-85.333333H128v85.333333z m0-341.333333h85.333333v-85.333334H128v85.333334z m0-170.666667h85.333333v-85.333333H128v85.333333z m341.333333 341.333333h85.333334v-85.333333h-85.333334v85.333333z m341.333334-341.333333h85.333333v-85.333333h-85.333333v85.333333z m0 170.666667h85.333333v-85.333334h-85.333333v85.333334zM128 128v85.333333h768V128H128z m682.666667 597.333333h85.333333v-85.333333h-85.333333v85.333333z m-170.666667 170.666667h85.333333v-85.333333h-85.333333v85.333333z m-170.666667-512h85.333334v-85.333333h-85.333334v85.333333z m341.333334 512h85.333333v-85.333333h-85.333333v85.333333z m-170.666667-341.333333h85.333333v-85.333334h-85.333333v85.333334z"}))),Yu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M341.333333 512a42.666667 42.666667 0 0 0 42.666667 42.666667h256a42.666667 42.666667 0 0 0 0-85.333334H384a42.666667 42.666667 0 0 0-42.666667 42.666667z"}),l.createElement("path",{d:"M384 682.666667H307.626667A176.213333 176.213333 0 0 1 128 527.786667 170.666667 170.666667 0 0 1 298.666667 341.333333h85.333333a42.666667 42.666667 0 0 0 0-85.333333H307.626667a262.4 262.4 0 0 0-262.826667 222.293333A256 256 0 0 0 298.666667 768h85.333333a42.666667 42.666667 0 0 0 0-85.333333zM981.333333 479.573333A262.826667 262.826667 0 0 0 715.093333 256h-64.426666C616.106667 256 597.333333 275.2 597.333333 298.666667a42.666667 42.666667 0 0 0 42.666667 42.666666h76.373333A176.213333 176.213333 0 0 1 896 496.213333 170.666667 170.666667 0 0 1 725.333333 682.666667h-85.333333a42.666667 42.666667 0 0 0 0 85.333333h85.333333a256 256 0 0 0 256-288.426667z"}))),$u=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M712 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM714 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM136 374h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM136 200h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM888 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 650h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 476h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 302h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM540 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM310 200h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM540 824H358c-87.3 0-158-70.7-158-158V484c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v182c0 127 103 230 230 230h182c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}))),Xu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M368 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM310 200h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM888 302h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 650h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 476h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 302h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM484 200h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM658 200h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM888 476h-56c-4.4 0-8 3.6-8 8v182c0 87.3-70.7 158-158 158H484c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h182c127 0 230-103 230-230V484c0-4.4-3.6-8-8-8z"}))),Uu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M656 200h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM714 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 650h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 302h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 476h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 650h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM540 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM366 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM540 128H358c-127 0-230 103-230 230v182c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V358c0-87.3 70.7-158 158-158h182c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}))),Zu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M368 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM366 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 650h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM888 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 128h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 302h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 476h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 650h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM192 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM540 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM714 824h-56c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM666 128H484c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h182c87.3 0 158 70.7 158 158v182c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V358c0-127-103-230-230-230z"}))),ks=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M896 810.666667v85.333333h-85.333333v-85.333333h85.333333z m-170.666667 0v85.333333h-85.333333v-85.333333h85.333333z m-170.666666 0v85.333333h-85.333334v-85.333333h85.333334z m-170.666667 0v85.333333H298.666667v-85.333333h85.333333z m-170.666667 0v85.333333H128v-85.333333h85.333333z m682.666667-170.666667v85.333333h-85.333333v-85.333333h85.333333zM213.333333 640v85.333333H128v-85.333333h85.333333z m0-170.666667v85.333334H128v-85.333334h85.333333z m469.333334-341.333333a213.418667 213.418667 0 0 1 213.12 204.074667L896 341.333333v213.333334h-85.333333V341.333333a128.426667 128.426667 0 0 0-120.490667-127.786666L682.666667 213.333333h-213.333334V128h213.333334zM213.333333 298.666667v85.333333H128V298.666667h85.333333z m0-170.666667v85.333333H128V128h85.333333z m170.666667 0v85.333333H298.666667V128h85.333333z"}))),Qu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72z"}),l.createElement("path",{d:"M864 256H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}))),Ju=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M510.762667 970.666667A458.666667 458.666667 0 1 1 969.429333 512a459.178667 459.178667 0 0 1-458.666666 458.666667z m0-853.333334a394.666667 394.666667 0 1 0 394.666666 394.666667 395.093333 395.093333 0 0 0-394.666666-394.666667z"}),l.createElement("path",{d:"M512 724.48A212.48 212.48 0 1 1 724.48 512 212.736 212.736 0 0 1 512 724.48z m0-360.96A148.48 148.48 0 1 0 660.48 512 148.608 148.608 0 0 0 512 363.52z"}))),fr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M272.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512z"}),l.createElement("path",{d:"M576.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"}))),Di=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3 0.1-12.7-6.4-12.7z"}))),Ku=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M841.065412 337.317647v352.015059c0 46.802824-23.070118 74.752-39.936 95.111529-14.095059 17.106824-21.443765 26.684235-21.443765 41.803294V933.647059a30.117647 30.117647 0 0 1-60.235294 0v-107.39953c0-37.526588 19.576471-61.199059 35.297882-80.173176 14.576941-17.648941 26.142118-31.563294 26.142118-56.681412V337.317647c0-18.793412-16.143059-36.502588-33.189647-36.502588-19.817412 0-24.033882 3.072-24.214588 3.19247-3.975529 5.360941-3.855059 34.273882-3.794824 57.584942 0.060235 11.384471 0.120471 24.094118-0.12047 38.068705-0.240941 16.504471-12.830118 28.792471-30.358589 29.696a30.117647 30.117647 0 0 1-29.876706-30.117647v-127.698823c0-18.492235-13.372235-32.406588-31.081411-32.406588-16.263529 0-28.190118 12.107294-29.635765 29.394823v120.651294a30.117647 30.117647 0 0 1-60.235294 0V268.047059l-0.120471-0.602353v-46.561882c0-3.975529-0.843294-38.671059-28.551529-38.671059-27.105882 0-31.201882 24.214588-31.201883 38.671059v42.345411c0 1.686588-0.662588 3.252706-0.963764 4.879059v156.250353a30.117647 30.117647 0 0 1-60.235294 0V262.686118c-2.891294-11.685647-11.324235-23.491765-28.069647-23.491765-17.227294 0-31.744 15.721412-31.744 34.334118v201.788235c0 0.421647-0.361412 0.783059-0.361412 1.204706v66.319059a30.117647 30.117647 0 0 1-60.235294 0v-50.236236c-10.601412-3.855059-25.961412-6.987294-34.755765-4.999529-7.107765 1.385412-14.275765 7.649882-18.733176 16.323765a43.309176 43.309176 0 0 0-0.542118 38.369882L345.148235 766.192941a31.563294 31.563294 0 0 1 2.108236 6.505412 32.888471 32.888471 0 0 0 35.418353 25.961412 30.238118 30.238118 0 0 1 33.310117 29.936941V933.647059a30.117647 30.117647 0 0 1-60.235294 0v-77.462588a92.521412 92.521412 0 0 1-66.680471-67.764706L187.934118 567.055059a104.448 104.448 0 0 1 1.927529-90.774588c12.890353-24.877176 35.418353-42.706824 60.295529-47.766589 12.649412-2.590118 29.756235-1.867294 46.682353 1.566118v-43.369412c0-0.602353 0.301176-1.144471 0.361412-1.746823v-111.435294c0-52.163765 41.321412-94.569412 91.979294-94.569412 12.047059 0 23.612235 2.409412 34.093177 6.746353 11.986824-38.791529 44.152471-63.668706 86.317176-63.668706 40.237176 0 71.800471 25.419294 83.666824 63.909647 10.721882-4.517647 22.467765-6.987294 34.876235-6.987294 41.502118 0 75.776 26.744471 87.160471 64.572235 11.023059-2.409412 22.226824-2.951529 32.286117-2.951529 50.718118 0 93.485176 44.272941 93.485177 96.737882z"}))),qu=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326z m1.8 562H232V136h302v216c0 23.2 18.8 42 42 42h216v494z"}))),e0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326z m1.8 562H232V136h302v216c0 23.2 18.8 42 42 42h216v494z"}),l.createElement("path",{d:"M544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z"}))),t0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M170.666667 298.666667a42.666667 42.666667 0 1 1-85.333334 0V256a170.666667 170.666667 0 0 1 170.666667-170.666667h42.666667a42.666667 42.666667 0 1 1 0 85.333334H256a85.333333 85.333333 0 0 0-85.333333 85.333333v42.666667z m554.666666-128a42.666667 42.666667 0 0 1 0-85.333334h42.666667a170.666667 170.666667 0 0 1 170.666667 170.666667v42.666667a42.666667 42.666667 0 0 1-85.333334 0V256a85.333333 85.333333 0 0 0-85.333333-85.333333h-42.666667z m128 554.666666a42.666667 42.666667 0 0 1 85.333334 0v42.666667a170.666667 170.666667 0 0 1-170.666667 170.666667h-42.666667a42.666667 42.666667 0 0 1 0-85.333334h42.666667a85.333333 85.333333 0 0 0 85.333333-85.333333v-42.666667zM298.666667 853.333333a42.666667 42.666667 0 0 1 0 85.333334H256a170.666667 170.666667 0 0 1-170.666667-170.666667v-42.666667a42.666667 42.666667 0 0 1 85.333334 0v42.666667a85.333333 85.333333 0 0 0 85.333333 85.333333h42.666667z"}))),n0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M118.979048 637.074286l137.99619 66.243047 255.171048 123.587048 246.076952-119.222857 147.163429-70.485334a73.142857 73.142857 0 0 1-34.230857 97.109334l-327.119239 158.427428a73.142857 73.142857 0 0 1-63.780571 0L153.136762 734.305524A73.142857 73.142857 0 0 1 118.979048 637.074286z m786.090666-153.063619a73.142857 73.142857 0 0 1-33.913904 97.767619L544.01219 740.205714a73.142857 73.142857 0 0 1-63.780571 0L153.136762 581.778286A73.142857 73.142857 0 0 1 117.51619 487.862857l362.300953 170.886095 32.329143 15.652572 327.119238-158.427429 65.80419-31.939047zM544.036571 139.190857l327.094858 158.403048a73.142857 73.142857 0 0 1 0 131.657143l-327.094858 158.427428a73.142857 73.142857 0 0 1-63.780571 0L153.136762 429.251048a73.142857 73.142857 0 0 1 0-131.657143L480.256 139.215238a73.142857 73.142857 0 0 1 63.780571 0z m-31.890285 65.828572L185.027048 363.422476l327.119238 158.427429 327.119238-158.427429L512.146286 205.04381z"}))),o0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-696 72h136v656H184V184z m656 656H384V384h456v456zM384 320V184h456v136H384z"}))),mr=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8c-16.4 12.8-16.4 37.5 0 50.3l450.8 352.1c5.3 4.1 12.9 0.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}))),i0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M512 42.666667a469.333333 469.333333 0 1 0 469.333333 469.333333A469.333333 469.333333 0 0 0 512 42.666667z m0 864a394.666667 394.666667 0 1 1 394.666667-394.666667 395.146667 395.146667 0 0 1-394.666667 394.666667z"}),l.createElement("path",{d:"M304.906667 512m-66.666667 0a66.666667 66.666667 0 1 0 133.333333 0 66.666667 66.666667 0 1 0-133.333333 0Z"}),l.createElement("path",{d:"M512 512m-66.666667 0a66.666667 66.666667 0 1 0 133.333334 0 66.666667 66.666667 0 1 0-133.333334 0Z"}),l.createElement("path",{d:"M719.093333 512m-66.666666 0a66.666667 66.666667 0 1 0 133.333333 0 66.666667 66.666667 0 1 0-133.333333 0Z"}))),a0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M935.253333 111.786667a42.666667 42.666667 0 0 0-23.04-23.04A42.666667 42.666667 0 0 0 896 85.333333h-256a42.666667 42.666667 0 0 0 0 85.333334h153.173333L170.666667 793.173333V640a42.666667 42.666667 0 0 0-85.333334 0v256a42.666667 42.666667 0 0 0 3.413334 16.213333 42.666667 42.666667 0 0 0 23.04 23.04A42.666667 42.666667 0 0 0 128 938.666667h256a42.666667 42.666667 0 0 0 0-85.333334H230.826667L853.333333 230.826667V384a42.666667 42.666667 0 0 0 85.333334 0V128a42.666667 42.666667 0 0 0-3.413334-16.213333z"}))),s0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M128 128h64v389.312A384.32 384.32 0 0 1 506.688 832H896v64H192a64 64 0 0 1-64-64V128z m313.6 704A320.384 320.384 0 0 0 192 582.4V832h249.6z"}))),l0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M929.19 352.19c3.12 3.12 3.12 8.19 0 11.31L363.51 929.19c-3.12 3.12-8.19 3.12-11.31 0L94.81 671.81c-3.12-3.12-3.12-8.19 0-11.31L660.49 94.81c3.12-3.12 8.19-3.12 11.31 0l257.39 257.38z m-424.26 5.66l108.89 108.89c3.12 3.12 3.12 8.19 0 11.31l-36.77 36.77c-3.12 3.12-8.19 3.12-11.31 0L456.85 405.93l-50.91 50.91 62.23 62.23c3.12 3.12 3.12 8.19 0 11.31l-36.77 36.77c-3.12 3.12-8.19 3.12-11.31 0l-62.23-62.23-50.91 50.91 62.23 62.23c3.12 3.12 3.12 8.19 0 11.31l-36.77 36.77c-3.12 3.12-8.19 3.12-11.31 0l-62.23-62.23-62.23 62.23 161.22 161.22 469.52-469.52-161.23-161.21-62.23 62.23 62.23 62.23c3.12 3.12 3.12 8.19 0 11.31l-36.77 36.77c-3.12 3.12-8.19 3.12-11.31 0l-62.23-62.23-50.91 50.91z"}))),r0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M725.333333 341.333333a128 128 0 1 1 128-128 128 128 0 0 1-128 128z m0-170.666666a42.666667 42.666667 0 1 0 42.666667 42.666666 42.666667 42.666667 0 0 0-42.666667-42.666666z"}),l.createElement("path",{d:"M640 256H85.333333a42.666667 42.666667 0 0 1 0-85.333333h554.666667a42.666667 42.666667 0 0 1 0 85.333333zM938.666667 256h-128a42.666667 42.666667 0 0 1 0-85.333333h128a42.666667 42.666667 0 0 1 0 85.333333zM512 640a128 128 0 1 1 128-128 128 128 0 0 1-128 128z m0-170.666667a42.666667 42.666667 0 1 0 42.666667 42.666667 42.666667 42.666667 0 0 0-42.666667-42.666667z"}),l.createElement("path",{d:"M426.666667 554.666667H85.333333a42.666667 42.666667 0 0 1 0-85.333334h341.333334a42.666667 42.666667 0 0 1 0 85.333334zM938.666667 554.666667h-341.333334a42.666667 42.666667 0 0 1 0-85.333334h341.333334a42.666667 42.666667 0 0 1 0 85.333334zM298.666667 938.666667a128 128 0 1 1 128-128 128 128 0 0 1-128 128z m0-170.666667a42.666667 42.666667 0 1 0 42.666666 42.666667 42.666667 42.666667 0 0 0-42.666666-42.666667z"}),l.createElement("path",{d:"M938.666667 853.333333H384a42.666667 42.666667 0 0 1 0-85.333333h554.666667a42.666667 42.666667 0 0 1 0 85.333333zM213.333333 853.333333H85.333333a42.666667 42.666667 0 0 1 0-85.333333h128a42.666667 42.666667 0 0 1 0 85.333333z"}))),c0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M802.742857 777.485714c49.942857 0 90.742857-41.371429 90.742857-92 0-61.142857-90.742857-160.914286-90.742857-160.914285S712 624.342857 712 685.485714c0 50.628571 40.8 92 90.742857 92z m-430.971428-50.4c8.114286 8.114286 21.257143 8.114286 29.257142 0l292.685715-292.571428c8.114286-8.114286 8.114286-21.257143 0-29.257143l-292.571429-292.571429c-0.685714-0.685714-1.485714-1.371429-2.285714-1.942857l-89.371429-89.371428a10.411429 10.411429 0 0 0-14.628571 0l-54.857143 54.857142a10.411429 10.411429 0 0 0 0 14.628572l76.8 76.8-237.485714 237.6c-8.114286 8.114286-8.114286 21.257143 0 29.257143l292.457143 292.571428z m14.742857-512.685714l204.457143 204.457143H182.171429l204.342857-204.457143zM960 859.428571H64c-5.028571 0-9.142857 4.114286-9.142857 9.142858v91.428571c0 5.028571 4.114286 9.142857 9.142857 9.142857h896c5.028571 0 9.142857-4.114286 9.142857-9.142857v-91.428571c0-5.028571-4.114286-9.142857-9.142857-9.142858z"}))),d0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669c3.2 4.1 9.4 4.1 12.6 0l112-141.7c4.1-5.2 0.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}))),u0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M859.9 474H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM506.3 399.3c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7 0.4-11.7-5.7-11.7H550V104c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v156h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.6zM517.7 624.7c-2.9-3.7-8.5-3.7-11.3 0L405.6 752.3c-3.7 4.7-0.4 11.7 5.7 11.7H474v156c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V764h62.8c6 0 9.4-7 5.7-11.7L517.7 624.7z"}))),h0=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355c-3.2-4.1-9.4-4.1-12.6 0l-112 141.7c-4.1 5.2-0.4 12.9 6.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"}))),{DirectoryTree:f0}=Qs,js="base-element-tree",ea=e=>{const t=e.split("-").map(n=>parseInt(n));return t.shift(),t},gr=l.forwardRef((e,t)=>{const{height:n,className:o,style:i,treeData:a,onTitleChange:s,onOperationToggle:r,onSelect:c,selectedKeys:d,onDrop:u,defaultExpandedKeys:h,onDelete:f,onExpand:m,onGoToGroup:v}=e,g=(S,E)=>{const y=[ea(E.node.pos)],x=[S[0]];c==null||c({uuids:x,positions:y})},p=({uuid:S})=>{f==null||f({uuid:S})};return T.useMemo(()=>{const S=Ru(a||[],{parentModName:js,generateClassName:B,onTitleChange:s,onOperationToggle:r,onDelete:p,onGoToGroup:v,position:[],selectedKeys:d||[]});return l.createElement(f0,{ref:t,height:n,style:i,className:ce(B(js),o),showLine:!0,blockNode:!0,selectedKeys:d,switcherIcon:l.createElement(Di,null),icon:null,onSelect:g,treeData:S,defaultExpandedKeys:h,onExpand:m,draggable:{icon:!1,nodeDraggable:()=>!0},onDrop:E=>{const{dragNode:w,node:y,dropToGap:x,dropPosition:b}=E,C=ea(w.pos),z=ea(y.pos);x===!0&&b>=0?z[z.length-1]=b:y.dragOverGapBottom===!0?z[z.length-1]=z[z.length-1]+1:y.dragOverGapTop===!0?z[z.length-1]=Math.max(0,z[z.length-1]-1):y.dragOver===!0&&z.push(0),u==null||u({from:C,to:z})}})},[o,i,g,a,d])}),Bt="node",m0=e=>{const{className:t,style:n,type:o,uuid:i,nodeKey:a,title:s,position:r,parentModName:c,generateClassName:d,onTitleChange:u,onOperationToggle:h,onDelete:f,onSelect:m,operations:v,isSelected:g}=e,[p,S]=T.useState(!1),[E,w]=T.useState(!1),y=T.useRef(s),x=d(c,Bt),b=d(c,Bt,"icon"),C=d(c,Bt,"title"),z=d(c,Bt,"title","input"),L=d(c,Bt,"title","icon"),N=d(c,Bt,"action"),R=d(c,Bt,"selected"),k=T.useRef(0),_=T.useRef(null);T.useEffect(()=>{var H;p===!0&&((H=_.current)===null||H===void 0||H.focus())},[p]);const $=H=>{S(!1),u==null||u({uuid:a,value:H.target.value||""})},U=H=>{y.current=H.target.value||""},V=H=>{var Z;H.code==="Enter"&&(S(!1),u==null||u({uuid:a,value:((Z=H==null?void 0:H.target)===null||Z===void 0?void 0:Z.value)||""}))},P=H=>{H.stopPropagation(),H.preventDefault()},W=H=>{H.stopPropagation(),w(!0)},A=H=>{H.stopPropagation(),w(!1)},Y=H=>{const Z=Date.now(),M=Z-k.current;k.current=Z,m==null||m({uuids:[i],positions:[r]}),M<=300&&M>0&&(H.stopPropagation(),H.preventDefault(),S(!0))},G=H=>{H.stopPropagation(),H.preventDefault(),f==null||f({uuid:a})},I=H=>{H.stopPropagation(),H.preventDefault(),h==null||h({uuid:a,operations:{invisible:!v.invisible}})};return T.useMemo(()=>(y.current=s,l.createElement("span",{key:a,style:n,className:ce(x,t,g?R:null),onClick:Y,onMouseOver:W,onMouseLeave:A},l.createElement("span",{className:C},l.createElement(qu,{className:L}),l.createElement("span",null,s)),E&&l.createElement("span",{className:N},v.invisible?l.createElement(or,{className:b,onClick:I}):l.createElement(nr,{className:b,onClick:I}),l.createElement(ur,{className:b,onClick:G})),p&&l.createElement("span",{className:z},l.createElement(Lt,{ref:_,size:"small",defaultValue:s,onBlur:$,onClick:P,onKeyDown:V,onChange:U})))),[a,s,p,o,E,v,g])};function g0(e,t){const n=[],{position:o}=t;if(Array.isArray(e)){const i=[...o];e.forEach((a,s)=>{i.push(s),n.push(v0(a,Object.assign(Object.assign({},t),{position:[...i]}))),i.pop()})}return n}const v0=(e,t)=>{const{parentModName:n,onTitleChange:o,onOperationToggle:i,onDelete:a,onSelect:s,position:r,selectedKeys:c}=t;return{key:e.key,title:l.createElement(m0,{parentModName:n,uuid:e.key,title:e.title,position:r,operations:e.operations,nodeKey:e.key,type:e.type,generateClassName:t.generateClassName,onTitleChange:o,onOperationToggle:i,onDelete:a,onSelect:s,isSelected:c==null?void 0:c.includes(e.key)})}},{DirectoryTree:p0}=Qs,_s="base-page-tree",ta=e=>{const t=e.split("-").map(n=>parseInt(n));return t.shift(),t},y0=l.forwardRef((e,t)=>{const{height:n,className:o,style:i,treeData:a,onTitleChange:s,onOperationToggle:r,onSelect:c,selectedKeys:d,onDrop:u,defaultExpandedKeys:h,expandedKeys:f,onDelete:m}=e,v=(p,S)=>{const w=[ta(S.node.pos)],y=[p[0]];c==null||c({uuids:y,positions:w})},g=({uuid:p})=>{m==null||m({uuid:p})};return T.useMemo(()=>{const p=g0(a||[],{parentModName:_s,generateClassName:B,onTitleChange:s,onOperationToggle:r,onDelete:g,position:[],selectedKeys:d||[]});return l.createElement(p0,{ref:t,height:n,style:i,className:ce(B(_s),o),showLine:!0,blockNode:!0,multiple:!0,selectedKeys:d,switcherIcon:l.createElement(Di,null),icon:null,onSelect:v,treeData:p,defaultExpandedKeys:h,expandedKeys:f,draggable:{icon:!1,nodeDraggable:()=>!0},onDrop:S=>{const{dragNode:E,node:w,dropToGap:y,dropPosition:x}=S,b=ta(E.pos),C=ta(w.pos);y===!0&&x>=0?C[C.length-1]=x:w.dragOverGapBottom===!0?C[C.length-1]=C[C.length-1]+1:w.dragOverGapTop===!0?C[C.length-1]=Math.max(0,C[C.length-1]-1):w.dragOver===!0&&C.push(0),u==null||u({from:b,to:C})}})},[o,i,v,a,d])});var w0=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};const b0=e=>{const{value:t,onChange:n}=e,o=w0(e,["value","onChange"]),i=s=>{n==null||n(s)},a=()=>{i(!t)};return l.createElement(Oe,Object.assign({},o,{type:t?"primary":"default",onClick:a}))},S0="ElementDetail",kt=()=>{const[e]=el(S0);return e},Fn="base-element-basic-attribute",zt=e=>Se.number(e*1)?ge(e*1):e,Vs=e=>{if(Se.number(e*1)){const t=ge(e*1);return lt(t)}return e},E0=e=>{const{className:t,style:n,element:o,onChange:i,disabled:a}=e,s=T.useRef(null),r=B(Fn),c=B(Fn,"row"),d=B(Fn,"col"),u=B(Fn,"input"),h=B(Fn,"form-item"),f=kt(),m=v=>{var g;((g=o==null?void 0:o.operations)===null||g===void 0?void 0:g.limitRatio)===!0&&(v!=null&&v.hasOwnProperty("w")?v.h=ge(v.w/o.w*o.h):v!=null&&v.hasOwnProperty("h")&&(v.w=ge(v.h/o.h*o.w))),i==null||i(v)};return T.useEffect(()=>{var v;const{type:g,x:p,y:S,w:E,h:w,angle:y=0,operations:x={}}=o||{},b={x:p,y:S,w:E,h:w,angle:y,operations:{limitRatio:x.limitRatio}};g==="group"&&(b.operations.deepResize=x.deepResize),(v=s.current)===null||v===void 0||v.setFieldsValue(b)},[o]),T.useMemo(()=>l.createElement(J,{ref:s,style:n,className:ce(r,t),onValuesChange:m},l.createElement(re,{className:c},l.createElement(Q,{span:10,className:d},l.createElement(J.Item,{className:h,name:"x"},l.createElement(ae,{className:u,size:"small",placeholder:"X",prefix:"X",disabled:a,formatter:zt,parser:zt}))),l.createElement(Q,{span:10,className:d},l.createElement(J.Item,{className:h,name:"y"},l.createElement(ae,{className:u,size:"small",placeholder:"Y",prefix:"Y",disabled:a,formatter:zt,parser:zt})))),l.createElement(re,{className:c},l.createElement(Q,{span:10,className:d},l.createElement(J.Item,{className:h,name:"w"},l.createElement(ae,{className:u,size:"small",placeholder:"Width",prefix:f.w,disabled:a,formatter:zt,parser:zt}))),l.createElement(Q,{span:10,className:d},l.createElement(J.Item,{className:h,name:"h"},l.createElement(ae,{className:u,size:"small",placeholder:"Height",prefix:f.h,disabled:a,formatter:zt,parser:zt}))),l.createElement(Q,{span:4,className:d},l.createElement(J.Item,{className:h,name:["operations","limitRatio"]},l.createElement(b0,{icon:l.createElement(Yu,null),size:"small",disabled:a})))),l.createElement(re,{className:c},l.createElement(Q,{span:10,className:d},l.createElement(J.Item,{className:h,name:"angle"},l.createElement(ae,{className:u,size:"small",placeholder:"Angle",prefix:l.createElement(s0,{style:{fontSize:14}}),disabled:a,formatter:Vs,parser:Vs,suffix:"°"})))),(o==null?void 0:o.type)==="group"&&l.createElement(re,{className:c},l.createElement(Q,{span:18,className:d},f.deepResizeInGroup),l.createElement(Q,{span:6,className:d},l.createElement(J.Item,{className:h,name:["operations","deepResize"]},l.createElement(Zs,{size:"small"}))))),[f,a,o])},M0=({value:e="",onChange:t,className:n})=>l.createElement(Ir,{className:n,value:new Ar(e),onChange:o=>{const i=`#${o.toHex8().toUpperCase()}`,a=i.endsWith("FF")?`#${o.toHex().toUpperCase()}`:i;t==null||t(a)}}),Ye="base-element-field-multiple-color-picker",vr=16,Ws=e=>{var t,n;const o=(t=e.currentTarget.parentElement)===null||t===void 0?void 0:t.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),a=e.clientX-o.x-vr/2;let s=parseFloat((n=a/i.width)===null||n===void 0?void 0:n.toFixed(2));return s=Math.min(Math.max(s,0),1),s};function x0(e){const{mode:t,value:n,internalColor:o,internalLinearGradient:i,internalRadialGradient:a,currentPickedColor:s,onChange:r,onSelectStop:c}=e,[d,u]=T.useState(fi(n)),[h,f]=T.useState(null),m=T.useRef(!1),v=B(Ye,"gradient-root"),g=B(Ye,"gradient-delete"),p=B(Ye,"gradient"),S=B(Ye,"gradient-bar"),E=B(Ye,"gradient-point"),w=B(Ye,"gradient-point-active");T.useEffect(()=>{var N;const R=fi(n);u(R),["linear-gradient","radial-gradient"].includes(n==null?void 0:n.type)&&(h||f((N=n==null?void 0:n.stops)===null||N===void 0?void 0:N[0]))},[n]),T.useEffect(()=>{h?c==null||c(Object.assign({},h)):c==null||c(h)},[h]);const y=N=>{N.stopPropagation(),m.current=!0;const R=Ws(N);let k=null;if(t==="linear-gradient"?k=i:t==="radial-gradient"&&(k=a),k){const _=[...k.stops];for(let U=0;U<_.length;U++){const V=_[U],P=_[U+1],W={offset:R,color:s};if(V.offset===R)break;if(R<V.offset){_.unshift(W),f(W);break}else if(V.offset<R&&R<(P==null?void 0:P.offset)){_.splice(U+1,0,W),f(W);break}else if(R>V.offset&&!P){_.push(W),f(W);break}if(!P)break}const $=Object.assign(Object.assign({},k),{stops:_});r==null||r($)}},x=N=>{if(m.current===!0&&h){const R=Ws(N);let k=null;if(t==="linear-gradient"?k=i:t==="radial-gradient"&&(k=a),k){const _=[...k.stops];for(let V=0;V<_.length;V++){const P=_[V];if(P.offset===h.offset){P.offset=R,f(Object.assign({},P));break}}const $=_.sort((V,P)=>V.offset-P.offset),U=Object.assign(Object.assign({},k),{stops:$});r==null||r(U)}}},b=N=>{N.stopPropagation(),m.current=!1},C=(N,R)=>{N.stopPropagation(),f(R),m.current=!0},z=()=>{let N=null;t==="linear-gradient"?N=i:t==="radial-gradient"&&(N=a);let R=-1;if(N&&h){const k=[...N.stops];for(let _=0;_<k.length;_++)if(k[_].offset===h.offset){R=_;break}if(R>=0){k.splice(R,1);const _=Object.assign(Object.assign({},N),{stops:k});r==null||r(_)}}},L=()=>{m.current=!1};return T.useMemo(()=>{var N,R,k;return l.createElement(l.Fragment,null,(t==="linear-gradient"||t==="radial-gradient")&&l.createElement("div",{className:v},l.createElement("div",{className:p,"data-css":d,style:{background:d}},l.createElement("div",{className:S,onMouseDown:y,onMouseUp:b,onMouseMove:x,onMouseLeave:b},(k=(R=(N=t==="linear-gradient"?i:a)===null||N===void 0?void 0:N.stops)===null||R===void 0?void 0:R.map)===null||k===void 0?void 0:k.call(R,(_,$)=>l.createElement("span",{key:$,className:ce({[E]:!0,[w]:(h==null?void 0:h.offset)===_.offset}),style:{left:`calc(${_.offset*100}% - ${vr/2}px)`,background:_.color},onMouseDown:U=>{C(U,_)},onMouseUp:L})))),l.createElement("div",{className:g,onClick:_=>{_.stopPropagation(),z()}},l.createElement(Qu,null))))},[t,d,s,o,i,a,h])}function Bs(e){let t="solid";return e&&(e!=null&&e.type)&&(t=e.type),t}function C0(e){const{className:t,value:n,onChange:o,elementSize:i,disabledLinearGradient:a,disabledRadialGradient:s}=e,[r,c]=T.useState(fi(n)),[d,u]=T.useState(Bs(n)),[h,f]=T.useState("#000000"),[m,v]=T.useState(null),[g,p]=T.useState(null),[S,E]=T.useState(null),w=T.useRef(null),y=T.useRef(null),x=T.useRef(null),b=B(Ye),C=B(Ye,"header"),z=B(Ye,"internal-picker"),L=B(Ye,"radio-group"),N=B(Ye,"row"),R=B(Ye,"col"),k=B(Ye,"input"),_=B(Ye,"form-item");T.useEffect(()=>{c(fi(n)),u(Bs(n)),typeof n=="string"?(v(n),f(n)):(n==null?void 0:n.type)==="linear-gradient"?p(n):(n==null?void 0:n.type)==="radial-gradient"&&E(n)},[n]),T.useEffect(()=>{var W,A;d==="linear-gradient"&&(n==null?void 0:n.type)===d?(W=y.current)===null||W===void 0||W.setFieldsValue(n):d==="radial-gradient"&&(n==null?void 0:n.type)===d&&((A=x.current)===null||A===void 0||A.setFieldsValue(n))},[d,n]);const $=W=>{var A,Y,G,I,H,Z;let M;W==="linear-gradient"?(M={type:"linear-gradient",start:{x:0,y:0},end:{x:0,y:(i==null?void 0:i.h)||0},stops:[]},typeof n=="string"?(M.stops=[{offset:0,color:n},{offset:.5,color:n},{offset:1,color:n}],p(M)):(n==null?void 0:n.type)==="radial-gradient"&&(M.stops=[...(n==null?void 0:n.stops)||[]],p(M)),(A=y.current)===null||A===void 0||A.setFieldsValue(M)):W==="radial-gradient"?(M={type:"radial-gradient",inner:{x:((i==null?void 0:i.w)||0)/2,y:((i==null?void 0:i.h)||0)/2,radius:0},outer:{x:((i==null?void 0:i.w)||0)/2,y:((i==null?void 0:i.h)||0)/2,radius:Math.min(((i==null?void 0:i.w)||0)/2,((i==null?void 0:i.h)||0)/2)},stops:[]},typeof n=="string"?(M.stops=[{offset:0,color:n},{offset:.5,color:n},{offset:1,color:n}],E(M)):(n==null?void 0:n.type)==="linear-gradient"&&(M.stops=[...(n==null?void 0:n.stops)||[]],E(M)),(Y=x.current)===null||Y===void 0||Y.setFieldsValue(M)):W==="solid"&&(M=n,(n==null?void 0:n.type)==="linear-gradient"?(M=((I=(G=n==null?void 0:n.stops)===null||G===void 0?void 0:G[0])===null||I===void 0?void 0:I.color)||"#000000",v(M)):(n==null?void 0:n.type)==="radial-gradient"&&(M=((Z=(H=n==null?void 0:n.stops)===null||H===void 0?void 0:H[0])===null||Z===void 0?void 0:Z.color)||"#000000",v(M))),M&&(o==null||o(M))},U=W=>{if(d==="solid")o==null||o(W.color);else if(w.current){if(d==="linear-gradient"&&g&&Array.isArray(g==null?void 0:g.stops)){const A=[...g.stops];for(let G=0;G<A.length;G++)if(A[G].offset===w.current.offset){A[G].color=W.color;break}const Y=Object.assign(Object.assign({},g),{stops:A});p(Y),o==null||o(Y)}else if(d==="radial-gradient"&&S&&Array.isArray(S==null?void 0:S.stops)){const A=[...S.stops];for(let G=0;G<A.length;G++)if(A[G].offset===w.current.offset){A[G].color=W.color;break}const Y=Object.assign(Object.assign({},S),{stops:A});E(Y),o==null||o(Y)}}},V=W=>{const A=Object.assign({},g);W!=null&&W.start&&(A.start=Object.assign(Object.assign({},A.start),W.start)),W!=null&&W.end&&(A.end=Object.assign(Object.assign({},A.end),W.end)),o==null||o(A)},P=W=>{const A=Object.assign({},S);W!=null&&W.inner&&(A.inner=Object.assign(Object.assign({},A.inner),W.inner)),W!=null&&W.outer&&(A.outer=Object.assign(Object.assign({},A.outer),W.outer)),o==null||o(A)};return T.useMemo(()=>l.createElement("div",{className:ce(b,t)},!a&&!s&&l.createElement("div",{className:C},l.createElement(et.Group,{className:L,size:"small",buttonStyle:"solid",value:d,onChange:({target:{value:W}})=>{$(W)}},l.createElement(et.Button,{value:"solid"},l.createElement(c0,null)),!a&&l.createElement(et.Button,{value:"linear-gradient"},l.createElement(a0,null)),!s&&l.createElement(et.Button,{value:"radial-gradient"},l.createElement(Ju,null)))),!a&&d==="linear-gradient"&&l.createElement("div",{style:{marginBottom:10}},l.createElement(J,{ref:y,onValuesChange:V},l.createElement(re,{className:N},l.createElement(Q,{className:R,span:"4"},"Start"),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["start","x"]},l.createElement(ae,{className:k,size:"small",prefix:"X"}))),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["start","y"]},l.createElement(ae,{className:k,size:"small",prefix:"Y"})))),l.createElement(re,{className:N},l.createElement(Q,{className:R,span:"4"},"End"),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["end","x"]},l.createElement(ae,{className:k,size:"small",prefix:"X"}))),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["end","y"]},l.createElement(ae,{className:k,size:"small",prefix:"Y"})))))),!s&&d==="radial-gradient"&&l.createElement("div",{style:{marginBottom:10}},l.createElement(J,{ref:x,onValuesChange:P},l.createElement(re,{className:N},l.createElement(Q,{className:R,span:"4"},"Inner"),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["inner","x"]},l.createElement(ae,{className:k,size:"small",prefix:"X"}))),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["inner","y"]},l.createElement(ae,{className:k,size:"small",prefix:"Y"})))),l.createElement(re,{className:N},l.createElement(Q,{className:R,span:"4"}),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["inner","radius"]},l.createElement(ae,{className:k,size:"small",prefix:"R"})))),l.createElement(re,{className:N},l.createElement(Q,{className:R,span:"4"},"Outer"),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["outer","x"]},l.createElement(ae,{className:k,size:"small",prefix:"X"}))),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["outer","y"]},l.createElement(ae,{className:k,size:"small",prefix:"Y"})))),l.createElement(re,{className:N},l.createElement(Q,{className:R,span:"4"}),l.createElement(Q,{className:R,span:"10"},l.createElement(J.Item,{className:_,name:["outer","radius"]},l.createElement(ae,{className:k,size:"small",prefix:"R"})))))),(!a||!s)&&(d==="linear-gradient"||d==="radial-gradient")&&l.createElement(x0,{mode:d,value:n,currentPickedColor:h,internalColor:m,internalLinearGradient:g,internalRadialGradient:S,onChange:W=>{(W==null?void 0:W.type)==="linear-gradient"?(p(W),o==null||o(W)):(W==null?void 0:W.type)==="radial-gradient"&&(E(W),o==null||o(W))},onSelectStop:W=>{W!=null&&W.color&&f(W.color),w.current=W}}),l.createElement(M0,{value:h,className:z,onChange:W=>{f(W),U({color:W})}})),[d,r,m,g,S,h,a,s])}const Fs="base-element-field-multiple-color";function qt(e){const{value:t,onChange:n,disabled:o,elementSize:i,disabledLinearGradient:a,disabledRadialGradient:s}=e,r=kt(),d=(p=>{let S="";return typeof p=="string"?S=p:["linear-gradient","radial-gradient"].includes(p==null?void 0:p.type)&&(S=r.gradient),S})(t),u=typeof t=="string",{container:h}=T.useContext(uo),f=B(Fs),m=B(Fs,"preview"),v=T.useRef(h);T.useEffect(()=>{!v.current&&h&&(v.current=h)},[h]);const g=()=>v.current||document.body;return T.useMemo(()=>{const p=oc(t||"transparent");return l.createElement(l.Fragment,null,l.createElement(Lt,{className:f,size:"small",disabled:o,prefix:o?l.createElement("span",null):l.createElement(Js,{placement:"left",getPopupContainer:g,style:{padding:0},content:l.createElement(C0,{value:t,elementSize:i,disabledLinearGradient:a,disabledRadialGradient:s,onChange:n}),trigger:"click"},l.createElement("span",{className:m,style:{background:p}})),readOnly:!u,value:d,onChange:S=>{n==null||n(S.target.value)}}))},[t,n,o,i,h])}const na=e=>l.createElement(ne,Object.assign({},e),l.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"currentColor"},l.createElement("path",{d:"M512 384a42.666667 42.666667 0 1 0-42.666667-42.666667 42.666667 42.666667 0 0 0 42.666667 42.666667z m0 170.666667a42.666667 42.666667 0 1 0-42.666667-42.666667 42.666667 42.666667 0 0 0 42.666667 42.666667z m170.666667 0a42.666667 42.666667 0 1 0-42.666667-42.666667 42.666667 42.666667 0 0 0 42.666667 42.666667z m-170.666667 170.666666a42.666667 42.666667 0 1 0-42.666667-42.666666 42.666667 42.666667 0 0 0 42.666667 42.666666z m341.333333-597.333333H170.666667a42.666667 42.666667 0 0 0-42.666667 42.666667v682.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h682.666666a42.666667 42.666667 0 0 0 42.666667-42.666667V170.666667a42.666667 42.666667 0 0 0-42.666667-42.666667z m-42.666666 682.666667H213.333333V213.333333h597.333334zM341.333333 554.666667a42.666667 42.666667 0 1 0-42.666666-42.666667 42.666667 42.666667 0 0 0 42.666666 42.666667z"}))),Hn="base-element-border-attribute",Ea=4;function Gn(e){const{borderRadius:t,borderWidth:n,borderColor:o,boxSizing:i,borderDash:a}=(e==null?void 0:e.detail)||{};let s="solid",r=Ea;Array.isArray(a)&&(a==null?void 0:a.length)>0&&a[0]>=1&&typeof n=="number"&&(s="dash",r=Math.ceil(a[0]));const c={borderRadiusList:[0,0,0,0],borderWidthList:[0,0,0,0],borderColor:o,borderType:s,boxSizing:i,borderDashNum:r};return typeof t=="number"?(c.borderRadius=t,c.borderRadiusList=[t,t,t,t]):Array.isArray(t)?c.borderRadiusList=[t[0]||0,t[1]||0,t[2]||0,t[3]||0]:c.borderRadius=0,typeof n=="number"?(c.borderWidth=n,c.borderWidthList=[n,n,n,n]):Array.isArray(n)?c.borderWidthList=[n[0]||0,n[1]||0,n[2]||0,n[3]||0]:c.borderWidth=0,c}const z0=e=>{var t,n;const{className:o,style:i,element:a,disabled:s,onChange:r}=e,c=T.useRef(null),d=B(Hn),u=B(Hn,"row"),h=B(Hn,"col"),f=B(Hn,"input"),m=B(Hn,"form-item"),[v,g]=T.useState(Array.isArray((t=a==null?void 0:a.detail)===null||t===void 0?void 0:t.borderRadius)),[p,S]=T.useState(Array.isArray((n=a==null?void 0:a.detail)===null||n===void 0?void 0:n.borderWidth)),[E,w]=T.useState(p),y=kt(),x=b=>{var C,z;const L=Gn(a),{borderColor:N,boxSizing:R,borderType:k,borderDashNum:_}=b,$={};if(N&&($.borderColor=N),R&&($.boxSizing=R),p===!0&&b.borderWidthList){const U=[0,0,0,0],V=Array.from((b==null?void 0:b.borderWidthList)||[null,null,null,null]);for(let P=0;P<4;P++){const W=V[P];typeof W=="number"?U[P]=W:U[P]=((C=L==null?void 0:L.borderWidthList)===null||C===void 0?void 0:C[P])||0,$.borderWidth=U}}else typeof b.borderWidth=="number"&&($.borderWidth=b.borderWidth);if(v===!0&&b.borderRadiusList){const U=[0,0,0,0],V=Array.from((b==null?void 0:b.borderRadiusList)||[null,null,null,null]);for(let P=0;P<4;P++){const W=V[P];typeof W=="number"?U[P]=W:U[P]=((z=L==null?void 0:L.borderRadiusList)===null||z===void 0?void 0:z[P])||0,$.borderRadius=U}}else typeof b.borderRadius=="number"&&($.borderRadius=b.borderRadius);p===!0?$.borderDash=[]:k==="solid"?$.borderDash=[]:k==="dash"?$.borderDash=[Ea,Ea]:_&&_>0&&($.borderDash=[_,_]),r==null||r({detail:$})};return T.useEffect(()=>{var b,C,z;const L=Array.isArray((b=a==null?void 0:a.detail)===null||b===void 0?void 0:b.borderWidth),N=Array.isArray((C=a==null?void 0:a.detail)===null||C===void 0?void 0:C.borderRadius);S(L),g(N),w(L);const R=Gn(a);(z=c.current)===null||z===void 0||z.setFieldsValue(R)},[a]),T.useMemo(()=>{const b=Gn(a);return l.createElement(J,{ref:c,style:i,className:ce(d,o),onValuesChange:x},l.createElement(l.Fragment,null,l.createElement(re,{className:u},l.createElement(Q,{span:16,className:h},p?l.createElement(Lt,{className:f,size:"small",prefix:l.createElement(na,{style:{fontSize:14}}),disabled:!0,value:y.mixedBorderWidth}):l.createElement(J.Item,{className:m,name:"borderWidth"},l.createElement(ae,{className:f,size:"small",min:0,placeholder:"Border Width",prefix:l.createElement(na,{style:{fontSize:14}}),disabled:s||p}))),l.createElement(Q,{span:4,className:h},l.createElement(Oe,{icon:l.createElement(na,null),size:"small",disabled:s,type:p?"primary":"default",onClick:()=>{var C;const z=!p;if(S(z),w(z),!z){const L=Gn(a),N=L.borderWidth||((C=L.borderWidthList)===null||C===void 0?void 0:C[0])||0;x({borderWidth:N})}}}))),p&&l.createElement(l.Fragment,null,l.createElement(re,{className:u},l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderWidthList",0]},l.createElement(ae,{className:f,size:"small",prefix:l.createElement(Gu,null),disabled:s||!p,min:0}))),l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderWidthList",1]},l.createElement(ae,{className:f,size:"small",prefix:l.createElement(Hu,null),disabled:s||!p,min:0})))),l.createElement(re,{className:u},l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderWidthList",2]},l.createElement(ae,{className:f,size:"small",prefix:l.createElement(Wu,null),disabled:s||!p,min:0}))),l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderWidthList",3]},l.createElement(ae,{className:f,size:"small",prefix:l.createElement(Fu,null),disabled:s||!p,min:0})))))),!["circle"].includes(a==null?void 0:a.type)&&l.createElement(l.Fragment,null,l.createElement(re,{className:u},l.createElement(Q,{span:16,className:h},v?l.createElement(Lt,{className:f,size:"small",prefix:l.createElement(ks,{style:{fontSize:14}}),disabled:!0,value:y.mixedBorderRadius}):l.createElement(J.Item,{className:m,name:"borderRadius"},l.createElement(ae,{className:f,size:"small",placeholder:"Radius",prefix:l.createElement(ks,{style:{fontSize:14}}),disabled:s||v||E,min:0}))),l.createElement(Q,{span:4,className:h},l.createElement(Oe,{icon:l.createElement(t0,null),size:"small",disabled:s||E,type:v?"primary":"default",onClick:()=>{var C;const z=!v;if(g(z),!z){const L=Gn(a),N=L.borderRadius||((C=L.borderRadiusList)===null||C===void 0?void 0:C[0])||0;x({borderRadius:N})}}}))),v&&l.createElement(l.Fragment,null,l.createElement(re,{className:u},l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderRadiusList",0]},l.createElement(ae,{className:f,size:"small",placeholder:"",prefix:l.createElement(Uu,null),disabled:s||!v||E,min:0}))),l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderRadiusList",1]},l.createElement(ae,{className:f,size:"small",placeholder:"",prefix:l.createElement(Zu,null),disabled:s||!v||E,min:0})))),l.createElement(re,{className:u},l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderRadiusList",2]},l.createElement(ae,{className:f,size:"small",placeholder:"",prefix:l.createElement($u,null),disabled:s||!v||E,min:0}))),l.createElement(Q,{span:12,className:h},l.createElement(J.Item,{className:m,name:["borderRadiusList",3]},l.createElement(ae,{className:f,size:"small",placeholder:"",prefix:l.createElement(Xu,null),disabled:s||!v||E,min:0})))))),l.createElement(re,{className:u},l.createElement(Q,{className:h,span:"11"},l.createElement(J.Item,{className:m,name:"boxSizing"},l.createElement(_e,{size:"small",disabled:s},l.createElement(_e.Option,{value:"border-box"},y.inside),l.createElement(_e.Option,{value:"content-box"},y.outside),l.createElement(_e.Option,{value:"center-line"},y.centerLine)))),l.createElement(Q,{className:h,span:"13"},l.createElement(J.Item,{className:m,name:"borderColor"},l.createElement(qt,{elementSize:a?mo(a):void 0,disabled:s,disabledLinearGradient:!0,disabledRadialGradient:!0})))),l.createElement(re,{className:u},l.createElement(Q,{className:h,span:"11"},l.createElement(J.Item,{className:m,name:"borderType"},l.createElement(_e,{size:"small",disabled:s||p},l.createElement(_e.Option,{value:"solid"},y.solid),l.createElement(_e.Option,{value:"dash"},y.dash)))),l.createElement(Q,{className:h,span:"13"},b.borderType==="dash"&&l.createElement(J.Item,{className:m,name:"borderDashNum"},l.createElement(ae,{disabled:s||p,className:f,size:"small",style:{width:"100%"},prefix:l.createElement(Bu,{style:{fontSize:14}})})))))},[y,a,s,v,p,E])},I0="base-element-detail-circle",A0=e=>{const{className:t,style:n}=e,o=B(I0);return T.useMemo(()=>l.createElement("div",{style:n,className:ce(o,t)}),[n,t])};var N0=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})};const{TextArea:D0}=Lt,un="base-element-field-image-picker",{useCallback:Hs}=l,T0=["image/png","image/jpeg","image/jpg","image/png"],P0=({value:e="",onChange:t})=>{const[n,o]=T.useState(e),[i,a]=T.useState("free"),s=B(un),r=B(un,"box"),c=B(un,"entity"),d=B(un,"action"),u=B(un,"action-text"),h=B(un,"action-upload"),f=Hs(p=>{const S=p||"";let E=3;const w=300;return S.length>128&&(E=10),{rows:E,width:w}},[n]),m=p=>{t==null||t(p||e)},v=p=>{o(p),Se.imageSrc(p)&&m(p)},g=Hs(()=>{i!=="picking"&&(xa({success:p=>N0(void 0,void 0,void 0,function*(){if(T0.includes(p.file.type)!==!0){di.error(`File's type "${p.file.type}" is not supported!`);return}try{const S=yield qr(p.file);v(S.toString())}catch{di.error(`Failed to parse file ${p.file.name}`)}a("free")}),error:p=>{console.log(p),a("free")}}),a("picking"),setTimeout(()=>{a("free")},500))},[i]);return T.useMemo(()=>l.createElement("div",{className:s},l.createElement("div",{className:r},l.createElement("img",{className:c,src:e||n}),l.createElement("div",{className:d},l.createElement("div",{className:u},l.createElement(Js,{content:()=>l.createElement("div",null,l.createElement(D0,{value:e||n,style:{width:f(e||n).width},rows:f(e||n).rows,onChange:p=>{v(p.target.value||"")}})),trigger:"click"},l.createElement("span",{style:{display:"inline-block",width:"100%",height:"100%",lineHeight:"50px"}},"URL"))),l.createElement("div",{onClick:g,className:h},l.createElement("span",null,"Upload"))))),[e,n])},O0="base-element-detail-image",R0=e=>{const{className:t,style:n,element:o,onChange:i,getElementAsset:a,createElementAsset:s,disabled:r}=e,c=B(O0),d=T.useRef(null),u=f=>{const{src:m=""}=(f==null?void 0:f.detail)||{};return{src:m,imageResource:(a==null?void 0:a(m))||""}},h=f=>{const m={};if(f!=null&&f.imageResource){const{assetId:v}=s({type:"image",value:f.imageResource});v&&Ut(v)&&(m.src=v)}i==null||i({detail:m})};return T.useEffect(()=>{var f;const m=u(o);(f=d.current)===null||f===void 0||f.setFieldsValue(m)},[o]),T.useMemo(()=>l.createElement("div",{style:n,className:ce(c,t)},l.createElement(J,{ref:d,onValuesChange:h},l.createElement(J.Item,{name:"imageResource"},l.createElement(P0,null)))),[o,r])},To="base-element-detail-path",L0=e=>{const{fill:t,stroke:n}=(e==null?void 0:e.detail)||{};return{fill:t,stroke:n}},k0=e=>{const{className:t,style:n,element:o,onChange:i,disabled:a}=e,s=T.useRef(null),r=B(To),c=B(To,"row"),d=B(To,"col"),u=B(To,"form-item"),h=kt(),f=m=>{const v=m;i==null||i({detail:v})};return T.useEffect(()=>{var m;const v=L0(o);(m=s.current)===null||m===void 0||m.setFieldsValue(v)},[o]),T.useMemo(()=>l.createElement("div",{style:n,className:ce(r,t)},l.createElement(J,{ref:s,onValuesChange:f},l.createElement(re,{className:c},l.createElement(Q,{className:d,span:"10"},h.fill),l.createElement(Q,{className:d,span:"14"},l.createElement(J.Item,{className:u,name:"fill"},l.createElement(qt,{disabled:a})))),l.createElement(re,{className:c},l.createElement(Q,{className:d,span:"10"},h.stroke),l.createElement(Q,{className:d,span:"14"},l.createElement(J.Item,{className:u,name:"stroke"},l.createElement(qt,{disabled:a})))))),[n,t])},j0="base-element-detail-rect",_0=e=>{const{className:t,style:n}=e,o=B(j0);return T.useMemo(()=>l.createElement("div",{style:n,className:ce(o,t)}),[n,t])};var V0=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})};const Yn="base-element-field-svg-picker",W0=["image/svg+xml"];function B0(e){const t=document.createElement("div");return t.innerHTML=e,document.querySelector("svg").setAttribute("_t",Date.now()+""),{__html:t.innerHTML}}const F0=({value:e="",onChange:t})=>{const[n,o]=T.useState(e),[i,a]=T.useState("free"),s=B(Yn),r=B(Yn,"box"),c=B(Yn,"entity"),d=B(Yn,"action"),u=B(Yn,"action-upload"),h=v=>{t==null||t(v||e)},f=v=>{o(v),Se.svg(v)&&h(v)},m=T.useCallback(()=>{i!=="picking"&&(xa({success:v=>V0(void 0,void 0,void 0,function*(){if(W0.includes(v.file.type)!==!0){di.error(`File's type "${v.file.type}" is not supported!`);return}try{let g=(yield ec(v.file)).toString();g=g.substring(g.indexOf("<svg")),f(g)}catch{di.error(`Failed to parse file ${v.file.name}`)}a("free")}),error:v=>{console.log(v),a("free")}}),a("picking"),setTimeout(()=>{a("free")},500))},[i]);return T.useMemo(()=>l.createElement("div",{className:s},l.createElement("div",{className:r},l.createElement("div",{className:c,dangerouslySetInnerHTML:B0(e||n)}),l.createElement("div",{className:d},l.createElement("div",{onClick:m,className:u},l.createElement("span",null,"Upload"))))),[e,n])},H0="base-element-detail-svg",G0=e=>{const{className:t,style:n,element:o,onChange:i,getElementAsset:a,createElementAsset:s,disabled:r}=e,c=B(H0),d=T.useRef(null),u=f=>{const{svg:m=""}=(f==null?void 0:f.detail)||{};return{svg:m,svgResource:(a==null?void 0:a(m))||""}},h=f=>{const m={};if(f!=null&&f.svgResource){const{assetId:v}=s({type:"svg",value:f.svgResource});v&&Ut(v)&&(m.svg=v)}i==null||i({detail:m})};return T.useEffect(()=>{var f;const m=u(o);(f=d.current)===null||f===void 0||f.setFieldsValue(m)},[o]),T.useMemo(()=>l.createElement("div",{style:n,className:ce(c,t)},l.createElement(J,{ref:d,onValuesChange:h},l.createElement(J.Item,{name:"svgResource"},l.createElement(F0,null)))),[o,r])},$n="base-element-detail-text",hn={fontSize:20},{TextArea:Y0}=Lt,fn=e=>Se.number(e*1)?ge(e*1):e,$0=e=>{const{color:t,textAlign:n,verticalAlign:o,fontSize:i,fontWeight:a,lineHeight:s,text:r=""}=(e==null?void 0:e.detail)||{};return{text:r,color:t,textAlign:n,verticalAlign:o,fontSize:i,fontWeight:a,lineHeight:s}},X0=e=>{const{className:t,style:n,element:o,onChange:i,disabled:a}=e,s=B($n),r=B($n,"row"),c=B($n,"col"),d=B($n,"switch"),u=B($n,"form-item"),h=T.useRef(null);T.useEffect(()=>{var m;const v=$0(o);(m=h.current)===null||m===void 0||m.setFieldsValue(v)},[o]);const f=m=>{i==null||i({detail:m})};return T.useMemo(()=>l.createElement("div",{style:n,className:ce(s,t)},l.createElement(J,{ref:h,style:n,className:s,onValuesChange:f},l.createElement(re,{className:r},l.createElement(Q,{span:"12",className:c},l.createElement(J.Item,{className:u,name:"verticalAlign"},l.createElement(et.Group,{disabled:a,className:d,size:"small"},l.createElement(et.Button,{value:"top"},l.createElement(h0,{style:hn})),l.createElement(et.Button,{value:"middle"},l.createElement(u0,{style:hn})),l.createElement(et.Button,{value:"bottom"},l.createElement(d0,{style:hn}))))),l.createElement(Q,{span:"12",className:c},l.createElement(J.Item,{className:u,name:"textAlign"},l.createElement(et.Group,{disabled:a,className:d,size:"small"},l.createElement(et.Button,{value:"left"},l.createElement(ju,{style:hn})),l.createElement(et.Button,{value:"center"},l.createElement(ku,{style:hn})),l.createElement(et.Button,{value:"right"},l.createElement(_u,{style:hn})))))),l.createElement(re,{className:r},l.createElement(Q,{span:"10",className:c},"Text Color"),l.createElement(Q,{span:"14",className:c},l.createElement(J.Item,{className:u,name:"color"},l.createElement(qt,{elementSize:o?mo(o):void 0,disabled:a,disabledLinearGradient:!0,disabledRadialGradient:!0})))),l.createElement(re,{className:r},l.createElement(Q,{span:"10",className:c},"Font Size"),l.createElement(Q,{span:"14",className:c},l.createElement(J.Item,{className:u,name:"fontSize"},l.createElement(ae,{disabled:a,size:"small",style:{width:"100%"},step:1,min:0,formatter:fn,parser:fn})))),l.createElement(re,{className:r},l.createElement(Q,{span:"10",className:c},"Font Weight"),l.createElement(Q,{span:"14",className:c},l.createElement(J.Item,{className:u,name:"fontWeight"},l.createElement(ae,{disabled:a,size:"small",style:{width:"100%"},step:100,max:1e3,min:100,formatter:fn,parser:fn})))),l.createElement(re,{className:r},l.createElement(Q,{span:"10",className:c},"Line Height"),l.createElement(Q,{span:"14",className:c},l.createElement(J.Item,{className:u,name:"lineHeight"},l.createElement(ae,{disabled:a,size:"small",style:{width:"100%"},step:1,min:0,formatter:fn,parser:fn})))),l.createElement(re,{className:r},l.createElement(Q,{span:"24",className:c},l.createElement(J.Item,{className:u,name:"text",style:{width:"100%"}},l.createElement(Y0,{disabled:a,style:{width:"100%"},rows:3})))))),[n,t])},Po="base-element-detail-group",U0=e=>{const{overflow:t}=(e==null?void 0:e.detail)||{};return{overflow:t}},Z0=e=>{const{className:t,style:n,element:o,onChange:i,disabled:a}=e,s=B(Po),r=B(Po,"row"),c=B(Po,"col"),d=B(Po,"form-item"),u=T.useRef(null),h=kt();T.useEffect(()=>{var m;const v=U0(o);(m=u.current)===null||m===void 0||m.setFieldsValue(v)},[o]);const f=m=>{i==null||i({detail:m})};return T.useMemo(()=>l.createElement("div",{style:n,className:ce(s,t)},l.createElement(J,{ref:u,style:n,className:s,onValuesChange:f},l.createElement(re,{className:r},l.createElement(Q,{className:c,span:"10"},h.overflow),l.createElement(Q,{span:"12",className:c},l.createElement(J.Item,{className:d,name:"overflow"},l.createElement(_e,{size:"small",disabled:a},l.createElement(_e.Option,{value:"visible"},h.visible),l.createElement(_e.Option,{value:"hidden"},h.hidden))))))),[n,t,h])},Q0="base-element-detail-attribute",J0=e=>{const{element:t,onChange:n,disabled:o,getElementAsset:i,createElementAsset:a}=e,s=B(Q0);return T.useMemo(()=>l.createElement("div",{className:s},(t==null?void 0:t.type)==="circle"&&l.createElement(A0,{element:t,onChange:n,disabled:o}),(t==null?void 0:t.type)==="image"&&l.createElement(R0,{element:t,onChange:n,disabled:o,getElementAsset:i,createElementAsset:a}),(t==null?void 0:t.type)==="svg"&&l.createElement(G0,{element:t,onChange:n,disabled:o,getElementAsset:i,createElementAsset:a}),(t==null?void 0:t.type)==="group"&&l.createElement(Z0,{element:t,onChange:n,disabled:o}),(t==null?void 0:t.type)==="path"&&l.createElement(k0,{element:t,onChange:n,disabled:o}),(t==null?void 0:t.type)==="rect"&&l.createElement(_0,{element:t,onChange:n,disabled:o}),(t==null?void 0:t.type)==="text"&&l.createElement(X0,{element:t,onChange:n})),[o,t])},Oo="base-element-content-attribute",K0=e=>{let{opacity:t}=(e==null?void 0:e.detail)||{};const{background:n}=(e==null?void 0:e.detail)||{};return typeof t=="number"&&t>=0&&t<=1||(t=1),{background:n,opacity:t}},q0=e=>{const{style:t,element:n,disabled:o,onChange:i,getElementAsset:a,createElementAsset:s}=e,r=T.useRef(null),c=B(Oo),d=B(Oo,"row"),u=B(Oo,"col"),h=B(Oo,"form-item"),f=g=>{const p=g;i==null||i({detail:p})},m=g=>{i==null||i(g)},v=kt();return T.useEffect(()=>{var g;const p=K0(n);(g=r.current)===null||g===void 0||g.setFieldsValue(p)},[n]),T.useMemo(()=>l.createElement(l.Fragment,null,l.createElement(J,{ref:r,style:t,className:c,onValuesChange:f},["rect","circle","text","group"].includes(n==null?void 0:n.type)&&l.createElement(re,{className:d},l.createElement(Q,{className:u,span:"10"},v.background),l.createElement(Q,{className:u,span:"14"},l.createElement(J.Item,{className:h,name:"background"},l.createElement(qt,{elementSize:n?mo(n):void 0,disabled:o})))),l.createElement(re,{className:d},l.createElement(Q,{className:u,span:"10"},v.opacity),l.createElement(Q,{className:u,span:"14"},l.createElement(J.Item,{className:h,name:"opacity"},l.createElement(ae,{disabled:o,size:"small",style:{width:"100%"},step:.1}))))),l.createElement(J0,{element:n,disabled:o,onChange:m,getElementAsset:a,createElementAsset:s})),[v,n,o,i])},Ro="base-element-shadow-attribute",eh=e=>{const{shadowColor:t,shadowBlur:n,shadowOffsetX:o,shadowOffsetY:i}=(e==null?void 0:e.detail)||{};return{shadowColor:t,shadowBlur:n,shadowOffsetX:o,shadowOffsetY:i}},th=e=>{const{style:t,element:n,disabled:o,onChange:i}=e,a=T.useRef(null),s=B(Ro),r=B(Ro,"row"),c=B(Ro,"col"),d=B(Ro,"form-item"),u=f=>{const m=f;i==null||i({detail:m})},h=kt();return T.useEffect(()=>{var f;const m=eh(n);(f=a.current)===null||f===void 0||f.setFieldsValue(m)},[n]),T.useMemo(()=>l.createElement(J,{ref:a,style:t,className:s,onValuesChange:u},l.createElement(re,{className:r},l.createElement(Q,{className:c,span:"14"},l.createElement(J.Item,{className:d,name:"shadowColor"},l.createElement(qt,{elementSize:n?mo(n):void 0,disabled:o,disabledLinearGradient:!0,disabledRadialGradient:!0}))),l.createElement(Q,{className:c,span:"10"},l.createElement(J.Item,{className:d,name:"shadowBlur"},l.createElement(ae,{disabled:o,size:"small",style:{width:"100%"}})))),l.createElement(re,null,l.createElement(Q,{className:c,span:"12"},l.createElement(J.Item,{className:d,name:"shadowOffsetX"},l.createElement(ae,{disabled:o,size:"small",style:{width:"100%"},prefix:"X"}))),l.createElement(Q,{className:c,span:"12"},l.createElement(J.Item,{className:d,name:"shadowOffsetY"},l.createElement(ae,{disabled:o,size:"small",style:{width:"100%"},prefix:"Y"}))))),[h,n,o])},nh="base-element-detail",oh=tn(),ih=e=>{const{className:t,style:n,element:o,onChange:i,getElementAsset:a,createElementAsset:s}=e,r=kt(),c=B(nh);let d=o;o&&(d=Object.assign(Object.assign({},o||{}),{detail:Object.assign(Object.assign({},oh),o==null?void 0:o.detail)}));const u=[{key:"basic-attribute",label:r.basicAttributes,children:l.createElement(E0,{element:d,disabled:!d,onChange:h=>{i==null||i(h)}})},{key:"border-attribute",label:r.borderAttribute,children:["rect","circle","text","image","group"].includes(o==null?void 0:o.type)?l.createElement(z0,{element:d,disabled:!d,onChange:h=>{i==null||i(h)}}):l.createElement(Ot,{image:Ot.PRESENTED_IMAGE_SIMPLE,description:!1})},{key:"content-attribute",label:r.contentAttribute,children:l.createElement(q0,{element:d,disabled:!d,onChange:h=>{i==null||i(h)},getElementAsset:a,createElementAsset:s})},{key:"shadow-attribute",label:r.shadowAttribute,children:["rect","circle","text","image","group"].includes(o==null?void 0:o.type)?l.createElement(th,{element:d,disabled:!d,onChange:h=>{i==null||i(h)}}):l.createElement(Ot,{image:Ot.PRESENTED_IMAGE_SIMPLE,description:!1})}];return T.useMemo(()=>l.createElement("div",{style:n,className:ce(c,t)},l.createElement(Ma,{ghost:!0,items:u,size:"small",defaultActiveKey:u.map(h=>h.key)})),[d,r])},ah="LayoutDetail",Ta=()=>{const[e]=el(ah);return e},Xn="base-element-basic-attribute",It=e=>Se.number(e*1)?ge(e*1):e,sh=e=>{const{className:t,style:n,layout:o,onChange:i,disabled:a,isGroupLayout:s}=e,r=T.useRef(null),c=B(Xn),d=B(Xn,"row"),u=B(Xn,"col"),h=B(Xn,"input"),f=B(Xn,"form-item"),m=Ta(),v=g=>{i==null||i(g)};return T.useEffect(()=>{var g;const{x:p,y:S,w:E,h:w}=o||{},y={x:p,y:S,w:E,h:w};(g=r.current)===null||g===void 0||g.setFieldsValue(y)},[o]),T.useMemo(()=>l.createElement(J,{ref:r,style:n,className:ce(c,t),onValuesChange:v},!s&&l.createElement(re,{className:d},l.createElement(Q,{span:10,className:u},l.createElement(J.Item,{className:f,name:"x"},l.createElement(ae,{className:h,size:"small",placeholder:"X",prefix:"X",disabled:a,formatter:It,parser:It}))),l.createElement(Q,{span:10,className:u},l.createElement(J.Item,{className:f,name:"y"},l.createElement(ae,{className:h,size:"small",placeholder:"Y",prefix:"Y",disabled:a,formatter:It,parser:It})))),l.createElement(re,{className:d},l.createElement(Q,{span:10,className:u},l.createElement(J.Item,{className:f,name:"w"},l.createElement(ae,{className:h,size:"small",placeholder:"Width",prefix:m.w,disabled:a,formatter:It,parser:It}))),l.createElement(Q,{span:10,className:u},l.createElement(J.Item,{className:f,name:"h"},l.createElement(ae,{className:h,size:"small",placeholder:"Height",prefix:m.h,disabled:a,formatter:It,parser:It}))))),[m,a,o])},Lo="base-element-content-attribute",lh=e=>{const{background:t,overflow:n="visible"}=e||{};return{background:t,overflow:n}},rh=e=>{const{style:t,layout:n,disabled:o,onChange:i}=e,a=T.useRef(null),s=B(Lo),r=B(Lo,"row"),c=B(Lo,"col"),d=B(Lo,"form-item"),u=f=>{const m=f;i==null||i({detail:m})},h=Ta();return T.useEffect(()=>{var f;const m=lh(n==null?void 0:n.detail);(f=a.current)===null||f===void 0||f.setFieldsValue(m)},[n]),T.useMemo(()=>l.createElement(l.Fragment,null,l.createElement(J,{ref:a,style:t,className:s,onValuesChange:u},l.createElement(re,{className:r},l.createElement(Q,{className:c,span:"10"},h.background),l.createElement(Q,{className:c,span:"14"},l.createElement(J.Item,{className:d,name:"background"},l.createElement(qt,{elementSize:n?mo(n):void 0,disabled:o})))),l.createElement(re,{className:r},l.createElement(Q,{className:c,span:"10"},h.overflow),l.createElement(Q,{span:"12",className:c},l.createElement(J.Item,{className:d,name:"overflow"},l.createElement(_e,{size:"small",disabled:o},l.createElement(_e.Option,{value:"visible"},h.visible),l.createElement(_e.Option,{value:"hidden"},h.hidden))))))),[h,n,o,i])},ch="base-layout-detail",dh=e=>{const{className:t,style:n,layout:o,onChange:i,isGroupLayout:a}=e,s=Ta(),r=B(ch),c=[{key:"layout-attribute",label:s.layout,children:l.createElement(l.Fragment,null,l.createElement(sh,{isGroupLayout:a,layout:o,onChange:d=>{i==null||i(d)}}),l.createElement(rh,{layout:o,onChange:d=>{i==null||i(d)}}))}];return T.useMemo(()=>l.createElement("div",{style:n,className:ce(r,t)},l.createElement(Ma,{ghost:!0,items:c,size:"small",defaultActiveKey:c.map(d=>d.key)})),[o,s])},uh="base-element-design",hh=e=>{var t;const{className:n,style:o,element:i,onElementChange:a,getElementAsset:s,createElementAsset:r,layout:c,onLayoutChange:d}=e,u=[{key:"element-detail",label:"Element",children:l.createElement(ih,{element:i,onChange:a,getElementAsset:s,createElementAsset:r})},{key:"element-layout",label:"Layout",children:l.createElement(dh,{isGroupLayout:((t=c==null?void 0:c.operations)===null||t===void 0?void 0:t.position)==="relative",layout:c,onChange:d})}];return T.useMemo(()=>l.createElement("div",{style:o,className:ce(B(uh),n)},l.createElement(Nr,{size:"small",defaultActiveKey:u[0].key,items:u})),[i,a,s,r,c,d])},pr=e=>{var t;const n={uuid:e.uuid,key:e.uuid,title:e.name||e.detail.text||e.type||"unamed",type:e.type,children:[],operations:e.operations||{}};return e.type==="group"&&Array.isArray((t=e==null?void 0:e.detail)===null||t===void 0?void 0:t.children)&&e.detail.children.forEach(o=>{n.children.push(pr(o))}),n};function we(e){const t=[];return e.elements.forEach(n=>{const o=pr(n);t.push(o)}),t}const fh=e=>({uuid:e.uuid,key:e.uuid,title:e.name||e.detail.text||e.type||"unamed",type:e.type,operations:e.operations||{}});function co(e){const t=[];return e.elements.forEach(n=>{var o;if(n.type==="group"&&((o=n.extends)===null||o===void 0?void 0:o.isPage)===!0){const i=fh(n);t.push(i)}}),t}var mh=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};function Tt(e,t){if(e.length===0)return Zt(t);const n=Ve(e,t.elements),o={elements:[],assets:t.assets};if((n==null?void 0:n.type)==="group"){const{w:i,h:a,detail:s}=n,{children:r}=s,c=mh(s,["children"]),d={x:0,y:0,w:i,h:a,detail:Object.assign({},c),operations:{position:"relative"}};o.elements=Zt(r||[]),o.layout=d}return o}function gh(e,t,n){if(e.length>0){const o=Ve(e,n.elements);(o==null?void 0:o.type)==="group"&&(o.detail.children=t.elements)}}function vh(e,t,n){if(t.length>0&&(e!=null&&e.layout)){const o=e.layout,a=Ve(t,n.elements);(a==null?void 0:a.type)==="group"&&(Se.w(o.w)&&(a.w=o.w),Se.h(o.h)&&(a.h=o.h),a.detail=Object.assign(Object.assign({},a.detail),o.detail))}}function yr(e){var t,n,o,i,a,s,r,c,d,u;let h=e;for(let S=0;S<e.elements.length;S++){const E=e.elements[S];if(E.type==="group"&&((t=E.extends)===null||t===void 0?void 0:t.isPage)===!0)return h}const f=vi(e.elements);let{x:m,y:v,w:g,h:p}=f;return Se.x((n=e==null?void 0:e.layout)===null||n===void 0?void 0:n.x)&&(m=Math.min(m,(o=e.layout)===null||o===void 0?void 0:o.x)),Se.y((i=e==null?void 0:e.layout)===null||i===void 0?void 0:i.y)&&(v=Math.min(v,(a=e.layout)===null||a===void 0?void 0:a.y)),Se.w((s=e==null?void 0:e.layout)===null||s===void 0?void 0:s.w)&&(g=Math.max(g,(r=e.layout)===null||r===void 0?void 0:r.w)),Se.h((c=e==null?void 0:e.layout)===null||c===void 0?void 0:c.h)&&(p=Math.max(p,(d=e.layout)===null||d===void 0?void 0:d.h)),e.elements.forEach(S=>{S.x-=m,S.y-=v}),h={elements:[{uuid:$e(),name:"Default page",type:"group",x:0,y:0,w:g,h:p,detail:Object.assign(Object.assign(Object.assign({},(u=e.layout)===null||u===void 0?void 0:u.detail),{children:e.elements}),g===0||p===0?{overflow:"visible"}:{}),extends:{isPage:!0}}],assets:e.assets},h}const wr="dark",br="en-US",Sr="data";function ph(e){let t=Object.assign({elements:[]},(e==null?void 0:e.data)||{});(e==null?void 0:e.defaultEditMode)==="page"&&(t=yr(t));let n=[],o=t;const i=co(t);e!=null&&e.defaultEditingGroupUUID&&(n=ct(e.defaultEditingGroupUUID,t.elements)),(e==null?void 0:e.defaultEditMode)==="page"&&n.length!==1&&i.length>0&&(n=[0]),o=Tt(n,t);const a=we(o);return{localeCode:(e==null?void 0:e.defaultLocale)||br,themeMode:(e==null?void 0:e.defaultThemeMode)||wr,editMode:(e==null?void 0:e.defaultEditMode)||Sr,data:t,editingData:o,editingDataPosition:n,elementTree:a,pageTree:i,selectedUUIDs:(e==null?void 0:e.defaultSelectedElementUUIDs)||[],scaleInfo:Object.assign({scale:1,from:"init"},(e==null?void 0:e.defaultScaleInfo)||{})}}function yh(e){const t=Object.assign({elements:[]},(e==null?void 0:e.data)||{});return{localeCode:br,themeMode:(e==null?void 0:e.themeMode)||wr,editMode:(e==null?void 0:e.editMode)||Sr,data:Object.assign({elements:[]},(e==null?void 0:e.data)||{}),editingData:Tt([],t),editingDataPosition:[],elementTree:[],pageTree:[],selectedUUIDs:[],scaleInfo:Object.assign({scale:1,from:"control"},(e==null?void 0:e.scaleInfo)||{})}}function wh(e,t){var n,o,i;switch(t.type){case"update":return t!=null&&t.payload?Object.assign(Object.assign({},e),t==null?void 0:t.payload):e;case"updateThemeMode":return!((n=t==null?void 0:t.payload)===null||n===void 0)&&n.themeMode?Object.assign(Object.assign({},e),{themeMode:(o=t==null?void 0:t.payload)===null||o===void 0?void 0:o.themeMode}):e;case"updateEditingDataLayoutToTargetGroup":{if(!(!((i=t==null?void 0:t.payload)===null||i===void 0)&&i.editingData))return e;const{editingData:a}=t.payload;if(a.layout){const{editingDataPosition:s,data:r}=e;return vh(a,s,r),Object.assign(Object.assign({},e),{data:r,editingData:a})}return e}default:return e}}const Et=T.createContext({state:yh(),dispatch:()=>{}}),bh=Et.Provider,Sh={locale:"en-US",NavMenu:{about:"About @idraw/studio",file:"File",importJSONFile:"Import JSON file",exportJSONFile:"Export JSON file",exportImage:"Export image",preferences:"Preferences",rect:"Rect",circle:"Circle",text:"Text",image:"Image",html:"HTML",svg:"SVG",group:"Group",devicePixelRatio:"Device pixel ratio"},Toolbar:{layers:"Layers",ruler:"Ruler",attributes:"Attributes",hand:"Hand tool",centerContent:"Center content"},contextMenu:{copy:"Copy",paste:"Paste",cut:"Cut",delete:"Delete"}},Eh={locale:"zh-CN",NavMenu:{about:"关于 @idraw/studio",file:"文件",importJSONFile:"导入JSON文件",exportJSONFile:"导出JSON文件",exportImage:"导出图片",preferences:"预设",rect:"矩形",circle:"圆形",text:"文本",image:"图片",html:"HTML片段",svg:"SVG片段",group:"群组",devicePixelRatio:"设备像素比例"},Toolbar:{layers:"图层",ruler:"标尺",attributes:"属性",hand:"拖拽工具",centerContent:"内容居中"},contextMenu:{copy:"复制",paste:"粘贴",cut:"剪切",delete:"删除"}},Mh={"en-US":Sh,"zh-CN":Eh},Ti=e=>{const{state:t}=T.useContext(Et),n=t.localeCode;return[T.useMemo(()=>{const a=Mh[n][e];return Object.assign({},a)},[n,e])]},ko="mod-toolbar",xh=()=>{const[e]=Ti("Toolbar");return e},Ch=e=>{const{className:t,style:n,openLeftSider:o,openRightSider:i,onClickToggleLayer:a,onClickToggleSetting:s,sharedStore:r}=e,c={fontSize:16},d=B(ko),u=B(ko,"left"),h=B(ko,"right"),f=B(ko,"btn"),[m,v]=T.useState(!1),[g,p]=T.useState(!0),S=xh();T.useEffect(()=>{const w=r.get("idraw");g===!0?w==null||w.enable("ruler"):w==null||w.disable("ruler")},[g]),T.useEffect(()=>{const w=r.get("idraw");w==null||w.setMode(m?"drag":"select")},[m]);const E={size:"small",className:f,shape:"default"};return T.useMemo(()=>l.createElement("div",{style:n,className:ce(d,t)},l.createElement("div",{className:u}),l.createElement("div",{className:h},l.createElement(Ln,{title:S.layers},l.createElement(Oe,Object.assign({},E,{type:o?"primary":"default",icon:l.createElement(n0,{style:c}),onClick:a}))),l.createElement(Ln,{title:S.attributes},l.createElement(Oe,Object.assign({},E,{type:i?"primary":"default",icon:l.createElement(r0,{style:c}),onClick:s}))),l.createElement(Ln,{title:S.ruler},l.createElement(Oe,Object.assign({},E,{type:g?"primary":"default",icon:l.createElement(l0,{style:Object.assign(Object.assign({},c),{fontSize:20})}),onClick:()=>{p(!g)}}))),l.createElement(Ln,{title:S.hand},l.createElement(Oe,Object.assign({},E,{type:m?"primary":"default",icon:l.createElement(Ku,{style:Object.assign(Object.assign({},c),{fontSize:20})}),onClick:()=>{v(!m)}}))),l.createElement(Ln,{title:S.centerContent},l.createElement(Oe,Object.assign({},E,{type:"text",icon:l.createElement(Lu,{style:Object.assign(Object.assign({},c),{fontSize:20})}),onClick:()=>{const w=r.get("idraw");w==null||w.centerContent()}}))))),[o,i,a,s,m,g,S])},Un="mod-panel-layer",zh=e=>{const{className:t,style:n,height:o,sharedStore:i,sharedEvent:a,useContextMenuOptions:s}=e,{state:r,dispatch:c}=T.useContext(Et),{elementTree:d,selectedUUIDs:u,editingData:h}=r,f=T.useRef(null),m=B(Un),v=B(Un,"content"),g=B(Un,"header"),p=B(Un,"header","title"),S=B(Un,"header","btn"),[E]=s({sharedEvent:a,sharedStore:i}),w=()=>{if(r.editingDataPosition.length===0)return"";const L=Ve(r.editingDataPosition,r.data.elements);return(L==null?void 0:L.name)||(L==null?void 0:L.type)||""},y=L=>{const N=i.get("idraw");N==null||N.selectElementsByPositions(L)};T.useEffect(()=>{a.on("scrollToLayer",({uuid:L})=>{var N;L&&((N=f.current)===null||N===void 0||N.scrollTo({key:L,align:"top"}))})},[]),T.useEffect(()=>{if(u[0]&&u.length===1){const N=Ca(u[0],h.elements).map(R=>R.uuid);u[0]&&N.push(u[0])}},[u,h]);const x=()=>{a.trigger("resetEditingView",{type:"back-root",position:null})},b=()=>{a.trigger("resetEditingView",{type:"back-one",position:null})},C=32,z=o-C;return T.useMemo(()=>Array.isArray(d)&&d.length>0?l.createElement("div",{style:n,className:ce(m,t),onContextMenu:L=>{L.preventDefault()}},l.createElement("div",{className:g,style:{height:C}},l.createElement(Oe,{className:S,size:"small",icon:l.createElement(fr,null),disabled:!(r.editingDataPosition.length>0),onClick:x}),l.createElement(Oe,{className:S,size:"small",icon:l.createElement(mr,null),disabled:!(r.editingDataPosition.length>0),onClick:b}),l.createElement("span",{className:p},w())),l.createElement(Pn,{menu:{items:E},trigger:["contextMenu"]},l.createElement("div",{className:v},l.createElement(gr,{ref:f,height:z,treeData:d,selectedKeys:u,onTitleChange:({uuid:L,value:N})=>{Rt(L,{name:N},r.editingData.elements);const R=we(h);c({type:"update",payload:{editingData:Object.assign({},h),elementTree:R}})},onOperationToggle:({uuid:L,operations:N})=>{Rt(L,{operations:N},r.editingData.elements);const R=we(h);c({type:"update",payload:{editingData:Object.assign({},h),elementTree:R}})},onSelect:L=>{u!=null&&u.includes(L.uuids[0])||y(L.positions)},onDrop:L=>{const{elements:N}=pi(h.elements,{from:L.from,to:L.to}),R=Ve(L.to,h.elements);R&&(R.x=0,R.y=0);const k=we(h);c({type:"update",payload:{editingData:Object.assign(Object.assign({},h),{elements:[...N]}),elementTree:k}})},onDelete:({uuid:L})=>{a.trigger("deleteElement",{uuid:L})},onGoToGroup:L=>{a.trigger("resetEditingView",{type:"go-to-next-group",position:L.position})}})))):l.createElement("div",{style:n,className:ce(m,t),onContextMenu:L=>{L.preventDefault()}},l.createElement("div",{className:g},"..."),l.createElement("div",{className:v},l.createElement("div",{style:{padding:"20px 0",textAlign:"center"}},"Empty"))),[z,d,u,h.elements,r.editingDataPosition,E])},Ih="add-page-button",Ah=e=>{const{className:t,style:n,parentModName:o,inPageOverview:i,sharedEvent:a,sharedStore:s}=e,r=B(o,Ih);return T.useMemo(()=>l.createElement(Pn,{trigger:["click","click"],placement:"bottom",menu:{items:[{key:"pc-page",label:"PC page",onClick:c=>{c.domEvent.stopPropagation();const d=s.get("idraw"),u=d==null?void 0:d.getData();if(d&&Array.isArray(u==null?void 0:u.elements)){const h=vi(u.elements),v={uuid:$e(),type:"group",name:"Unamed PC page",x:h.x+h.w+100,y:h.y,w:1200,h:800,detail:{background:"#FFFFFF",children:[{uuid:$e(),type:"rect",name:"Box",x:50,y:50,w:1100,h:400,detail:{background:"#D9D9D9"}},{uuid:$e(),type:"rect",name:"Box",x:50,y:500,w:1100,h:200,detail:{background:"#D9D9D9"}}]},extends:{isPage:!0}};a.trigger("addPage",{element:v,inPageOverview:i})}}},{key:"mobile-page",label:"Mobile page",onClick:c=>{c.domEvent.stopPropagation();const d=s.get("idraw"),u=d==null?void 0:d.getData();if(d&&Array.isArray(u==null?void 0:u.elements)){const h=vi(u.elements),v={uuid:$e(),type:"group",name:"Unamed Mobile page",x:h.x+h.w+100,y:h.y,w:750,h:2e3,detail:{background:"#FFFFFF",children:[{uuid:$e(),type:"rect",name:"Box",x:40,y:40,w:670,h:400,detail:{background:"#D9D9D9"}},{uuid:$e(),type:"rect",name:"Box",x:40,y:480,w:670,h:600,detail:{background:"#D9D9D9"}}]},extends:{isPage:!0}};a.trigger("addPage",{element:v,inPageOverview:i})}}}]}},l.createElement(Oe,{size:"small",type:"text",style:n,className:ce(r,t),onClick:c=>{c.stopPropagation()}},l.createElement(Ks.Compact,null,l.createElement(e0,{style:{fontSize:18}}),l.createElement(Di,{style:{fontSize:10,marginLeft:2}})))),[n,t,i])},mn="mod-panel-page",Ft="page-tree",gn="element-tree",Gs=1,Ys=3,Nh=e=>{const{className:t,style:n,height:o,defaultSelectedElementUUIDs:i=[],sharedStore:a,sharedEvent:s,useContextMenuOptions:r}=e,{state:c,dispatch:d}=T.useContext(Et),{pageTree:u,elementTree:h,selectedUUIDs:f,editingData:m,editingDataPosition:v,data:g}=c,p=T.useRef(null),S=T.useRef(null),E=32,w=T.useRef([Ft,gn]),[y,x]=T.useState(0),[b,C]=T.useState(0),[z,L]=T.useState(i),N=B(mn),R=B(mn,"content"),k=B(mn,"header"),_=B(mn,"header","title"),$=B(mn,"header","btn"),[U]=r({sharedEvent:s,sharedStore:a}),[V]=Ti("contextMenu"),[P,W]=T.useState(!1),A=T.useRef(P),Y=()=>{const j=[],K=Ve([v[0]],c.data.elements);return K!=null&&K.uuid&&j.push(K.uuid),j},[G,I]=T.useState(Y());T.useEffect(()=>{const j=a.get("idraw"),K=ie=>{if(A.current===!0){const{uuids:le}=ie;I([...le])}};return j==null||j.on(he.select,K),()=>{j==null||j.off(he.select,K)}},[]),T.useEffect(()=>{var j;if(v.length===1&&u.length>0){const K=(j=u[v[0]])===null||j===void 0?void 0:j.uuid;K&&!G.includes(K)&&I([K])}},[v]);const H=()=>{const j=w.current,K=Gs+Ys;if(j.includes(Ft)&&j.includes(gn)){const ie=o-E*2;x(ie*Gs/K),C(ie*Ys/K)}else if(j.includes(Ft)&&!j.includes(gn)){const ie=o-E*2;x(ie),C(0)}else if(!j.includes(Ft)&&j.includes(gn)){const ie=o-E*2;x(0),C(ie)}else x(0),C(0)};T.useEffect(()=>{const j=a==null?void 0:a.get("idraw");if(P===!0)w.current=[Ft],s.trigger("resetEditingView",{type:"back-root",position:null}),I([]),j==null||j.disable("selectInGroup");else{const K=[];u.length>0&&(K.push(u[0].uuid),s.trigger("resetEditingView",{type:"go-to-page",position:[0]})),I(K),j==null||j.enable("selectInGroup"),w.current=[Ft,gn]}H()},[o,P]),T.useEffect(()=>{A.current=P,s.trigger("switchPageOverview",{isPageOverview:!!P})},[P]);const Z=()=>{if(v.length===0)return"";const j=Ve(v,c.data.elements);return(j==null?void 0:j.name)||(j==null?void 0:j.type)||""},M=j=>{const K=a.get("idraw");K==null||K.selectElementsByPositions(j)};T.useEffect(()=>{s.on("scrollToLayer",({uuid:j})=>{var K;j&&((K=p.current)===null||K===void 0||K.scrollTo({key:j,align:"top"}))})},[]),T.useEffect(()=>{if(f[0]&&f.length===1){const K=Ca(f[0],m.elements).map(le=>le.uuid);f[0]&&K.push(f[0]);const ie=[...z];K.forEach(le=>{ie.includes(le)||ie.push(le)}),L(ie)}},[f,m]);const O=j=>{j.stopPropagation(),v.length>1&&s.trigger("resetEditingView",{type:"go-to-group",position:[v[0]]})},D=j=>{j.stopPropagation(),s.trigger("resetEditingView",{type:"back-one",position:null})},F=[{key:Ft,collapsible:P?"disabled":void 0,label:l.createElement("div",{className:k,style:{height:E}},l.createElement("div",{style:{display:"flex"}},l.createElement("span",{style:{marginRight:10}},"Pages"),l.createElement(Oe,{className:$,style:{marginLeft:"10px"},size:"small",icon:l.createElement(o0,null),type:P?"primary":"default",onClick:j=>{j.stopPropagation(),W(!P)}})),l.createElement("div",{style:{display:"flex"}},l.createElement(Ah,{inPageOverview:P,parentModName:mn,sharedEvent:s,sharedStore:a}))),children:l.createElement("div",{className:R,style:{height:y}},u.length>0?l.createElement(y0,{ref:S,height:y,treeData:u,selectedKeys:G,onTitleChange:({uuid:j,value:K})=>{Rt(j,{name:K},g.elements);const le={pageTree:co(g),data:Object.assign({},g)};if(v.length===0){le.editingData=Object.assign({},g);const Qe=we(g);le.elementTree=Qe}d({type:"update",payload:le})},onOperationToggle:({})=>{},onSelect:j=>{if((j==null?void 0:j.positions.length)===1){const K=a.get("idraw");if(K==null||K.trigger(he.select,{uuids:[]}),K==null||K.trigger(he.clearSelect),P){G!=null&&G.includes(j.uuids[0])||(M(j.positions),I([j.uuids[0]]));return}s.trigger("resetEditingView",{type:"go-to-page",position:j.positions[0]});const ie=[],le=Ve(j.positions[0],c.data.elements);le!=null&&le.uuid&&(ie.push(le.uuid),I(ie))}},onDrop:j=>{if(!(j.from.length===1&&j.to.length===1))return;const{elements:K}=pi(g.elements,{from:j.from,to:j.to}),le={pageTree:co(g),data:Object.assign(Object.assign({},g),{elements:K})};if(v.length===0){le.editingData=Object.assign(Object.assign({},g),{elements:K});const Qe=we(g);le.elementTree=Qe}d({type:"update",payload:le})},onDelete:({uuid:j})=>{s.trigger("deletePage",{uuid:j})}}):l.createElement(Ot,{image:Ot.PRESENTED_IMAGE_SIMPLE,description:!1}))},{key:gn,collapsible:P?"disabled":void 0,label:l.createElement("div",{className:k,style:{height:E}},l.createElement("div",{style:{display:"inline-flex"}},l.createElement(Oe,{className:$,size:"small",icon:l.createElement(fr,null),disabled:!(v.length>1),onClick:O}),l.createElement(Oe,{className:$,size:"small",icon:l.createElement(mr,null),disabled:!(v.length>1),onClick:D})),l.createElement("span",{className:_},Z())),children:P?null:l.createElement(Pn,{menu:{items:U},trigger:["contextMenu"]},l.createElement("div",{className:R,style:{height:b}},h.length>0?l.createElement(gr,{ref:p,height:b,treeData:h,selectedKeys:f,expandedKeys:z,onTitleChange:({uuid:j,value:K})=>{Rt(j,{name:K},c.editingData.elements);const ie=we(m);d({type:"update",payload:{editingData:Object.assign({},m),elementTree:ie}})},onOperationToggle:({uuid:j,operations:K})=>{Rt(j,{operations:K},c.editingData.elements);const ie=we(m);d({type:"update",payload:{editingData:Object.assign({},m),elementTree:ie}})},onSelect:j=>{f!=null&&f.includes(j.uuids[0])||M(j.positions)},onDrop:j=>{const{elements:K}=pi(m.elements,{from:j.from,to:j.to}),ie=Ve(j.to,m.elements);ie&&(ie.x=0,ie.y=0);const le=we(m);d({type:"update",payload:{editingData:Object.assign(Object.assign({},m),{elements:[...K]}),elementTree:le}})},onDelete:({uuid:j})=>{s.trigger("deleteElement",{uuid:j})},onGoToGroup:j=>{s.trigger("resetEditingView",{type:"go-to-next-group",position:j.position})},onExpand:(j,{node:K})=>{const ie=K.key;if(ie){let le=[...z];z.includes(ie)?le.splice(le.indexOf(ie),1):le=[...le,ie],L(le)}}}):l.createElement(Ot,{image:Ot.PRESENTED_IMAGE_SIMPLE,description:!1})))}];return T.useMemo(()=>l.createElement("div",{style:n,className:ce(N,t),onContextMenu:j=>{j.preventDefault()}},l.createElement(Ma,{ghost:!0,items:F,size:"small",defaultActiveKey:w.current,onChange:j=>{Array.isArray(j)&&(w.current=[...j]),H()}})),[o,y,b,u,h,f,z,g.elements,m.elements,v,P,G,V])};var Dh=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};const Th="mod-panel-detail",Ph=e=>{const{className:t,style:n}=e,{state:o,dispatch:i}=T.useContext(Et),{selectedUUIDs:a,editingData:s,editingDataPosition:r}=o,c=B(Th),d=T.useRef(s);T.useEffect(()=>{d.current=s},[s]);const u=()=>d.current,h=T.useCallback(p=>{if((a==null?void 0:a.length)===1&&a[0]){const S=a[0];Rt(S,p,s.elements),i({type:"update",payload:{editingData:Object.assign({},s)}})}},[s,a]),f=T.useCallback(p=>{var S;const{detail:E}=p,w=Dh(p,["detail"]);delete w.operations;const y=u();if(w||E){const x=Object.assign(Object.assign(Object.assign({x:0,y:0},y.layout),w),{detail:Object.assign(Object.assign({},(S=y.layout)===null||S===void 0?void 0:S.detail),E)}),b=Object.assign(Object.assign({},y),{layout:x});i({type:"updateEditingDataLayoutToTargetGroup",payload:{editingData:b}})}},[s,a]),m=T.useCallback(p=>(a==null?void 0:a.length)>1?null:ul(p,u().elements),[s,a[0]]),v=T.useCallback(p=>{var S,E;let w=null;return p&&Ut(p)&&(w=((E=(S=u().assets)===null||S===void 0?void 0:S[p])===null||E===void 0?void 0:E.value)||null),w},[s,a[0]]),g=T.useCallback(p=>{const S=Tn(p.value);return s.assets||(s.assets={}),s.assets[S]=p,{assetId:S,assetItem:p}},[s,a[0]]);return T.useMemo(()=>{const p=m(a[0]);return l.createElement("div",{style:n,className:ce(c,t),onContextMenu:S=>{S.preventDefault()}},l.createElement(hh,{element:p,onElementChange:h,getElementAsset:v,createElementAsset:g,layout:s.layout,onLayoutChange:f}))},[a[0],s.layout,r])},jo="mod-export-image-file",Pa=700,Oh=Pa+48,io=500,Rh=Pa-io,_o={devicePixelRatio:1,fileName:"download.png"},Lh=e=>{const{className:t,style:n,sharedStore:o}=e,i=B(jo),a=B(jo,"preview"),s=B(jo,"options"),r=B(jo,"canvas"),[c,d]=T.useState(null),[u,h]=T.useState(!0),[f,m]=T.useState(null),[v]=J.useForm(),g=T.useCallback(S=>{const E=o.get("idraw");E&&(h(!0),E.getImageBlobURL({devicePixelRatio:S}).then(({blobURL:w,width:y,height:x,devicePixelRatio:b})=>{w&&(m(w),d({width:y,height:x,devicePixelRatio:b}))}).catch(w=>{console.log(w)}).finally(()=>{h(!1)}))},[]);T.useEffect(()=>{v.setFieldsValue({devicePixelRatio:_o.devicePixelRatio,fileName:_o.fileName}),setTimeout(()=>{g(_o.devicePixelRatio)},10)},[]);const p=()=>{if(!f)return;const S=v.getFieldsValue(),E=document.createElement("a");E.href=f,E.download=S.fileName||_o.fileName,document.body.appendChild(E),E.click(),document.body.removeChild(E)};return T.useMemo(()=>l.createElement("div",{style:Object.assign(Object.assign({},n),{width:Pa}),className:ce(i,t)},l.createElement(Dr,{tip:"Loading...",spinning:u},l.createElement("div",{className:a,style:{width:io,height:io*3/4}},f&&l.createElement("img",{className:r,style:{maxWidth:io,maxHeight:io*3/4},src:f}))),l.createElement("div",{className:s,style:{width:Rh}},l.createElement("div",{style:{marginBottom:6}},"Width: ",c==null?void 0:c.width),l.createElement("div",null,"Height: ",c==null?void 0:c.height),l.createElement(Tr,null),l.createElement("div",null,l.createElement(J,{form:v,layout:"vertical",onValuesChange:S=>{S.devicePixelRatio>0&&setTimeout(()=>{g(S.devicePixelRatio)},10)},disabled:u},l.createElement(J.Item,{label:"Device pixel ratio",name:"devicePixelRatio"},l.createElement(_e,{size:"small",options:[1,2,3,4].map(S=>({label:`x${S}`,value:S}))})),l.createElement(J.Item,{label:"File name",name:"fileName"},l.createElement(Lt,{size:"small",placeholder:"File name"})),l.createElement(Oe,{type:"primary",onClick:p,disabled:u||!f,loading:u},"Download"))))),[c,u,f,g])};var kh=function(e,t,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function r(u){try{d(o.next(u))}catch(h){s(h)}}function c(u){try{d(o.throw(u))}catch(h){s(h)}}function d(u){u.done?a(u.value):i(u.value).then(r,c)}d((o=o.apply(e,t||[])).next())})};function jh(e){return new Promise(function(t,n){const o=new FileReader;o.onload=function(){t(o)},o.onerror=n,e.type==="application/json"?o.readAsText(e):o.readAsArrayBuffer(e)})}function _h(e){xa({accept:"application/json",success:t=>kh(this,void 0,void 0,function*(){var n,o,i;const s=(yield jh(t.file)).result;if(typeof s=="string")try{const r=JSON.parse(s);(n=e==null?void 0:e.success)===null||n===void 0||n.call(e,{json:r})}catch(r){(o=e==null?void 0:e.error)===null||o===void 0||o.call(e,r)}else(i=e==null?void 0:e.error)===null||i===void 0||i.call(e,Error("ERROR_PICK_FILE_FAIL"))}),error:e==null?void 0:e.error})}const Vh=()=>{const[e]=Ti("NavMenu");return e},$s="mod-nav-menu",Wh=e=>{const{className:t,style:n,sharedStore:o,sharedEvent:i}=e,[a,s]=Pr.useModal(),r=B($s),c=B($s,"dropdown"),[d,u]=T.useState([]),h=Vh(),f=({key:z,domEvent:L})=>{L.preventDefault(),i.trigger("createElement",{type:z,element:{name:z}})},{state:m}=T.useContext(Et),{editMode:v,pageTree:g}=m,[p,S]=T.useState(!1);T.useEffect(()=>{const z=L=>{const{isPageOverview:N}=L;S(!!N)};return i.on("switchPageOverview",z),()=>{i.off("switchPageOverview",z)}},[]);const E=!!(v==="page"&&(g.length===0||p)),w=z=>{const L=o.get("idraw");L==null||L.resize({devicePixelRatio:z})},y={more:[{key:"about-idraw-stuido",label:h.about,disabled:!0},{key:"line",type:"divider"},{key:"file",label:h.file,children:[{key:"import-json-file",label:h.importJSONFile,onClick:()=>{_h({success:({json:z})=>{i.trigger("resetData",{data:z})},error:()=>{}})}},{key:"export-image",label:h.exportImage,onClick:()=>{a.info({icon:null,title:"Whole image file",width:Oh,content:l.createElement(Lh,{sharedEvent:i,sharedStore:o}),footer:null,closable:!0})}},{key:"export-json-file",label:h.exportJSONFile,onClick:()=>{const z=o.get("idraw"),L=z==null?void 0:z.getData({compact:!0});if(L){const N=JSON.stringify(L);nc(N,{fileName:"downdown.json"})}}}]},{key:"preferences",label:h.preferences,children:[{key:"device-pixel-ratio",label:h.devicePixelRatio,type:"group",children:[{key:"device-pixel-ratio-x1",label:"x1",onClick:()=>{w(1)}},{key:"device-pixel-ratio-x2",label:"x2",onClick:()=>{w(2)}},{key:"device-pixel-ratio-x3",label:"x3",onClick:()=>{w(3)}}]}]}],element:[{key:"rect",label:h.rect,icon:l.createElement(ir,null),disabled:E,onClick:f},{key:"circle",label:h.circle,icon:l.createElement(ar,null),disabled:E,onClick:f},{key:"text",label:h.text,icon:l.createElement(sr,null),disabled:E,onClick:f},{key:"image",label:h.image,icon:l.createElement(cr,null),disabled:E,onClick:f},{key:"svg",label:h.svg,disabled:E,icon:l.createElement(rr,null),onClick:f},{key:"html",label:h.html,disabled:!0,icon:l.createElement(dr,null),onClick:f},{key:"group",label:h.group,icon:l.createElement(lr,null),disabled:E,onClick:f}]},x={size:"small",type:"text"},b=[{key:"more",button:l.createElement(i0,{style:{fontSize:20}})},{key:"element",button:l.createElement(Vu,{style:{fontSize:20}})}],C=()=>{const z=o.get("idraw"),L=[];if(z){const{viewSizeInfo:N}=z.getViewInfo(),{devicePixelRatio:R}=N;L.push(`device-pixel-ratio-x${R}`)}u(L)};return T.useMemo(()=>l.createElement("div",{style:n,className:ce(r,t)},b.map((z,L)=>l.createElement(Pn,{key:L,trigger:["click","click"],menu:{items:y[z.key]||[],selectedKeys:d},placement:"bottom",overlayClassName:c,onOpenChange:N=>{N===!0&&C()}},l.createElement(Oe,Object.assign({},x,{onClick:N=>N.preventDefault()}),l.createElement(Ks.Compact,null,z.button,l.createElement(Di,{style:{fontSize:10,marginLeft:4}}))))),s),[d,h])},Ht="mod-header",Bh=e=>{const{logo:t,navigationMenu:n,navigationCenter:o,className:i,style:a,openLeftSider:s,openRightSider:r,onClickToggleLayer:c,onClickToggleSetting:d,sharedStore:u,sharedEvent:h}=e,{state:f,dispatch:m}=T.useContext(Et),v=B(Ht),g=B(Ht,"left"),p=B(Ht,"right"),S=B(Ht,"center"),E=B(Ht,"locale"),w=B(Ht,"scale"),y=B(Ht,"switch"),{localeCode:x,scaleInfo:b}=f;return T.useMemo(()=>l.createElement("div",{style:a,className:ce(v,i)},l.createElement("div",{className:g},t,n||l.createElement(Wh,{sharedStore:u,sharedEvent:h}),l.createElement(Ch,{openLeftSider:s,openRightSider:r,onClickToggleLayer:c,onClickToggleSetting:d,sharedStore:u,sharedEvent:h})),o&&l.createElement("div",{className:S},o),l.createElement("div",{className:p},l.createElement(Du,{className:w,value:`${ge(b.scale)}`,onChange:C=>{const z=parseFloat(C);z>0&&(m==null||m({type:"update",payload:{scaleInfo:{scale:ge(z),from:"control"}}}))}}),l.createElement(Kr,{className:E,value:x,onChange:C=>{m==null||m({type:"update",payload:{localeCode:C}})}}),l.createElement(Qr,{className:y,theme:f==null?void 0:f.themeMode,onChange:({theme:C})=>{m==null||m({type:"updateThemeMode",payload:{themeMode:C}})}}))),[x,b,s,r,c,d])};var Xs=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};const Fh="mod-sketch",Hh=e=>{const t=T.useRef(null),n=T.useRef(null),o=T.useRef(!1),{className:i,style:a,width:s,height:r,sharedEvent:c,sharedStore:d,useContextMenuOptions:u}=e,{generateClassName:h}=T.useContext(uo),{state:f,dispatch:m}=T.useContext(Et),{editingData:v}=f,g=h(Fh),p=T.useRef([]),S=T.useRef(f.editingData),E=T.useRef(f.data),w=T.useRef([]),[y]=u({sharedEvent:c,sharedStore:d});return T.useEffect(()=>{p.current=[...f.editingDataPosition],E.current=f.data,S.current=f.editingData,w.current=[...f.selectedUUIDs]},[f.editingDataPosition,f.data,f.editingData,f.selectedUUIDs]),T.useEffect(()=>{if(!(t!=null&&t.current)||n!=null&&n.current)return;const x={width:s,height:r,devicePixelRatio:window.devicePixelRatio},b=new Au(t.current,x);b.enable("ruler"),n.current=b;const C=A=>{var Y;const G=S.current;let{uuids:I}=A;if((I==null?void 0:I.length)===1&&((Y=w.current)===null||Y===void 0?void 0:Y.length)===1&&I[0]===w.current[0])return;const{positions:H}=A;H&&Array.isArray(H)&&(I=fl(H,G.elements).map(M=>M.uuid)),m({type:"update",payload:{selectedUUIDs:I}})},z=A=>{const{data:Y,type:G}=A,I=S.current;if(["addElement","updateElement","deleteElement","moveElement","dragElement","resizeElement"].includes(G)){const H={editingData:Object.assign({},Y)};["addElement","deleteElement","moveElement"].includes(G)&&(H.elementTree=we(I)),m({type:"update",payload:H})}else if(G==="changeLayout"){if(Y.layout){const H=Object.assign({},Y.layout);H.detail&&(H.detail=Object.assign({},H.detail)),Y.layout=Object.assign({},Y.layout)}m({type:"updateEditingDataLayoutToTargetGroup",payload:{editingData:Object.assign({},Y)}})}},L=A=>{const{scale:Y}=A;m({type:"update",payload:{scaleInfo:{scale:Y,from:"event"}}})},N=A=>{const{element:Y}=A;b.updateElement(Y);const G=Object.assign({},b.getData()),I=we(G);m({type:"update",payload:{editingData:Object.assign({},G),elementTree:I}})},R=A=>{const{type:Y,element:G}=A,I=b.createElement(Y,{element:G,viewCenter:!0});let H=b.getViewCenter();const Z=w.current;let M=[];const O=b.getData();if(Array.isArray(Z)&&Z.length===1){const j=Z[0],K=ct(j,O.elements);let ie=Ve(K,O.elements);if(K.length>1){M=[...K];let le=M.pop();le+=1;const Qe=[...M];M.push(le),ie=Ve(Qe,O.elements),H=ot(ie),I.x=H.x-I.w/2,I.y=H.y-I.h/2}}const D=b.addElement(I,{position:M}),F=we(D);m({type:"update",payload:{editingData:Object.assign({},D),elementTree:F}}),b.selectElements([I.uuid])},k=A=>{const{element:Y,position:G=[]}=A;let I=b.getViewCenter();const H=w.current;let Z=G;const M=b.getData();if(Array.isArray(H)&&H.length===1){const F=H[0],j=ct(F,M.elements),K=Ve(j,M.elements);j.length>0&&(K==null?void 0:K.type)==="group"&&Array.isArray(K.detail.children)&&(Z=[...j],Z.push(K.detail.children.length),I=ot(K))}const O=b.addElement(Object.assign(Object.assign({},Y),{x:I.x-Y.w/2,y:I.y-Y.h/2}),{position:Z}),D=we(O);m({type:"update",payload:{editingData:Object.assign({},O),elementTree:D}}),b.selectElements([Y.uuid])},_=A=>{const{uuid:Y}=A;b==null||b.deleteElement(Y);const G=b==null?void 0:b.getData();if(G){const I=we(G);m({type:"update",payload:{editingData:Object.assign({},G),elementTree:I}}),b.trigger(he.clearSelect,{})}},$=A=>{const{element:Y,inPageOverview:G}=A,{w:I,h:H,detail:Z}=Y,M=E.current;M.elements=[...M.elements,Y];const O=Xs(Z,["children"]);let D={elements:Y.detail.children,layout:{x:0,y:0,w:I,h:H,detail:O,operations:{position:"relative"}}};const F=we(M);let j=[F.length-1];G===!0&&(D=M,j=[]);const K=we(D);b.centerContent({data:D}),m({type:"update",payload:{data:Object.assign({},M),editingData:D,elementTree:K,pageTree:F,editingDataPosition:j}})},U=A=>{var Y,G,I,H;const{uuid:Z}=A;if(!Z)return;const M=E.current;let O=-1;const D={pageTree:[]};for(let j=0;j<M.elements.length;j++)if(((Y=M.elements[j])===null||Y===void 0?void 0:Y.uuid)===Z){M.elements.splice(j,1),M.elements=[...M.elements],O=j;break}const F=we(M);if(D.data=Object.assign({},M),D.pageTree=F,p.current.length===1&&O===p.current[0]){let j=(G=M==null?void 0:M.elements)===null||G===void 0?void 0:G[O],K=O;for(;!(!((I=j==null?void 0:j.extends)===null||I===void 0)&&I.isPage)&&K>0;)K--,j=(H=M==null?void 0:M.elements)===null||H===void 0?void 0:H[K];if(j){const ie=j.detail,{children:le}=ie,Qe=Xs(ie,["children"]),Je={elements:le||[],layout:{x:0,y:0,w:j.w,h:j.h,detail:Qe,operations:{position:"relative"}}},Rn=we(Je);D.editingData=Je,D.editingDataPosition=[K],D.elementTree=Rn,b.centerContent({data:Je})}else D.editingData={elements:[]},D.editingDataPosition=[],D.elementTree=[]}else p.current.length===0&&(D.editingData=Object.assign({},M));F.length===0&&(D.elementTree=[],D.editingDataPosition=[],D.editingData={elements:[]}),m({type:"update",payload:D})},V=A=>{const{type:Y,position:G}=A,I=n==null?void 0:n.current;if(!I)return;const H=p.current,Z=S.current;let M=E.current;if(H.length>0?gh(H,Z,M):H.length===0&&(M=Z),Y==="go-to-page"&&G){const O=[...G],D=Tt(O,M),F=we(D);m({type:"update",payload:{data:Object.assign({},M),editingData:Object.assign({},D),editingDataPosition:O,elementTree:F}}),I.centerContent({data:D}),I.trigger(he.clearSelect,{})}else if(Y==="go-to-group"&&G){const O=[...G],D=Tt(O,M),F=we(D);m({type:"update",payload:{data:Object.assign({},M),editingData:Object.assign({},D),editingDataPosition:O,elementTree:F}}),I.centerContent({data:D}),I.trigger(he.clearSelect,{})}else if(Y==="go-to-next-group"&&G){const O=[...H,...G],D=Tt(O,M),F=we(D);m({type:"update",payload:{data:Object.assign({},M),editingData:Object.assign({},D),editingDataPosition:O,elementTree:F}}),I.centerContent({data:D}),I.trigger(he.clearSelect,{})}else if(Y==="back-one"&&H.length>0){const O=[...H];O.pop();const D=Tt(O,M),F=we(D);m({type:"update",payload:{data:Object.assign({},M),editingData:Object.assign({},D),editingDataPosition:[...O],elementTree:F}}),I.centerContent({data:D}),I.trigger(he.clearSelect,{})}else if(Y==="back-root"){const O=[],D=Tt(O,M),F=we(D);m({type:"update",payload:{data:Object.assign({},M),editingData:D,editingDataPosition:O,elementTree:F}}),I.centerContent({data:D}),I.trigger(he.clearSelect,{})}},P=A=>{let{data:Y}=A,G=[],I=co(Y);if(f.editMode==="page"&&(Y=yr(Y),I=co(Y),I.length>0)){const M=I[0].uuid;G=ct(M,Y.elements)}let H=Tt(G,Y);const Z=we(H);m({type:"update",payload:{data:Object.assign({},Y),editingData:Object.assign({},H),editingDataPosition:G,elementTree:Z,pageTree:I}}),b.centerContent({data:H}),b.trigger(he.clearSelect,{})},W=A=>{const{editingData:Y}=A,G=we(Y);m({type:"update",payload:{editingData:Object.assign({},Y),elementTree:G}}),b.trigger(he.clearSelect,{})};if(b.on(he.select,C),b.on(he.change,z),b.on(he.scale,L),b.on(he.textChange,N),c.on("createElement",R),c.on("addElement",k),c.on("deleteElement",_),c.on("addPage",$),c.on("deletePage",U),c.on("resetEditingView",V),c.on("resetData",P),c.on("resetEditingData",W),c.on("dispatch",m),!o.current){if(f.scaleInfo){const{scale:A,offsetX:Y,offsetY:G}=f.scaleInfo;A&&Y&&G?b.setViewScale({scale:A,offsetX:Y,offsetY:G}):b.centerContent({data:f.editingData})}o.current=!0}return d.set("idraw",b),()=>{o.current=!1,b.off(he.select,C),b.off(he.change,z),b.off(he.scale,L),b.off(he.textChange,N),d.set("idraw",null)}},[]),T.useEffect(()=>{n!=null&&n.current&&n.current.setData(v)},[v]),T.useEffect(()=>{if(n!=null&&n.current){const x=n.current;f.scaleInfo.from==="control"&&x.scale({scale:f.scaleInfo.scale,point:{x:s/2,y:r/2}})}},[f.scaleInfo]),T.useEffect(()=>{const x=n.current,b=t.current;x&&x.resize({width:s,height:r}),b&&(b.style.width=`${s}px`,b.style.height=`${r}px`)},[s,r]),T.useMemo(()=>l.createElement(Pn,{menu:{items:y},trigger:["contextMenu"]},l.createElement("div",{ref:t,className:ce(g,i),style:Object.assign(Object.assign({},a),{width:s,height:r,padding:0})})),[y])},vn="mod-dashboard",Vo=240,Wo=240,pn=36,Gh=T.forwardRef((e,t)=>{const{className:n,style:o,width:i,height:a,logo:s,navigationMenu:r,navigationCenter:c,defaultSelectedElementUUIDs:d,sharedStore:u,sharedEvent:h,useContextMenuOptions:f,handleKeyboard:m}=e,{state:v}=T.useContext(Et),{editMode:g}=v,[p,S]=T.useState(!0),[E,w]=T.useState(!0);T.useEffect(()=>{const k=_=>{["INPUT","TEXTAREA"].includes(_.target.nodeName)||m(_,{sharedEvent:h,sharedStore:u})};return window.addEventListener("keydown",k),()=>{window.removeEventListener("keydown",k)}},[]);const[y,x]=T.useState({leftWidth:p?Vo:0,rightWidth:E?Wo:0,centerWidth:i-(p?Vo:0)-(E?Wo:0)});T.useEffect(()=>{const k=p?Vo:0,_=E?Wo:0,$=i-k-_;x({leftWidth:k,rightWidth:_,centerWidth:$})},[a,i,p,E]);const b=B(vn),C=B(vn,"header"),z=B(vn,"content"),L=B(vn,"left"),N=B(vn,"right"),R=B(vn,"right");return T.useMemo(()=>{const{leftWidth:k,rightWidth:_,centerWidth:$}=y;return l.createElement("div",{ref:t,className:ce(b,n),style:Object.assign(Object.assign({},o),{width:i,height:a,padding:0})},l.createElement("div",{className:C,style:{height:pn}},l.createElement(Bh,{sharedEvent:h,sharedStore:u,logo:s,navigationMenu:r,navigationCenter:c,openLeftSider:p,openRightSider:E,onClickToggleLayer:()=>{const U=!p;let V=k;U?V=Vo:V=0,x({leftWidth:V,rightWidth:_,centerWidth:i-V-_}),S(U)},onClickToggleSetting:()=>{const U=!E;let V=_;U?V=Wo:V=0,x({leftWidth:k,rightWidth:V,centerWidth:i-k-V}),w(U)}})),l.createElement("div",{className:z,style:{top:pn}},l.createElement(ui,{split:"vertical",defaultSize:$+_,allowResize:!0,onChange:U=>{const V=i-U,P=U-_;P<100||x({leftWidth:V,rightWidth:_,centerWidth:P})},pane1Style:{width:k},pane2Style:{width:$+_}},l.createElement("div",null,p&&(g==="page"?l.createElement(Nh,{height:a-pn,className:L,defaultSelectedElementUUIDs:d,sharedEvent:h,sharedStore:u,useContextMenuOptions:f}):l.createElement(zh,{height:a-pn,className:L,defaultSelectedElementUUIDs:d,sharedEvent:h,sharedStore:u,useContextMenuOptions:f}))),l.createElement("div",{style:{width:y.centerWidth+y.rightWidth,display:"flex",flexDirection:"row"}},l.createElement(Hh,{className:R,width:$,height:a-pn,sharedStore:u,sharedEvent:h,useContextMenuOptions:f}),l.createElement("div",{className:N,style:{width:_,height:a-pn}},l.createElement(Ph,null))))))},[n,g,p,E,y,a])});function Us(){return{idraw:null,clipboard:{type:"default",data:null},selectedUUIDs:[]}}function Yh(e){const{sharedEvent:t,sharedStore:n}=e;t.on("copy",()=>{const o=n.get("idraw"),i=n.get("selectedUUIDs"),a=o==null?void 0:o.getData();if(a&&Array.isArray(i)&&i.length>0){const s=Go(i,a.elements);s.length>0&&n.set("clipboard",{type:"copy-elements",data:s})}}),t.on("paste",()=>{const o=n.get("idraw"),i=n.get("clipboard"),a=n.get("selectedUUIDs");if(o&&["copy-elements","cut-elements"].includes(i==null?void 0:i.type)&&Array.isArray(i.data)){const s=i.data,r=[];if(i.type==="copy-elements"){for(let f=0;f<s.length;f++)if(s[f]){const m=s[f],v=ki(m);v.name=`${v.name} copy`,r.push(v)}}else if(i.type==="cut-elements"){for(let f=0;f<s.length;f++)if(s[f]){const m=s[f],v=ki(m);v.name=`${v.name}`,r.push(v)}}const c=o==null?void 0:o.getData(),d=ct(a[0],(c==null?void 0:c.elements)||[]);d.length>0&&d[d.length-1]++,r.forEach(f=>{o.addElement(f,{position:d})});const u=o==null?void 0:o.getData(),h=we(u);t.trigger("dispatch",{type:"update",payload:{editingData:u,elementTree:h}}),o.selectElement(r[0].uuid),setTimeout(()=>{t.trigger("scrollToLayer",{uuid:r[0].uuid})},100)}}),t.on("cut",()=>{const o=n.get("idraw"),i=n.get("selectedUUIDs"),a=o==null?void 0:o.getData();if(a&&Array.isArray(i)&&i.length>0){const c=Go(i,a.elements);c.length>0&&n.set("clipboard",{type:"cut-elements",data:c.map(d=>ki(d))}),c.forEach(d=>{o==null||o.deleteElement(d.uuid)})}const s=o==null?void 0:o.getData(),r=we(s);t.trigger("dispatch",{type:"update",payload:{editingData:s,elementTree:r}}),o==null||o.trigger(he.clearSelect)}),t.on("delete",()=>{const o=n.get("idraw"),i=n.get("selectedUUIDs"),a=o==null?void 0:o.getData();if(a&&Array.isArray(i)&&i.length>0){const s=Go(i,a.elements);if(s.length>0){for(let d=0;d<s.length;d++)o==null||o.deleteElement(s[d].uuid);const r=o==null?void 0:o.getData(),c=we(r);t.trigger("dispatch",{type:"update",payload:{editingData:r,elementTree:c}}),o==null||o.trigger(he.clearSelect)}}})}const $h=e=>{const[t]=Ti("contextMenu"),{sharedEvent:n}=e;return[[{label:t.copy,key:"copy",onClick:()=>{n.trigger("copy")}},{label:t.paste,key:"paste-here",onClick:()=>{n.trigger("paste")}},{label:t.cut,key:"cut",onClick:()=>{n.trigger("cut")}},{label:t.delete,key:"delete",onClick:()=>{n.trigger("delete")}}]]};var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});var Xh=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),oa={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},Er={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:Xh?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},Oa={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(var Bo=1;Bo<20;Bo++)Oa["f"+Bo]=111+Bo;function Pi(e,t,n){t&&!("byKey"in t)&&(n=t,t=null),Array.isArray(e)||(e=[e]);var o=e.map(function(s){return Mr(s,t)}),i=function(r){return o.some(function(c){return xr(c,r)})},a=n==null?i:i(n);return a}function Uh(e,t){return Pi(e,t)}function Zh(e,t){return Pi(e,{byKey:!0},t)}function Mr(e,t){var n=t&&t.byKey,o={};e=e.replace("++","+add");var i=e.split("+"),a=i.length;for(var s in oa)o[oa[s]]=!1;var r=!0,c=!1,d=void 0;try{for(var u=i[Symbol.iterator](),h;!(r=(h=u.next()).done);r=!0){var f=h.value,m=f.endsWith("?")&&f.length>1;m&&(f=f.slice(0,-1));var v=Ra(f),g=oa[v];if(f.length>1&&!g&&!Er[f]&&!Oa[v])throw new TypeError('Unknown modifier: "'+f+'"');(a===1||!g)&&(n?o.key=v:o.which=Cr(f)),g&&(o[g]=m?null:!0)}}catch(p){c=!0,d=p}finally{try{!r&&u.return&&u.return()}finally{if(c)throw d}}return o}function xr(e,t){for(var n in e){var o=e[n],i=void 0;if(o!=null&&(n==="key"&&t.key!=null?i=t.key.toLowerCase():n==="which"?i=o===91&&t.which===93?91:t.which:i=t[n],!(i==null&&o===!1)&&i!==o))return!1}return!0}function Cr(e){e=Ra(e);var t=Oa[e]||e.toUpperCase().charCodeAt(0);return t}function Ra(e){return e=e.toLowerCase(),e=Er[e]||e,e}var yn=Mt.default=Pi;Mt.isHotkey=Pi;Mt.isCodeHotkey=Uh;Mt.isKeyHotkey=Zh;Mt.parseHotkey=Mr;Mt.compareHotkey=xr;Mt.toKeyCode=Cr;Mt.toKeyName=Ra;const Qh=(e,t)=>{const{sharedEvent:n}=t;yn("mod+c",e)?n.trigger("copy",void 0):yn("mod+v",e)?n.trigger("paste",void 0):yn("mod+x",e)?n.trigger("cut",void 0):yn("del",e)||yn("backspace",e)?n.trigger("delete",void 0):yn("mod+s",e)&&console.log("Save ... ")},qh=l.forwardRef((e,t)=>{const{width:n=1e3,height:o=600,style:i,className:a,logo:s,navigationMenu:r,navigationCenter:c,defaultSelectedElementUUIDs:d,defaultEditMode:u,prefiexName:h,onEditGroupElement:f,useContextMenuOptions:m=$h,handleKeyboard:v=Qh}=e,[g,p]=T.useReducer(wh,ph(e)),S=T.useRef(null),E=T.useRef(new Qt),w=T.useRef(new Jt({defaultStorage:Us()}));return T.useEffect(()=>{if(u!=="page"){const y=Ve(g.editingDataPosition,g.data.elements);f==null||f({uuid:y==null?void 0:y.uuid,position:[...g.editingDataPosition]})}},[g.editingDataPosition]),T.useImperativeHandle(t,()=>({getSharedEvent(){return E.current},getSharedStore(){return w.current},dispatch(x){const{type:b,payload:C}=x;p({type:b,payload:C})}}),[]),T.useEffect(()=>(E.current||(E.current=new Qt),w.current||(w.current=new Jt({defaultStorage:Us()})),Yh({sharedEvent:E.current,sharedStore:w.current}),()=>{var y,x;(y=w.current)===null||y===void 0||y.clear(),(x=E.current)===null||x===void 0||x.destroy(),E.current=null,w.current=null}),[]),T.useEffect(()=>{const y=w.current;y&&y.set("selectedUUIDs",[...g.selectedUUIDs])},[g.selectedUUIDs]),T.useEffect(()=>{const y=E.current;y==null||y.trigger("switchTheme",{theme:g.themeMode})},[g.themeMode]),T.useEffect(()=>{const y=E.current;y==null||y.trigger("changeLocale",{locale:g.localeCode})},[g.localeCode]),T.useEffect(()=>{const y=E.current;y==null||y.trigger("trackDataChange",{data:g.data})},[g.data]),T.useEffect(()=>{const y=E.current;y==null||y.trigger("trackEditingDataChange",{editingData:g.editingData,editingDataPosition:g.editingDataPosition})},[g.editingData,g.editingDataPosition]),T.useMemo(()=>l.createElement(kr,{localeCode:g.localeCode,container:S.current,topPrefix:h,themeMode:g.themeMode},l.createElement(bh,{value:{state:g,dispatch:p}},l.createElement(Gh,{logo:s,navigationMenu:r,navigationCenter:c,ref:S,width:n,height:o,style:i,className:a,defaultSelectedElementUUIDs:d,sharedEvent:E.current,sharedStore:w.current,useContextMenuOptions:m,handleKeyboard:v}))),[h,n,o,g,p,S])});export{qh as S};
